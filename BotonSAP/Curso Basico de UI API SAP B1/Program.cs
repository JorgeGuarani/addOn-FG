using System;
using System.Text;
using System.Windows.Forms;
using System.Windows.Forms.VisualStyles;
using System.Xml;
//using Button = SAPbouiCOM.Button;
using SAPbouiCOM.Framework;
using BOTONSAP;
using System.IO;
using Application = System.Windows.Forms.Application;
using SAPbouiCOM;
using SAPbobsCOM;
using System.Text.RegularExpressions;
using System.Runtime.InteropServices;
using System.ServiceModel;
using System.Drawing;
using System.Globalization;
using Microsoft.Office;
using System.Net.Mail;
using System.Configuration;
using System.Net.Configuration;
using System.Net;
using System.Security.Cryptography.X509Certificates;
using System.Net.Security;
using System.Threading;
using System.ServiceModel;
using Curso_Basico_de_UI_API_SAP_B1;

//ADDON FRIGORIFICO GUARANI
namespace BOTONSAP 
{
    class Program
    {
        /*Agregar referencia ui api
          Agregar cadena (0030002C0030002C00530041005000420044005F00440061007400650076002C0050004C006F006D0056004900490056)
          agregar referencia para el Application.run (System.Windows.Forms)
          Revisar la arquitectura del proyecto  sea la misma que la del cliente SAP
             */

        public static SAPbouiCOM.Application SBO_Application = null; //SAPbouiCOM.Application SBO_Application = null;
        public static SAPbobsCOM.Company oCompany = null;//SAPbobsCOM.Company oCompany = null;
        public static bool accionBTN = false;
        public static EditText oText, oValor;
        public static String botonAdd = "", codigo = null, DocTotal = null;
        public static string btnNC = null;
        public static string FolioIni = null, FolioFin = null, SerieMasiva = null;
        public static string compania = null;
        public static string v_DecimalFG = "0";
        public static string v_versionAddOn = "1.2";
        public static string v_nombreaddOn = "FESap-Node(x64)";
        public static string v_form = null;
        public static bool v_permiso = false;
        public static bool v_Jenga = false;

        static void Main(string[] args)
        {

            ConexionUIAPI();
            ConexionSingleSignOn();
            //ConexionMultipleAddOn();
            SBO_Application.StatusBar.SetText("Addon FE iniciado Correctamente", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
            //SBO_Application.MessageBox("Addon FE iniciado Correctamente",2,"Confirmar");
            // Cliclo para leer todos los eventos de tipo itemeven
            AddMenuItems();
            SBO_Application.ItemEvent += new SAPbouiCOM._IApplicationEvents_ItemEventEventHandler(SBO_Application_ItemEvent);
            SBO_Application.MenuEvent += new SAPbouiCOM._IApplicationEvents_MenuEventEventHandler(SBO_Application_MenuEvent);

            //agarramos la cantidad de decimales 
            Recordset oDecimal;
            oDecimal = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDecimal.DoQuery("SELECT \"U_Valor\" FROM \"@APP_CONFIG\" WHERE \"U_Empresa\"='FG' AND \"Name\"='DecimalesFE' ");
            v_DecimalFG = oDecimal.Fields.Item(0).Value.ToString();

            //control de version del addOn
            Recordset oVaddOn;
            oVaddOn = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oVaddOn.DoQuery("SELECT COUNT(*) FROM \"@APP_CONFIG\" WHERE \"Name\"='" + v_nombreaddOn + "' AND \"U_Valor\"='" + v_versionAddOn + "' AND \"U_Empresa\"='FG' ");
            int v_existe = int.Parse(oVaddOn.Fields.Item(0).Value.ToString());
            if (v_existe == 0)
            {
                MessageBox.Show("Debe actualizar la versión del addOn!", "Atencion", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                var oMenuItem = SBO_Application.Menus.Item("43520");
                var oMenus = oMenuItem.SubMenus; //If you want add sub menu by using this line you can add sub menu
                oMenus.RemoveEx("FG");
                oCompany.Disconnect();
                SBO_Application.StatusBar.SetText("DEBE ACTUALIZAR LA VERSION DE ADDON", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
            }

            //autorizacion para el MENU
            Recordset oAutorizacion;
            oAutorizacion = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oAutorizacion.DoQuery("SELECT COUNT(*) FROM \"@APP_CONFIG\" WHERE \"U_Empresa\"='FG' AND \"Name\"='PERMISO MENU' AND \"U_Valor\"='" + oCompany.UserName.ToString() + "'  ");
            int v_menuAut = int.Parse(oAutorizacion.Fields.Item(0).Value.ToString());
            if (v_menuAut > 0)
            {
                v_permiso = true;
            }

            //autorizacion para el MENU JENGA
            Recordset oAutorizacionJenga;
            oAutorizacionJenga = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oAutorizacionJenga.DoQuery("SELECT COUNT(*) FROM \"@APP_CONFIG\" WHERE \"U_Empresa\"='FG' AND \"Name\"='PERMISO JENGA' AND \"U_Valor\"='" + oCompany.UserName.ToString() + "'  ");
            int v_jengaAut = int.Parse(oAutorizacionJenga.Fields.Item(0).Value.ToString());
            if (v_jengaAut > 0)
            {
                v_Jenga = true;
            }
         
            //Recordset oAct;
            //oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            //oAct.DoQuery("DELETE FROM \"@RELOJ_ZK\" WHERE \"U_COD_RELOJ\"='8' ");
            //oAct.DoQuery("update ODLN set \"FolioPref\"='0',\"FolioNum\"=0 where \"DocNum\"=14620072  ");
            //oAct.DoQuery("update OINV set \"FolioPref\"='022',\"FolioNum\"=933 where \"DocNum\"=34279336  ");
            //oAct.DoQuery("update OINV set \"FolioPref\"='022',\"FolioNum\"=982 where \"DocNum\"=34279337  ");
            //oAct.DoQuery("update OINV set \"FolioPref\"='022',\"FolioNum\"=948 where \"DocNum\"=34279338  ");
            //oAct.DoQuery("UPDATE NNM1 SET \"NextFolio\"='71' WHERE \"SeriesName\"='22-005' ");
            //oAct.DoQuery("INSERT INTO \"@RELOJ_MARCACIONES\" (\"Code\",\"Name\",\"DocEntry\",\"U_COD_ENROLAC\",\"U_FECHA_HORA\",\"U_COD_RELOJ\",\"U_IND_ENTSAL\",\"U_FECHAREAL\",\"U_RESPUESTAWS\") VALUES ('39654278','','39654278','30263','20230317','8','E','20230317','PRUEBA') ");
            //oAct.DoQuery("UPDATE ORIN SET \"FolioPref\"='0',\"FolioNum\"='0' where \"DocNum\"='61448'");
            //oAct.DoQuery("UPDATE OINV SET \"FolioPref\"='014',\"FolioNum\"='78' where \"DocNum\"='48278118'");
            //oAct.DoQuery("UPDATE ORIN SET \"FolioPref\"='017',\"FolioNum\"='697' where \"DocNum\"='102810'");
            ////oActSerie.DoQuery("UPDATE OINV SET \"FolioPref\"=\"U_ESTA\" where \"U_TIMB\"='16094946' and  \"FolioNum\">0 ");
            //actualizar folio de los asientos
            //Recordset oAct;
            //oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            //oAct.DoQuery("SELECT T0.\"DocNum\",T0.\"FolioPref\",T0.\"FolioNum\",T0.\"U_TIMB\",T1.\"FolioPref\",T1.\"FolioNum\",T0.\"TransId\",T1.\"TransId\" FROM ORIN T0 "+
            //             "INNER JOIN OJDT T1 ON T0.\"TransId\"=T1.\"TransId\" "+
            //             "WHERE T1.\"FolioNum\" is null AND T0.\"CANCELED\"='N' AND (T0.\"DocDate\" BETWEEN '20230201' AND '20230210')");

            //while(!oAct.EoF)
            //{
            //    string pref = oAct.Fields.Item(1).Value.ToString();
            //    string fol = oAct.Fields.Item(2).Value.ToString();
            //    string tra = oAct.Fields.Item(6).Value.ToString();
            //    Recordset oActFolio;
            //    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            //    oActFolio.DoQuery("UPDATE OJDT SET \"FolioPref\"='"+ oAct .Fields.Item(1).Value.ToString()+ "' ,\"FolioNum\"='"+ oAct.Fields.Item(2).Value.ToString() + "' WHERE \"TransId\"='"+ oAct.Fields.Item(6).Value.ToString() + "'");
            //    oAct.MoveNext();
            //}


            System.Windows.Forms.Application.Run();
        }

        public static void ConexionUIAPI()
        {
            try
            {
                SboGuiApi oSboGuiApi = new SboGuiApi();
                string sConnStr = Environment.GetCommandLineArgs().GetValue(1).ToString();
                oSboGuiApi.Connect(sConnStr);

                SBO_Application = oSboGuiApi.GetApplication(-1);
                SBO_Application.StatusBar.SetText("CONEXION EXITOSA - AddOn Factura Electrónica ", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);//Conexion UI API Exitosa
                oSboGuiApi = null;
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
            }
        }
        //Opcion recomendada y con mejor performance
        public static void ConexionSingleSignOn()
        {
            try
            {
                oCompany = new SAPbobsCOM.Company();
                string sCookie = oCompany.GetContextCookie();
                string SConn = SBO_Application.Company.GetConnectionContext(sCookie);
                int error = oCompany.SetSboLoginContext(SConn);

                if (error == 0)
                {
                    oCompany.Connect();
                    SBO_Application.StatusBar.SetText("CONEXION EXITOSA - AddOn Factura Electrónica", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                }
                else
                {
                    SBO_Application.StatusBar.SetText("Error - en la conexion DI API", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                }
            }
            catch (Exception ex)
            {
                SBO_Application.StatusBar.SetText("Error General - " + ex.ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
            }

        }
        //Conexion repartida para multiples Add-Ons
        public static void ConexionMultipleAddOn()
        {
            try
            {
                // oCompany = SBO_Application.Company.GetDICompany();
                SBO_Application.StatusBar.SetText("Conexion DI API", BoMessageTime.bmt_Short, BoStatusBarMessageType.smt_Success);
            }
            catch (Exception ex)
            {
                SBO_Application.StatusBar.SetText("Error General - " + ex.ToString(), BoMessageTime.bmt_Short, BoStatusBarMessageType.smt_Success);
            }
        }

        //agregar menu
        public static void AddMenuItems()
        {
            //variables para nombre del menu e icono
            compania = oCompany.CompanyName;

            string icono = null;
            if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                icono = "\\FGicono.bmp";
            }
            else
            {
                icono = "\\GRicono.bmp";
            }
            string[] pp = System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceNames();
            string pathIcono = Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + icono;
            string oo = System.AppDomain.CurrentDomain.BaseDirectory + "FGicono.bmp";

            var oCreationPackage = (MenuCreationParams)SBO_Application.CreateObject(BoCreatableObjectType.cot_MenuCreationParams);
            var oMenuItem = SBO_Application.Menus.Item("43520");
            var path = Application.StartupPath;
            oCreationPackage.Type = BoMenuType.mt_POPUP;
            oCreationPackage.UniqueID = "FG";
            oCreationPackage.String = compania;// "Frigorifico Guarani";
            oCreationPackage.Enabled = true;
            oCreationPackage.Image = oo;// "FGicono.bmp";
            oCreationPackage.Position = 0;

            var oMenus = oMenuItem.SubMenus; //If you want add sub menu by using this line you can add sub menu

            try
            {
                if (oMenus.Exists("FG"))
                {
                    oMenus.RemoveEx("FG");
                }
                oMenus.AddEx(oCreationPackage);
            }
            catch (Exception)
            { //  Menu already exists
                SBO_Application.SetStatusBarMessage("Menu Already Exists", BoMessageTime.bmt_Short);
            }

            try
            {
                // Get the menu collection of the newly added pop-up item
                //oMenuItem = SBO_Application.Menus.Item("FG");
                //oMenus = oMenuItem.SubMenus;
                //crear carpeta JENGA
                oMenuItem = SBO_Application.Menus.Item("FG");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_POPUP;
                oCreationPackage.UniqueID = "JE";
                oCreationPackage.String = "Jenga";
                oCreationPackage.Position = 1;
                oMenus = oMenuItem.SubMenus;
                oMenus.AddEx(oCreationPackage);
                //crear carpeta FACTURACION ELECTRONICA   
                oMenuItem = SBO_Application.Menus.Item("FG");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_POPUP;
                oCreationPackage.UniqueID = "FE";
                oCreationPackage.String = "Factura Electrónica";
                oCreationPackage.Position = 2;
                oMenus = oMenuItem.SubMenus;
                oMenus.AddEx(oCreationPackage);
                //sub obejtos de la carpeta JENGA
                //OBEJTIVOS
                oMenuItem = SBO_Application.Menus.Item("JE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "botonSAP.Obejtivo";
                oCreationPackage.String = "Objetivos";
                oCreationPackage.Position = 1;
                oMenus.AddEx(oCreationPackage);
                ////Comision
                oMenuItem = SBO_Application.Menus.Item("JE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "botonSAP.Comision";
                oCreationPackage.String = "Comisiones";
                oCreationPackage.Position = 2;
                oMenus.AddEx(oCreationPackage);
                ////Forecast
                oMenuItem = SBO_Application.Menus.Item("JE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "botonSAP.Forescast";
                oCreationPackage.String = "Forecast";
                oCreationPackage.Position = 3;
                oMenus.AddEx(oCreationPackage);
                ////Metrica
                oMenuItem = SBO_Application.Menus.Item("JE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "Metrica";
                oCreationPackage.String = "Metricas";
                oCreationPackage.Position = 4;
                oMenus.AddEx(oCreationPackage);
                ////Llave
                oMenuItem = SBO_Application.Menus.Item("JE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "Llave";
                oCreationPackage.String = "Llaves";
                oCreationPackage.Position = 5;
                oMenus.AddEx(oCreationPackage);
                ////Equivalencia
                oMenuItem = SBO_Application.Menus.Item("JE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "Equivalencia";
                oCreationPackage.String = "Equivalencias";
                oCreationPackage.Position = 4;
                oMenus.AddEx(oCreationPackage);
                ////Escala
                oMenuItem = SBO_Application.Menus.Item("JE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "escala";
                oCreationPackage.String = "Escalas";
                oCreationPackage.Position = 5;
                oMenus.AddEx(oCreationPackage);

                //sub obejtos de la carpeta FACTURACION ELECTRONICA
                //FACTURACION ELECTRONICA
                oMenuItem = SBO_Application.Menus.Item("FE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "botonSAP.anular";
                oCreationPackage.String = "Anular Documento";
                oCreationPackage.Position = 1;
                oMenus.AddEx(oCreationPackage);
                oMenuItem = SBO_Application.Menus.Item("FE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "botonSAP.cancelar";
                oCreationPackage.String = "Cancelar Documento";
                oCreationPackage.Position = 2;
                oMenus.AddEx(oCreationPackage);
                oMenuItem = SBO_Application.Menus.Item("FE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "auditoria";
                oCreationPackage.String = "Control de Documento";
                oCreationPackage.Position = 3;
                oMenus.AddEx(oCreationPackage);
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "inutilizar";
                oCreationPackage.String = "Inutilizar Documento";
                oCreationPackage.Position = 4;
                oMenus.AddEx(oCreationPackage);
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "numeracion";
                oCreationPackage.String = "Numeracion de Documento";
                oCreationPackage.Position = 5;
                oMenus.AddEx(oCreationPackage);
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "EquivalenciaSap";
                oCreationPackage.String = "Equivalencia Sap - SET";
                oCreationPackage.Position = 6;
                oMenus.AddEx(oCreationPackage);
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "Configuracion";
                oCreationPackage.String = "Configuracion";
                oCreationPackage.Position = 7;
                oMenus.AddEx(oCreationPackage);

            }
            catch (Exception er)
            { //  Menu already exists
                SBO_Application.SetStatusBarMessage(er.Message + "Menu Already Exists", SAPbouiCOM.BoMessageTime.bmt_Short, true);
            }
        }
        //fin prueba de menu

        public static void SBO_Application_ItemEvent(string FormUID, ref ItemEvent pVal, out bool BubbleEvent)
        {
            BubbleEvent = true;
            try
            {
                //FACTURACION MASIVA 
                #region FACTURACION MASIVA
                if (pVal.FormTypeEx == "191")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnFM", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "Crear FE";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 7);
                        oItem1.Left = (oItem1.Width + 20) - 40;
                        //ocultar boton PRINT
                        SAPbouiCOM.Button oBtnPrint;
                        oBtnPrint = (SAPbouiCOM.Button)oForm1.Items.Item(0).Specific;
                        oBtnPrint.Item.Visible = false;
                        //ocultar campos de folio
                        EditText oFolio1 = (SAPbouiCOM.EditText)oForm1.Items.Item(5).Specific;
                        oFolio1.Item.Visible = false;
                        EditText oFolio2 = (SAPbouiCOM.EditText)oForm1.Items.Item(7).Specific;
                        oFolio2.Item.Visible = false;
                        StaticText text1 = (SAPbouiCOM.StaticText)oForm1.Items.Item(6).Specific;
                        text1.Item.Visible = false;
                        StaticText text2 = (SAPbouiCOM.StaticText)oForm1.Items.Item(4).Specific;
                        text2.Item.Visible = false;

                        //creamos el boton para imprimir
                        Item oItem2;
                        SAPbouiCOM.Button oButton2;
                        oItem2 = oForm1.Items.Add("btnPrint", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton2 = (SAPbouiCOM.Button)oItem2.Specific;
                        //Agregando propiedades al boton
                        oButton2.Caption = "Print";
                        //agregando posicio del boton
                        oItem2.Top = oForm1.Height - (oItem2.Height + 7);
                        oItem2.Left = (oItem2.Width + 20) + 97;
                    }
                    //consumir evento luego de presionar el boton
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnFM" && pVal.BeforeAction == true)
                    {
                        if (false == oCompany.InTransaction)
                        {
                            oCompany.StartTransaction();
                        }
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oItem;

                        SAPbouiCOM.Matrix oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("3").Specific;
                        int row = oMatrix.RowCount;
                        int rec = 1;
                        string[] l_error = new string[row];
                        int l = 0;
                        Cursor.Current = Cursors.WaitCursor;
                        SAPbouiCOM.ProgressBar BarraProgreso;
                        BarraProgreso = SBO_Application.StatusBar.CreateProgressBar("Creando documentos masivos", row, true);
                        BarraProgreso.Value = 1;
                        int progreso = 1;
                        while (rec <= row)
                        {
                            BarraProgreso.Text = "Creando documentos masivos";
                            progreso += 1;
                            BarraProgreso.Value = progreso;// BarraProgreso.Value + 1;
                            oItem = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(rec).Specific;
                            string codigo = oItem.Value;
                            //para saber si sobrepasa la cantidad de lineas maximas
                            SAPbobsCOM.Recordset oCanLineas;
                            oCanLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oCanLineas.DoQuery("SELECT COUNT(T1.\"DocEntry\") FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"DocNum\"='" + codigo + "'");
                            int canLineas = int.Parse(oCanLineas.Fields.Item(0).Value.ToString());
                            if (canLineas > 45)
                            {
                                MessageBox.Show("El documento " + codigo + " excede la cantidad de lineas maximas");
                            }
                            else
                            {
                                //buscamos el establecimeinto y punto de exp correspondiente
                                SAPbobsCOM.Recordset oSeriesDatos;
                                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM OINV T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                                //procedemos a actualizar el documento
                                SAPbobsCOM.Recordset oDocAct;
                                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oDocAct.DoQuery("UPDATE OINV SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                                //consumimos el webservice
                                SAPbobsCOM.Recordset oFactu;
                                oFactu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oFactu.DoQuery("SELECT \"FolioNum\" FROM OINV WHERE \"DocNum\"='" + codigo + "'");
                                string FolioFact = oFactu.Fields.Item(0).Value.ToString();
                                //if(string.IsNullOrEmpty(FolioFact))
                                if (FolioFact.Equals("0"))
                                {

                                    CrearDocumento(codigo, "OINV", "INV1", "1", "FACTURA", "Factura electrónica");

                                }

                                //controlamos los errores
                                SAPbobsCOM.Recordset oListaError;
                                oListaError = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oListaError.DoQuery("SELECT \"FolioNum\" FROM OINV WHERE \"DocNum\"='" + codigo + "'");
                                string FolioError = oListaError.Fields.Item(0).Value.ToString();

                                if (FolioError.Equals("0"))
                                {
                                    l_error[l] = codigo;
                                    l++;
                                }
                            }

                            rec++;

                        }

                        BarraProgreso.Stop();
                        Cursor.Current = Cursors.Default;
                        if (l > 0)
                        {
                            string errores = string.Join(Environment.NewLine, l_error);
                            MessageBox.Show(errores);
                        }
                        else
                        {
                            l_error[0] = "Facturas creadas con exito";
                            MessageBox.Show(l_error[0].ToString());
                        }

                    }
                    //abrir impresion masiva de facturas
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnPrint" && pVal.BeforeAction == true)
                    {
                        //formulario de facturacion masiva
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oItem;
                        SAPbouiCOM.EditText oItem1;
                        SAPbouiCOM.EditText oFilaMaxtrix;
                        SAPbouiCOM.EditText oFilaPU;
                        //agarramos la matrix
                        SAPbouiCOM.Matrix oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("3").Specific;
                        int row = oMatrix.RowCount;

                        //actualizamos el estado de los documentos a Impreso
                        int fila = 1;
                        while (fila <= row)
                        {
                            oFilaMaxtrix = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(fila).Specific;
                            string FolioAct = oFilaMaxtrix.Value;

                            SAPbobsCOM.Recordset ActEstado;
                            ActEstado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            ActEstado.DoQuery("UPDATE OINV SET \"Printed\"='Y' WHERE \"DocNum\"='" + FolioAct + "'");
                            fila++;
                        }

                        //agarramos el primer y ultimo folio
                        int filaPU = 1;
                        string auxP = null;
                        string auxU = null;
                        string FolioPU = null;
                        string FolioBusqueda = null;
                        while (filaPU <= row)
                        {
                            oFilaPU = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(filaPU).Specific;
                            FolioBusqueda = oFilaPU.Value;
                            SAPbobsCOM.Recordset NumFolio;
                            NumFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            NumFolio.DoQuery("SELECT \"FolioNum\" FROM OINV WHERE \"DocNum\"='" + FolioBusqueda + "'");
                            FolioPU = NumFolio.Fields.Item(0).Value.ToString();

                            if (filaPU == 1)
                            {
                                auxP = FolioPU;
                                auxU = FolioPU;
                            }
                            else
                            {
                                int NumauxP = int.Parse(auxP);
                                int NumauxU = int.Parse(auxU);
                                int Numfolio = int.Parse(FolioPU);

                                if (Numfolio < NumauxP)
                                {
                                    auxP = FolioPU;
                                }
                                if (Numfolio > NumauxU)
                                {
                                    auxU = FolioPU;
                                }
                            }
                            filaPU++;

                        }


                        //agarramos el primer y ultimo documento de la matrix
                        oItem = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(1).Specific;
                        FolioIni = oItem.Value;
                        //oItem1 = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(row).Specific;
                        //FolioFin = oItem1.Value;
                        //query para consultar los folios
                        SAPbobsCOM.Recordset query;
                        query = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("select T1.\"SeriesName\" from OINV T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" where T0.\"DocNum\"='" + FolioIni + "'");


                        //agarramos el reporte correspondiente
                        SBO_Application.ActivateMenuItem("ca83ab56bb664f5cb8e3306dbb9c0baf");
                        SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                        //guadamos las variables a mandar
                        string copyInicio = auxP;
                        string copyFin = auxU;
                        string copySerie = query.Fields.Item(0).Value.ToString();
                        //agarramos los campos del formulario del rpeorte
                        SAPbouiCOM.EditText inicio = (SAPbouiCOM.EditText)form.Items.Item("1000003").Specific;
                        SAPbouiCOM.EditText fin = (SAPbouiCOM.EditText)form.Items.Item("1000009").Specific;
                        SAPbouiCOM.EditText serie = (SAPbouiCOM.EditText)form.Items.Item("1000015").Specific;
                        SAPbouiCOM.Button btnok = (SAPbouiCOM.Button)form.Items.Item("1").Specific;
                        //mandamos las variables a los campos del reporte
                        inicio.Value = copyInicio;
                        fin.Value = copyFin;
                        serie.Value = copySerie;
                        //inhabilitamos los campos para que no puedan modificarse
                        inicio.Item.Enabled = false;
                        fin.Item.Enabled = false;
                        //serie.Item.Enabled = false;
                        btnok.Item.Click();

                    }

                }
                #endregion

                //FACTURA
                #region FACTURA
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-133")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }

                    //evento al presionar ENTER en el campo info adicional
                    if (pVal.ItemUID == "U_InfoAdicional" && pVal.CharPressed == (char)13 && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oInfo = (SAPbouiCOM.EditText)oForm.Items.Item("U_InfoAdicional").Specific;
                        string v_texto = oInfo.Value;
                        v_texto = v_texto.Replace("\n", string.Empty);
                        v_texto = v_texto + ". ";
                        oInfo.Value = v_texto;
                        MessageBox.Show("No esta permitido dar salto de linea en este campo!!","Atención",MessageBoxButtons.OK,MessageBoxIcon.Warning);
                    }
                }

                if (pVal.FormTypeEx == "133")
                {
                    //creamos el boton para lectura del PDF
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        SAPbouiCOM.Button oButton;
                        oItem = oForm.Items.Add("btnPreview", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton = (SAPbouiCOM.Button)oItem.Specific;
                        //Agregando propiedades al boton
                        oButton.Caption = "PDF";
                        //agregando posicio del boton
                        oItem.Top = oForm.Height - (oItem.Height + 9);
                        oItem.Left = (oItem.Width + 20) + 60;


                    }


                    //en caso de presionar el boton cancelar, seteamos el campo auxiliar del botoncrear
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "2")
                    {
                        botonAdd = "";
                    }
                    //al presionar crear, tomamos el valor del numero de documento y guardamos el ID del boton crear para poder usar para el webserivce
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        Item SNCode;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        SAPbouiCOM.Matrix oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("38").Specific;
                        int row = oMatrix.RowCount;
                        if (row > 45)
                        {
                            SBO_Application.SetStatusBarMessage("El detalle no puede superar 45 lineas", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }

                        //validaciones del socio de negocio
                        string v_direB = null, v_direS = null, v_indus = null, v_natu = null, v_cont = null;
                        SNCode = oForm.Items.Item("4");
                        EditText oSNCode = (SAPbouiCOM.EditText)SNCode.Specific;
                        string v_sncode = oSNCode.Value;
                        EditText oLici = (SAPbouiCOM.EditText)oForm.Items.Item("").Specific;
                        string v_licitacion = oLici.Value.ToString();

                        SAPbobsCOM.Recordset query;
                        query = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT T0.\"IndustryC\",T0.\"U_iNatRec\",T0.\"U_iTipCont\",T1.\"Address\",T2.\"Address\" " +
                            "FROM OCRD T0 " +
                            "LEFT JOIN CRD1 T1 ON T1.\"CardCode\"=T0.\"CardCode\" AND T1.\"AdresType\"='B' " +
                            "LEFT JOIN CRD1 T2 ON T2.\"CardCode\"=T0.\"CardCode\" AND T2.\"AdresType\"='S' " +
                            "WHERE T0.\"CardCode\"='" + v_sncode + "'");
                        v_indus = query.Fields.Item(0).Value.ToString();
                        v_natu = query.Fields.Item(1).Value.ToString();
                        v_cont = query.Fields.Item(2).Value.ToString();
                        v_direB = query.Fields.Item(3).Value.ToString();
                        v_direS = query.Fields.Item(4).Value.ToString();
                        //verificamos si no estan vacios
                        if (string.IsNullOrEmpty(v_indus) || v_indus.Equals("0"))
                        {
                            SBO_Application.SetStatusBarMessage("Debe agregar el tipo de operacion al Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }
                        if (string.IsNullOrEmpty(v_natu))
                        {
                            SBO_Application.SetStatusBarMessage("Debe agregar la Naturaleza al Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }
                        if (string.IsNullOrEmpty(v_cont))
                        {
                            SBO_Application.SetStatusBarMessage("Debe agregar el tipo de contribuyente Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }
                        if (string.IsNullOrEmpty(v_direB))
                        {
                            if (string.IsNullOrEmpty(v_direS))
                            {
                                SBO_Application.SetStatusBarMessage("Debe agregar Direccion al Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                                return;
                            }
                        }
                        if (v_direB.Equals(v_direS))
                        {
                            SBO_Application.SetStatusBarMessage("Las direcciones son iguales, modificar el Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }
                        if (v_indus.Equals("3") && string.IsNullOrEmpty(v_licitacion))
                        {
                            MessageBox.Show("Debe agregar el código de licitación");
                            return;
                        }

                    }
                    //una vez terminado el proceso de creacion de la factura, consultamos el docentry de la factura creada y consumimos el web service
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "133" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //string codigo = oText.Value;
                        string tablacab = "OINV";
                        string tabladet = "INV1";
                        //control para saber si es o no documento de cancelación
                        SAPbobsCOM.Recordset oCancel;
                        oCancel = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oCancel.DoQuery("SELECT \"CANCELED\",\"Series\" FROM OINV WHERE \"DocNum\"='" + codigo + "' ");
                        string v_cancel = oCancel.Fields.Item(0).Value.ToString();
                        string v_series = oCancel.Fields.Item(1).Value.ToString();
                        //consultamos si es documento de cancelacion
                        if (v_cancel.Equals("N"))
                        {
                            //verificamos si es salones
                            SAPbobsCOM.Recordset oSalones;
                            oSalones = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oSalones.DoQuery("select COUNT(*) FROM \"V_SERIES_SALON\" WHERE \"SERIE\"='" + v_series + "'");
                            int v_serieSalones = int.Parse(oSalones.Fields.Item(0).Value.ToString());
                            if (v_serieSalones > 0)
                            {
                                CrearDocumentoSalones(codigo, tablacab, tabladet, "1", "FACTURA", "Factura electrónica");
                                //buscamos el documento creado
                                oForm.Mode = BoFormMode.fm_FIND_MODE;
                                EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;
                                SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                                oDocNum.Value = codigo;
                                oButton.Item.Click();

                            }
                            else
                            {
                                CrearDocumento(codigo, tablacab, tabladet, "1", "FACTURA", "Factura electrónica");
                                //buscamos el documento creado
                                oForm.Mode = BoFormMode.fm_FIND_MODE;
                                EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;
                                SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                                oDocNum.Value = codigo;
                                oButton.Item.Click();

                            }

                        }
                        //SBO_Application.StatusBar.SetText("Factura generada con exito ", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                        //botonAdd = "";
                    }
                    //evento cuando se presiona el boton de preview documento
                    if (pVal.ItemUID == "btnPreview" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        //CrearDocumento("52308148", "OINV", "INV1", "1", "FACTURA", "Factura electrónica");
                        //ReenviarDocumento("56285319", "OINV", "INV1", "1", "FACTURA", "Factura electrónica", "5342");
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //para obtener el docnum
                        Item oDocNum;
                        EditText oDoc;
                        oDocNum = oForm.Items.Item("8");
                        oDoc = (SAPbouiCOM.EditText)oDocNum.Specific;
                        string v_docnum = oDoc.Value;
                        //para obtener el folio
                        Item oFolio;
                        EditText oFol;
                        oFolio = oForm.Items.Item("211");
                        oFol = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oFol.Value;
                        //obtener descipcion del boton
                        Item oBtnitem;
                        SAPbouiCOM.Button btnPrev;
                        oBtnitem = oForm.Items.Item("btnPreview");
                        btnPrev = (SAPbouiCOM.Button)oBtnitem.Specific;
                        string v_Btn = btnPrev.Caption.ToString();

                        if (v_Btn.Equals("PDF"))
                        {
                            try
                            {
                                MessageBoxManager.Register();
                                MessageBoxManager.OK = "Impresiones";
                                MessageBoxManager.Yes = "Factura";
                                MessageBoxManager.No = "Senacsa";
                                DialogResult result = MessageBox.Show("Seleccionar documento a imprimir", "Impresion", MessageBoxButtons.YesNo);
                                if (result == DialogResult.Yes)
                                {
                                    //tomamos el valor del form y del item
                                    //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                                    Item oItem;
                                    oItem = oForm.Items.Item("8");
                                    oText = (SAPbouiCOM.EditText)oItem.Specific;
                                    codigo = oText.Value;
                                    string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                    try
                                    {
                                        SAPbobsCOM.Recordset query;
                                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                        query.DoQuery("SELECT \"U_KUDE\" FROM OINV WHERE \"DocNum\"=" + codigo);

                                        string KUDE = query.Fields.Item(0).Value.ToString();
                                        byte[] bytes = Convert.FromBase64String(KUDE);
                                        //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                        File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                        FileStream obj = File.Create(path + "\\temporal.pdf");
                                        obj.Write(bytes, 0, bytes.Length);
                                        obj.Flush();
                                        obj.Close();
                                        System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                        //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                                    }
                                    catch
                                    {

                                    }
                                }
                                else
                                {
                                    SBO_Application.ActivateMenuItem("f6391ffc991449faa759b574a5e8a3e9");
                                    SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                                    SAPbouiCOM.EditText inicio = (SAPbouiCOM.EditText)form.Items.Item("1000003").Specific;
                                    SAPbouiCOM.Button btnok = (SAPbouiCOM.Button)form.Items.Item("1").Specific;
                                    inicio.Value = codigo;
                                    btnok.Item.Click();
                                    form.Close();
                                }
                                MessageBoxManager.Unregister();
                            }
                            catch (Exception e)
                            {
                                MessageBox.Show(e.ToString());
                            }
                        }
                        else
                        {
                            ReenviarDocumento(v_docnum, "OINV", "INV1", "1", "FACTURA", "Factura electrónica", v_folio);
                        }


                    }
                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }

                    

                }
                #endregion

                //NOTA DE DEBITO
                #region NOTA DE DEBITO
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-65303")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }
                }

                if (pVal.FormTypeEx == "65303")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnPDFND", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 9);
                        oItem1.Left = (oItem1.Width + 20) + 60;
                    }

                    //agarramos el DocNum del documento
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;
                    }

                    //consumir web service despues de crear el documento
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "65303" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        //CrearDocumento(codigo, "OINV", "INV1", "6", "NOTA_DEBITO", "Nota de débito electrónica");
                        CrearNotaDebito(codigo);
                    }

                    //evento cuando se presiona el boton de preview documento
                    if (pVal.ItemUID == "btnPDFND" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //para obtener el docnum
                        Item oDocNum;
                        EditText oDoc;
                        oDocNum = oForm.Items.Item("8");
                        oDoc = (SAPbouiCOM.EditText)oDocNum.Specific;
                        string v_docnum = oDoc.Value;
                        //para obtener el folio
                        Item oFolio;
                        EditText oFol;
                        oFolio = oForm.Items.Item("211");
                        oFol = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oFol.Value;
                        //obtener descipcion del boton
                        Item oBtnitem;
                        SAPbouiCOM.Button btnPrev;
                        oBtnitem = oForm.Items.Item("btnPreview");
                        btnPrev = (SAPbouiCOM.Button)oBtnitem.Specific;
                        string v_Btn = btnPrev.Caption.ToString();

                        if (v_Btn.Equals("PDF"))
                        {
                            //tomamos el valor del form y del item
                            //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                            Item oItem;
                            oItem = oForm.Items.Item("8");
                            oText = (SAPbouiCOM.EditText)oItem.Specific;
                            codigo = oText.Value;
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            try
                            {
                                SAPbobsCOM.Recordset query;
                                query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                query.DoQuery("SELECT \"U_KUDE\" FROM OINV WHERE \"DocNum\"=" + codigo);

                                string KUDE = query.Fields.Item(0).Value.ToString();
                                byte[] bytes = Convert.FromBase64String(KUDE);
                                //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                FileStream obj = File.Create(path + "\\temporal.pdf");
                                obj.Write(bytes, 0, bytes.Length);
                                obj.Flush();
                                obj.Close();
                                System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                //File.Delete(Path.Combine(path + "\\temporal.pdf"));
                            }
                            catch
                            {

                            }
                        }
                        else
                        {

                        }


                    }
                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM ORIN WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM ORIN WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }
                }
                #endregion

                //FORM ANULAR
                #region ANULAR
                if (pVal.FormTypeEx == "UDO_FT_ANULAR")
                {
                    //cargar los combobox del form
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadAnular(oForm);
                    }
                    //agarrar los datos seleccionados del form
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true && pVal.ItemUID == "Item_0")
                    {
                        Cursor.Current = Cursors.WaitCursor;
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item fact1;
                        Item fact2;
                        Item fact3;
                        Item motivo;
                        SAPbouiCOM.ComboBox cboDocu;
                        SAPbouiCOM.ComboBox cboMoti;
                        fact1 = oForm.Items.Item("0_U_E");
                        fact2 = oForm.Items.Item("Item_3");
                        fact3 = oForm.Items.Item("Item_4");
                        motivo = oForm.Items.Item("1_U_E");
                        //cboDocu = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboDocu").Specific;
                        cboDocu = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboDocu").Specific;
                        string valorDocu = cboDocu.Selected.Value.ToString();
                        string tabla = null;
                        if (valorDocu.Equals("1"))
                        {
                            tabla = "OINV";
                        }
                        if (valorDocu.Equals("2"))
                        {
                            tabla = "ORIN";
                        }
                        if (valorDocu.Equals("3"))
                        {
                            tabla = "OINV";
                        }
                        if (valorDocu.Equals("4"))
                        {
                            tabla = "ODLN";
                        }
                        if (valorDocu.Equals("5"))
                        {
                            tabla = "OWTR";
                        }
                        if (valorDocu.Equals("6"))
                        {
                            tabla = "OINV";
                        }
                        cboMoti = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboMoti").Specific;
                        string v_moti = cboMoti.Selected.Description.ToString();
                        EditText f1 = (SAPbouiCOM.EditText)fact1.Specific;
                        EditText f2 = (SAPbouiCOM.EditText)fact2.Specific;
                        EditText f3 = (SAPbouiCOM.EditText)fact3.Specific;
                        EditText moti = (SAPbouiCOM.EditText)motivo.Specific;
                        string esta = f1.Value;
                        string punt = f2.Value;
                        string folio = f3.Value;
                        //verificamos si el documento no esta cerrado
                        string SubType = null;
                        if (valorDocu.Equals("3"))
                        {
                            SubType = " AND \"DocSubType\"='DN' ";
                        }
                        if (valorDocu.Equals("6"))
                        {
                            SubType = " AND \"DocSubType\"='IX' ";
                        }
                        else
                        {
                            SubType = " ";
                        }
                        //timbrado
                        string tim = null;
                        if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                        {
                            tim = "16094946";
                        }
                        else
                        {
                            tim = "16148774";

                        }

                        //consultamos si el documento esta rechazado, sino no ejecutar el proceso
                        SAPbobsCOM.Recordset oConsulta;
                        oConsulta = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oConsulta.DoQuery("SELECT \"U_ESTADO\" FROM " + tabla + " WHERE \"U_PEMI\"='" + punt + "' AND \"U_ESTA\"='" + esta + "' AND \"FolioNum\"='" + folio + "' ");
                        string v_estadoDoc = oConsulta.Fields.Item(0).Value.ToString();
                        if (v_estadoDoc.Equals("RECHAZADO"))
                        {
                            SBO_Application.SetStatusBarMessage("No se puede anular un documento RECHAZADO!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                            return;
                        }
                        else
                        {
                            Recordset DocCerrado;
                            DocCerrado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            DocCerrado.DoQuery("SELECT \"DocStatus\",\"DocDate\" FROM " + tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + punt + "' AND \"FolioNum\"='" + folio + "' AND \"U_TIMB\"='" + tim + "' " + SubType);
                            string estadoDoc = DocCerrado.Fields.Item(0).Value.ToString();
                            string fechaDoc = DocCerrado.Fields.Item(1).Value.ToString();
                            if (estadoDoc.Equals("C") && !tabla.Equals("ORIN"))
                            {
                                SBO_Application.StatusBar.SetText("Documento se encuentra cerrado, no se puede anular!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                return;
                            }
                            //restamos la fecha con la fecha actual
                            TimeSpan resta = DateTime.Now - DateTime.Parse(fechaDoc);
                            int dias = resta.Days;
                            if (tabla.Equals("OINV"))
                            {
                                if (dias > 2)
                                {
                                    SBO_Application.StatusBar.SetText("Documento ya exedió el limite de 48hs permitidos para anular!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    return;
                                }
                            }
                            if (tabla.Equals("ORIN"))
                            {
                                if (dias > 7)
                                {
                                    SBO_Application.StatusBar.SetText("Documento ya exedió el limite de 7 días permitidos para anular!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    return;
                                }
                            }

                            Cursor.Current = Cursors.WaitCursor;
                            AnularDocumento(esta, punt, folio, v_moti, tabla, SubType);
                            Cursor.Current = Cursors.Default;
                            f1.Value = "";
                            f2.Value = "";
                            f3.Value = "";
                            Cursor.Current = Cursors.Default;
                        }


                    }
                }
                #endregion

                //FORM CANCELAR               
                #region CANCELAR
                if (pVal.FormTypeEx == "UDO_FT_CANCELAR")
                {
                    //cargamos el combobox
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadCancelar(oForm);
                    }
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true && pVal.ItemUID == "btnCan")
                    {
                        Cursor.Current = Cursors.WaitCursor;
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item Docu;
                        Item tipo;
                        SAPbouiCOM.ComboBox cboTipo;
                        Docu = oForm.Items.Item("0_U_E");
                        //cboDocu = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboDocu").Specific;
                        cboTipo = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboTipo").Specific;
                        string valorDocu = cboTipo.Selected.Value.ToString();
                        string tabla = null;
                        string subtype = null;
                        if (valorDocu.Equals("1"))
                        {
                            tabla = "OINV";
                        }
                        if (valorDocu.Equals("2"))
                        {
                            tabla = "ORIN";
                        }
                        if (valorDocu.Equals("3"))
                        {
                            tabla = "OINV";
                            subtype = " AND \"DocSubType\"='DN' ";
                        }
                        if (valorDocu.Equals("4"))
                        {
                            tabla = "ODLN";
                        }
                        if (valorDocu.Equals("5"))
                        {
                            tabla = "OWTR";
                        }
                        if (valorDocu.Equals("6"))
                        {
                            tabla = "OINV";
                            subtype = " AND \"DocSubType\"='IX' ";
                        }
                        EditText v_docu = (SAPbouiCOM.EditText)Docu.Specific;
                        string docu_v = v_docu.Value;

                        //verificamos si el documento no esta cerrado
                        Recordset DocCerrado;
                        DocCerrado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        DocCerrado.DoQuery("SELECT \"DocStatus\",\"DocEntry\" FROM " + tabla + " WHERE \"DocNum\"='" + docu_v + "' AND \"U_TIMB\"='16094946' " + subtype);
                        string estadoDoc = DocCerrado.Fields.Item(0).Value.ToString();
                        string v_entry = DocCerrado.Fields.Item(1).Value.ToString();
                        if (estadoDoc.Equals("C") && !tabla.Equals("ORIN"))
                        {
                            SBO_Application.StatusBar.SetText("Documento se encuentra cerrado, no se puede Cancelar!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            return;
                        }
                        if (string.IsNullOrEmpty(estadoDoc))
                        {
                            SBO_Application.StatusBar.SetText("No existe documento!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            return;
                        }

                        if (tabla.Equals("OINV"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.Documents documento;
                            SAPbobsCOM.Documents docCancel;
                            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                docCancel = documento.CreateCancellationDocument();
                                int cancelado = docCancel.Add();
                                string error = oCompany.GetLastErrorDescription().ToString();
                                if (cancelado == 0)
                                {
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }
                            v_docu.Value = "";

                        }
                        if (tabla.Equals("ORIN"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.Documents documento;
                            SAPbobsCOM.Documents docCancel;
                            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                docCancel = documento.CreateCancellationDocument();
                                int cancelado = docCancel.Add();
                                if (cancelado == 0)
                                {
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }
                            v_docu.Value = "";
                        }
                        if (tabla.Equals("OINV"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.Documents documento;
                            SAPbobsCOM.Documents docCancel;
                            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                docCancel = documento.CreateCancellationDocument();
                                int cancelado = docCancel.Add();
                                if (cancelado == 0)
                                {
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }
                            v_docu.Value = "";
                        }
                        if (tabla.Equals("ODLN"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.Documents documento;
                            SAPbobsCOM.Documents docCancel;
                            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                docCancel = documento.CreateCancellationDocument();
                                int cancelado = docCancel.Add();
                                if (cancelado == 0)
                                {
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }
                            v_docu.Value = "";
                        }
                        if (tabla.Equals("OWTR"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.StockTransfer documento;
                            documento = (SAPbobsCOM.StockTransfer)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                int cancelado = documento.Cancel();
                                if (cancelado == 0)
                                {
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }
                        }
                        v_docu.Value = "";
                        Cursor.Current = Cursors.Default;
                    }
                }
                #endregion

                //REMISION ENTREGA
                #region REMISION ENTREGA
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-140")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }

                    //evento al presionar ENTER en el campo info adicional
                    if (pVal.ItemUID == "U_InfoAdicional" && pVal.CharPressed == (char)13 && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oInfo = (SAPbouiCOM.EditText)oForm.Items.Item("U_InfoAdicional").Specific;
                        string v_texto = oInfo.Value;
                        v_texto = v_texto.Replace("\n", string.Empty);
                        v_texto = v_texto + ". ";
                        oInfo.Value = v_texto;
                        MessageBox.Show("No esta permitido dar salto de linea en este campo!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    }

                    //evento al presionar ENTER en el campo info adicional
                    if (pVal.ItemUID == "U_Info_Export" && pVal.CharPressed == (char)13 && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oInfo = (SAPbouiCOM.EditText)oForm.Items.Item("U_Info_Export").Specific;
                        string v_texto = oInfo.Value;
                        v_texto = v_texto.Replace("\n", string.Empty);
                        v_texto = v_texto + ". ";
                        oInfo.Value = v_texto;
                        MessageBox.Show("No esta permitido dar salto de linea en este campo!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    }

                }
                if (pVal.FormTypeEx == "140")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        //BOTON GENERAR REMISION
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnRemi", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "Remision/PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 9);
                        oItem1.Left = (oItem1.Width + 20) + 130;

                        //BOTON PDF
                        //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //Item oItem2;
                        //SAPbouiCOM.Button oButton;
                        //oItem2 = oForm.Items.Add("btnPDFRemi", BoFormItemTypes.it_BUTTON);
                        ////Inicializando el objeto boton con la referencia del objeto item
                        //oButton = (SAPbouiCOM.Button)oItem2.Specific;
                        ////Agregando propiedades al boton
                        //oButton.Caption = "PDF";
                        ////agregando posicio del boton
                        //oItem2.Top = oForm.Height - (oItem2.Height + 9);
                        //oItem2.Left = (oItem2.Width + 20) + 200;
                    }

                    //disparar evento para consultar el servicio para remision
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnRemi" && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        Item oFolio;
                        Item oItemTras, oItemChof, oItemChapa;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        oFolio = oForm.Items.Item("211");
                        EditText oNumFolio = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oNumFolio.Value;
                        //NotaRemision(codigo, "ODLN", "DLN1");
                        if (string.IsNullOrEmpty(v_folio) || v_folio.Equals("0"))
                        {
                            NotaRemision(codigo, "ODLN", "DLN1");
                        }
                        else
                        {
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            try
                            {
                                //NotaRemision("4621221", "ODLN", "DLN1");
                                SAPbobsCOM.Recordset query;
                                query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                query.DoQuery("SELECT \"U_KUDE\" FROM ODLN WHERE \"DocNum\"=" + codigo);

                                string KUDE = query.Fields.Item(0).Value.ToString();
                                byte[] bytes = Convert.FromBase64String(KUDE);
                                //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                FileStream obj = File.Create(path + "\\temporal.pdf");
                                obj.Write(bytes, 0, bytes.Length);
                                obj.Flush();
                                obj.Close();
                                System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                            }
                            catch (Exception e)
                            {

                            }
                        }

                    }
                    //vizualuzar PDF
                    //if (pVal.ItemUID == "btnPDFRemi" && pVal.BeforeAction == true)
                    //{

                    //    //tomamos el valor del form y del item
                    //    SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                    //    Item oItem;
                    //    oItem = oForm.Items.Item("8");
                    //    oText = (SAPbouiCOM.EditText)oItem.Specific;
                    //    codigo = oText.Value;
                    //    string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                    //    try
                    //    {
                    //        SAPbobsCOM.Recordset query;
                    //        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //        query.DoQuery("SELECT \"U_KUDE\" FROM ODLN WHERE \"DocNum\"=" + codigo);

                    //        string KUDE = query.Fields.Item(0).Value.ToString();
                    //        byte[] bytes = Convert.FromBase64String(KUDE);
                    //        //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                    //        File.Delete(Path.Combine(path + "\\temporal.pdf"));
                    //        FileStream obj = File.Create(path + "\\temporal.pdf");
                    //        obj.Write(bytes, 0, bytes.Length);
                    //        obj.Flush();
                    //        obj.Close();
                    //        System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                    //        //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                    //    }
                    //    catch (Exception e)
                    //    {

                    //    }

                    //}

                }
                #endregion

                //REMISION TRASLADO
                #region REMISION TRASLADO
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-940")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }

                    //evento al presionar ENTER en el campo info adicional
                    if (pVal.ItemUID == "U_InfoAdicional" && pVal.CharPressed == (char)13 && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oInfo = (SAPbouiCOM.EditText)oForm.Items.Item("U_InfoAdicional").Specific;
                        string v_texto = oInfo.Value;
                        v_texto = v_texto.Replace("\n", string.Empty);
                        v_texto = v_texto + ". ";
                        oInfo.Value = v_texto;
                        MessageBox.Show("No esta permitido dar salto de linea en este campo!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    }
                }
                if (pVal.FormTypeEx == "940")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnRemi", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "Remision/PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 8);
                        oItem1.Left = (oItem1.Width + 20) + 130;

                        //BOTON PDF
                        //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //Item oItem2;
                        //SAPbouiCOM.Button oButton;
                        //oItem2 = oForm.Items.Add("btnPDFRemi", BoFormItemTypes.it_BUTTON);
                        ////Inicializando el objeto boton con la referencia del objeto item
                        //oButton = (SAPbouiCOM.Button)oItem2.Specific;
                        ////Agregando propiedades al boton
                        //oButton.Caption = "PDF";
                        ////agregando posicio del boton
                        //oItem2.Top = oForm.Height - (oItem2.Height + 8);
                        //oItem2.Left = (oItem2.Width + 20) + 200;
                    }
                    //disparar evento para consultar el servicio para remision
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnRemi" && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        Item oFolio;

                        oFolio = oForm.Items.Item("10000056");
                        EditText oNumFolio = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oNumFolio.Value;

                        oItem = oForm.Items.Item("11");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        if (string.IsNullOrEmpty(v_folio) || v_folio.Equals("0"))
                        {
                            NotaRemision(codigo, "OWTR", "WTR1");
                        }
                        else
                        {
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            try
                            {
                                SAPbobsCOM.Recordset query;
                                query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                query.DoQuery("SELECT \"U_KUDE\" FROM OWTR WHERE \"DocNum\"=" + codigo);

                                string KUDE = query.Fields.Item(0).Value.ToString();
                                byte[] bytes = Convert.FromBase64String(KUDE);
                                //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                FileStream obj = File.Create(path + "\\temporal.pdf");
                                obj.Write(bytes, 0, bytes.Length);
                                obj.Flush();
                                obj.Close();
                                System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                            }
                            catch (Exception e)
                            {

                            }
                        }



                    }
                    //vizualuzar PDF
                    //if (pVal.ItemUID == "btnPDFRemi" && pVal.BeforeAction == true)
                    //{

                    //    //tomamos el valor del form y del item
                    //    SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                    //    Item oItem;
                    //    oItem = oForm.Items.Item("11");
                    //    oText = (SAPbouiCOM.EditText)oItem.Specific;
                    //    codigo = oText.Value;
                    //    string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                    //    try
                    //    {
                    //        SAPbobsCOM.Recordset query;
                    //        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //        query.DoQuery("SELECT \"U_KUDE\" FROM OWTR WHERE \"DocNum\"=" + codigo);

                    //        string KUDE = query.Fields.Item(0).Value.ToString();
                    //        byte[] bytes = Convert.FromBase64String(KUDE);
                    //        //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                    //        File.Delete(Path.Combine(path + "\\temporal.pdf"));
                    //        FileStream obj = File.Create(path + "\\temporal.pdf");
                    //        obj.Write(bytes, 0, bytes.Length);
                    //        obj.Flush();
                    //        obj.Close();
                    //        System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                    //        //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                    //    }
                    //    catch (Exception e)
                    //    {

                    //    }

                    //}
                }
                #endregion

                //NOTA DE CREDITO
                #region NOTA DE CREDITO
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-179")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }

                    //evento al presionar ENTER en el campo info adicional
                    if (pVal.ItemUID == "U_InfoAdicional" && pVal.CharPressed == (char)13 && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oInfo = (SAPbouiCOM.EditText)oForm.Items.Item("U_InfoAdicional").Specific;
                        string v_texto = oInfo.Value;
                        v_texto = v_texto.Replace("\n", string.Empty);
                        v_texto = v_texto + ". ";
                        oInfo.Value = v_texto;
                        MessageBox.Show("No esta permitido dar salto de linea en este campo!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    }
                }
                if (pVal.FormTypeEx == "179")
                {

                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnPDFNC", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 9);
                        oItem1.Left = (oItem1.Width + 20) + 60;
                    }
                    //al presionar crear, tomamos el valor del numero de documento y guardamos el ID del boton crear para poder usar para el webserivce
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;
                        //botonAdd = "1";

                    }
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "179" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //control para saber si es o no documento de cancelación
                        SAPbobsCOM.Recordset oCancel;
                        oCancel = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oCancel.DoQuery("SELECT \"CANCELED\" FROM ORIN WHERE \"DocNum\"='" + codigo + "' ");
                        string v_cancel = oCancel.Fields.Item(0).Value.ToString();
                        //consultamos si es documento de cancelacion
                        if (v_cancel.Equals("N"))
                        {
                            CrearDocumento(codigo, "ORIN", "RIN1", "5", "NOTA_CREDITO", "Nota de crédito electrónica");
                            //buscamos el documento creado
                            oForm.Mode = BoFormMode.fm_FIND_MODE;
                            EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;
                            SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                            oDocNum.Value = codigo;
                            oButton.Item.Click();
                        }

                    }
                    //visualizar PDF
                    if (pVal.ItemUID == "btnPDFNC" && pVal.BeforeAction == false)
                    {
                        //CrearDocumento("14101478", "ORIN", "RIN1", "5", "NOTA_CREDITO", "Nota de crédito electrónica");
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //para obtener el docnum
                        Item oDocNum;
                        EditText oDoc;
                        oDocNum = oForm.Items.Item("8");
                        oDoc = (SAPbouiCOM.EditText)oDocNum.Specific;
                        string v_docnum = oDoc.Value;
                        //para obtener el folio
                        Item oFolio;
                        EditText oFol;
                        oFolio = oForm.Items.Item("211");
                        oFol = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oFol.Value;
                        //obtener descipcion del boton
                        Item oBtnitem;
                        SAPbouiCOM.Button btnPrev;
                        oBtnitem = oForm.Items.Item("btnPDFNC");
                        btnPrev = (SAPbouiCOM.Button)oBtnitem.Specific;
                        string v_Btn = btnPrev.Caption.ToString();

                        if (v_Btn.Equals("PDF"))
                        {
                            //tomamos el valor del form y del item
                            //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                            Item oItem;
                            oItem = oForm.Items.Item("8");
                            oText = (SAPbouiCOM.EditText)oItem.Specific;
                            codigo = oText.Value;
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            try
                            {
                                SAPbobsCOM.Recordset query;
                                query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                query.DoQuery("SELECT \"U_KUDE\" FROM ORIN WHERE \"DocNum\"=" + codigo);

                                string KUDE = query.Fields.Item(0).Value.ToString();
                                byte[] bytes = Convert.FromBase64String(KUDE);
                                //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                FileStream obj = File.Create(path + "\\temporal.pdf");
                                obj.Write(bytes, 0, bytes.Length);
                                obj.Flush();
                                obj.Close();
                                System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                //File.Delete(Path.Combine(path + "\\temporal.pdf"));
                            }
                            catch (Exception e)
                            {

                            }
                        }
                        else
                        {
                            ReenviarDocumento(v_docnum, "ORIN", "RIN1", "5", "NOTA_CREDITO", "Nota de crédito electrónica", v_folio);
                        }


                    }
                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFNC").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM ORIN WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if ((v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFNC").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM ORIN WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if ((v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }
                }
                #endregion

                //AUTOFACTURA
                #region AUTOFACTURA
                if (pVal.FormTypeEx == "UDO_FT_AutoFactura")
                {
                    //agarramos el DocNum del documento
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;
                    }

                    //consumimos el web service luego de crear el documento
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "UDO_FT_AutoFactura" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {

                    }
                }
                #endregion

                //FACTURA EXPORT
                #region FACTURA EXPORT
                //bloquear campos
                if (pVal.FormTypeEx == "-65307")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }

                    //evento al presionar ENTER en el campo info adicional
                    if (pVal.ItemUID == "U_Info_Export" && pVal.CharPressed == (char)13 && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oInfo = (SAPbouiCOM.EditText)oForm.Items.Item("U_Info_Export").Specific;
                        string v_texto = oInfo.Value;
                        v_texto = v_texto.Replace("\n", string.Empty);
                        v_texto = v_texto + ". ";
                        oInfo.Value = v_texto;
                        MessageBox.Show("No esta permitido dar salto de linea en este campo!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    }
                }
                //creamos el boton de PDF
                if (pVal.FormTypeEx == "65307")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnPDFEX", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 9);
                        oItem1.Left = (oItem1.Width + 20) + 60;
                    }

                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        Item oItem2;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        oItem2 = oForm.Items.Item("29");
                        oValor = (SAPbouiCOM.EditText)oItem2.Specific;
                        DocTotal = oValor.Value;

                    }

                    //al pesionar crear, abrimos el form del detalle del documento de export que mandaremos
                    if (pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "65307" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        //validaciones de campos para export
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.ComboBox oDirePay = (SAPbouiCOM.ComboBox)oForm.Items.Item("226").Specific;//direccion paycode
                        SAPbouiCOM.ComboBox oDireShip = (SAPbouiCOM.ComboBox)oForm.Items.Item("40").Specific;//direccion shipcode
                        SAPbouiCOM.EditText oCardCode = (SAPbouiCOM.EditText)oForm.Items.Item("4").Specific;//codigo del SN
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;//DocNum
                        SAPbouiCOM.Button oBtn = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
                        string v_direPay = oDirePay.Selected.Value.ToString();
                        string v_direShip = oDireShip.Selected.Value.ToString();
                        string v_cardcode = oCardCode.Value.ToString();
                        string v_DocNum = oDocNum.Value.ToString();
                        //si las direcciones estan vacías
                        if (string.IsNullOrEmpty(v_direPay) && string.IsNullOrEmpty(v_direShip))
                        {
                            MessageBox.Show("La dirección en la factura no puede quedar vacío!!");
                            //oBtn.Caption = "Re-enviar";
                            return;
                        }
                        //si hay datos vacíos del SN
                        SAPbobsCOM.Recordset querySN;
                        querySN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        querySN.DoQuery("SELECT \"IndustryC\",\"U_iNatRec\",\"U_iTipCont\" FROM OCRD WHERE \"CardCode\"='" + v_cardcode + "' ");
                        string v_industry = querySN.Fields.Item(0).Value.ToString();
                        string v_nat = querySN.Fields.Item(1).Value.ToString();
                        string v_cont = querySN.Fields.Item(2).Value.ToString();
                        //consulta apara el pais
                        if (!string.IsNullOrEmpty(v_direShip))
                        {
                            SAPbobsCOM.Recordset paisSN;
                            paisSN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            paisSN.DoQuery("SELECT \"Country\" FROM CRD1 WHERE \"CardCode\"='" + v_cardcode + "' ");
                            string v_pais = paisSN.Fields.Item(0).Value.ToString();
                            if (string.IsNullOrEmpty(v_pais))
                            {
                                MessageBox.Show("Se debe cargar el país del receptor!!");
                                //oBtn.Caption = "Re-enviar";
                                return;
                            }
                        }
                        if (!string.IsNullOrEmpty(v_direPay))
                        {
                            SAPbobsCOM.Recordset paisSN;
                            paisSN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            paisSN.DoQuery("SELECT \"Country\" FROM CRD1 WHERE \"CardCode\"='" + v_cardcode + "' ");
                            string v_pais = paisSN.Fields.Item(0).Value.ToString();
                            if (string.IsNullOrEmpty(v_pais))
                            {
                                MessageBox.Show("Se debe cargar el país del receptor!!");
                                //oBtn.Caption = "Re-enviar";
                                return;
                            }
                        }


                        if (string.IsNullOrEmpty(v_industry) || v_industry.Equals("0"))
                        {
                            MessageBox.Show("El tipo de operación del Socio de negocio no puede quedar vacío!!");
                            //oBtn.Caption = "Re-enviar";
                            return;
                        }
                        else if (string.IsNullOrEmpty(v_nat))
                        {
                            MessageBox.Show("La naturaleza del receptor no puede quedar vacío!!");
                            //oBtn.Caption = "Re-enviar";
                            return;
                        }
                        else if (string.IsNullOrEmpty(v_cont))
                        {
                            MessageBox.Show("El tipo de contribuyente del receptor no puede quedar vacío");
                            //oBtn.Caption = "Re-enviar";
                            return;
                        }
                        else
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "EXPORT", "");
                            //SBO_Application.ActivateMenuItem("47667");//47660
                            SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                        }


                    }

                    //evento cuando se presiona el boton de preview documento
                    if (pVal.ItemUID == "btnPDFEX" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        //CrearDocumentoExport("2010502", "OINV", "INV1", "1", "FACTURA", "Factura electrónica","",0);
                        //tomamos el valor del form y del item
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        SAPbouiCOM.Button obtn = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
                        string v_btntexto = obtn.Caption.ToString();

                        if (v_btntexto.Equals("Re-enviar"))
                        //if (v_btntexto.Equals("PDF"))
                        {
                            validacionExport(oForm);
                        }
                        else
                        {
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            SAPbobsCOM.Recordset query;
                            query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            query.DoQuery("SELECT \"U_KUDE\" FROM OINV WHERE \"DocNum\"=" + codigo + " AND \"DocSubType\"='IX' ");

                            string KUDE = query.Fields.Item(0).Value.ToString();
                            byte[] bytes = Convert.FromBase64String(KUDE);
                            //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            File.Delete(Path.Combine(path + "\\temporal.pdf"));
                            FileStream obj = File.Create(path + "\\temporal.pdf");
                            obj.Write(bytes, 0, bytes.Length);
                            obj.Flush();
                            obj.Close();
                            System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                            //File.Delete(Path.Combine(path + "\\temporal.pdf"));
                        }



                    }
                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " AND \"DocSubType\"='IX' ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O"))
                            {
                                if (!v_estadoSet.Equals("APROBADO") && !v_estadoSet.Equals("PROCESADO"))
                                {
                                    btnreenviar.Caption = "Re-enviar";
                                }

                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " AND \"DocSubType\"='IX' ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O"))
                            {
                                if (!v_estadoSet.Equals("APROBADO") && !v_estadoSet.Equals("PROCESADO"))
                                {
                                    btnreenviar.Caption = "Re-enviar";
                                }
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }


                }

                //cargar datos en el UDO detalle export
                if (pVal.FormTypeEx == "UDO_FT_EXPORT")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadExport(oForm);
                    }

                    //acturalizar el campo de la descripcion de la grilla segun lo seleccionado en el combo
                    if (pVal.ItemUID == "Item_0" && pVal.EventType == BoEventTypes.et_COMBO_SELECT && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Item oItem;
                        SAPbouiCOM.ComboBox cboItem;
                        SAPbouiCOM.ComboBoxColumn cbcol;
                        SAPbouiCOM.Grid grilla;

                        oItem = oForm.Items.Item("Item_0");
                        grilla = (SAPbouiCOM.Grid)oItem.Specific;
                        //cbcol = (SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item(0);
                        int index = grilla.GetDataTableRowIndex(pVal.Row);
                        string desc = ((SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item("ItemCode")).GetSelectedValue(pVal.Row).Description;
                        grilla.DataTable.SetValue(1, index, desc);
                    }
                    //agregar un alinea al presionar ENTER
                    if (pVal.CharPressed == 13 && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid grilla;
                        grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_0").Specific;
                        grilla.DataTable.Rows.Add();
                    }

                    //grabar los datos en la tabla
                    if (pVal.ItemUID == "btCrear" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid grilla;
                        SAPbouiCOM.Item oItem;
                        SAPbouiCOM.DBDataSource source = oForm.DataSources.DBDataSources.Item("@EXPORT");
                        source.Clear();
                        SAPbouiCOM.EditText DocNumExport = (SAPbouiCOM.EditText)oForm.Items.Item("1_U_E").Specific;
                        SAPbouiCOM.Button btnCancelar = (SAPbouiCOM.Button)oForm.Items.Item("2").Specific;
                        //datos extras de export
                        //tipo de operacion
                        SAPbouiCOM.EditText oOpe;
                        oOpe = (SAPbouiCOM.EditText)oForm.Items.Item("Item_12").Specific;
                        string v_ope = oOpe.Value;
                        //condicion
                        SAPbouiCOM.ComboBox oCond;
                        oCond = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_13").Specific;
                        string v_cond = oCond.Selected.Value.ToString();
                        //pais destino
                        SAPbouiCOM.EditText oPais;
                        oPais = (SAPbouiCOM.EditText)oForm.Items.Item("Item_14").Specific;
                        string v_pais = oPais.Value;
                        //empresa fletera
                        SAPbouiCOM.EditText oFlete;
                        oFlete = (SAPbouiCOM.EditText)oForm.Items.Item("Item_15").Specific;
                        string v_flete = oFlete.Value;
                        //agente de trasnporte
                        SAPbouiCOM.EditText oTrans;
                        oTrans = (SAPbouiCOM.EditText)oForm.Items.Item("Item_16").Specific;
                        string v_trans = oTrans.Value;
                        //embarque
                        SAPbouiCOM.EditText oEmb;
                        oEmb = (SAPbouiCOM.EditText)oForm.Items.Item("Item_17").Specific;
                        string v_emb = oEmb.Value;
                        //manifiesto
                        SAPbouiCOM.EditText oMani;
                        oMani = (SAPbouiCOM.EditText)oForm.Items.Item("Item_18").Specific;
                        string v_mani = oMani.Value;
                        //barcaza
                        SAPbouiCOM.EditText oBarc;
                        oBarc = (SAPbouiCOM.EditText)oForm.Items.Item("Item_19").Specific;
                        string v_barc = oBarc.Value;
                        //instruccion de pago
                        SAPbouiCOM.EditText oPago;
                        oPago = (SAPbouiCOM.EditText)oForm.Items.Item("Item_20").Specific;
                        string v_pago = oPago.Value;
                        //armar el string que ira a la set
                        string v_infoSet = "Tipo operacion: " + v_ope + ", condicion: " + v_cond + ", país destino: " + v_pais + ", empresa fletera: " + v_flete + ", agente de transporte: " + v_trans + ", embarque: " + v_emb + ", Manifiesto: " + v_mani + ", barcaza: " + v_barc + ", instrucciones de pago: " + v_pago + "";

                        string NumExport = DocNumExport.Value;
                        oItem = oForm.Items.Item("Item_0");
                        grilla = (SAPbouiCOM.Grid)oItem.Specific;
                        int can = grilla.Rows.Count;
                        int f = 1;
                        int i = 0;
                        int MaxCod = 0;
                        SAPbobsCOM.Recordset codMax;
                        codMax = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        codMax.DoQuery("select CASE WHEN MAX(\"DocEntry\")=0 THEN 1 ELSE  MAX(\"DocEntry\") END from \"@EXPORT\" ");
                        MaxCod = int.Parse(codMax.Fields.Item(0).Value.ToString()) + 1;

                        while (f <= can)
                        {
                            string cod = ((SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item("ItemCode")).GetSelectedValue(i).Value;
                            string descrip = ((SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item("ItemCode")).GetSelectedValue(i).Description;
                            string cant = grilla.DataTable.GetValue(2, i).ToString();
                            string monto = grilla.DataTable.GetValue(3, i).ToString();

                            SAPbobsCOM.Recordset crear;
                            crear = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            crear.DoQuery("INSERT INTO \"@EXPORT\" (\"Code\",\"Name\",\"DocEntry\",\"U_U_DocEntry\",\"U_U_ItemCode\",\"U_U_Dscription\",\"U_U_TotalLine\",\"U_U_LineId\",\"U_U_cantidad\") " +
                                                           " VALUES('" + MaxCod + "','" + MaxCod + "','" + MaxCod + "','" + NumExport + "','" + cod + "','" + descrip + "','" + monto + "','" + f + "','" + cant + "') ");
                            i++;
                            f++;
                            MaxCod++;
                        }
                        SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                        btnCancelar.Item.Click();
                        CrearDocumentoExport(codigo, "OINV", "INV1", "1", "FACTURA", "Factura electrónica", v_infoSet, can);
                        v_infoSet = "";


                    }
                    if (pVal.ItemUID == "Item_0" && pVal.EventType == BoEventTypes.et_DOUBLE_CLICK && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_0").Specific;
                        int fila = grilla.Rows.SelectedRows.Item(0, SAPbouiCOM.BoOrderType.ot_RowOrder);
                        grilla.DataTable.Rows.Remove(fila);
                    }


                }

                //

                #endregion

                //ACTUALIZAR SET
                #region SET
                if (pVal.FormTypeEx == "UDO_FT_TABLASET")
                {
                    if (pVal.ItemUID == "Item_0" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        string query = "SELECT \"U_CDC\" FROM OINV WHERE \"U_TIMB\"='16094946' AND (\"U_ESTADO\"!='APROBADO' AND \"U_ESTADO\"!='RECHAZADO') AND \"CANCELED\"='N' limit 900 ";
                        SAPbobsCOM.Recordset oDatosDoc;
                        oDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oDatosDoc.DoQuery(query);
                        //instanciamos el servicio
                        consultas.ConsultasClient cliente = new consultas.ConsultasClient();
                        consultas.consultaRequest consultaEstado = new consultas.consultaRequest();
                        consultas.consultaRequest1[] consultaEstado1 = new consultas.consultaRequest1[1];
                        consultas.consultaResponse consultaResp = new consultas.consultaResponse();
                        consultas.consultaResponse1 consultaResp1 = new consultas.consultaResponse1();
                        consultas.numeroTipoDocumento numTipo = new consultas.numeroTipoDocumento();
                        consultas.numeroTipoDocumento[] numTipo1 = new consultas.numeroTipoDocumento[1];

                        string[] v_cdc = new string[1];
                        string v_estado = null;
                        while (!oDatosDoc.EoF)
                        {
                            
                            // consumimos el servicio para saber el estado del documento
                            string msjError = null;
                            v_cdc[0] = oDatosDoc.Fields.Item(0).Value.ToString();
                            consultaEstado.cdc = v_cdc;
                            consultaEstado.ruc = 80003232;
                            consultaEstado.dv = "2";
                            consultaResp = cliente.consulta(consultaEstado);
                            v_estado = consultaResp.documento[0].estado;
                            if (v_estado.Equals("RECHAZADO") || v_estado.Equals("RECHAZADO_REINGRESADO"))
                            {
                                msjError = consultaResp.documento[0].documentoError[0].mensaje.ToString();
                            }

                            SAPbobsCOM.Recordset oActDoc;
                            oActDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oActDoc.DoQuery("UPDATE ");
                        }
                    }
                }
                #endregion

                //AUDITORIA
                #region AUDITORIA
                if (pVal.FormTypeEx == "UDO_FT_AUDITORIAFE")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadAuditoria(oForm);
                    }

                    //evento para actualizar los estados
                    if (pVal.ItemUID == "Item_1" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        ActualizarEstados();
                    }

                    //evento cuando se presiona el boton de filtrar
                    if (pVal.ItemUID == "Item_0" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btn = (SAPbouiCOM.Button)oForm.Items.Item("Item_0").Specific;
                        SAPbouiCOM.Grid grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
                        SAPbouiCOM.EditText fechaD = (SAPbouiCOM.EditText)oForm.Items.Item("Item_2").Specific;
                        SAPbouiCOM.EditText fechaH = (SAPbouiCOM.EditText)oForm.Items.Item("Item_3").Specific;
                        SAPbouiCOM.EditText serie = (SAPbouiCOM.EditText)oForm.Items.Item("Item_6").Specific;
                        SAPbouiCOM.EditText sn = (SAPbouiCOM.EditText)oForm.Items.Item("Item_36").Specific;
                        SAPbouiCOM.Button btndes = (SAPbouiCOM.Button)oForm.Items.Item("Item_37").Specific;
                        SAPbouiCOM.Button btncorreo = (SAPbouiCOM.Button)oForm.Items.Item("Item_39").Specific;

                        if (btn.Caption.Equals("Filtrar"))
                        {
                            ControlFE(oForm);
                            btn.Caption = "Limpiar";
                        }
                        else
                        {
                            grilla.DataTable.Clear();
                            btn.Caption = "Filtrar";
                            fechaD.Value = "";
                            fechaH.Value = "";
                            serie.Value = "";
                            sn.Value = "";
                            btndes.Item.Enabled = true;
                            btncorreo.Item.Enabled = false;
                        }
                    }
                    //evento para descargar PDF y XML
                    if (pVal.ItemUID == "Item_37" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        descargarPdfXml(oForm);
                        SAPbouiCOM.Button btndesc = (SAPbouiCOM.Button)oForm.Items.Item("Item_37").Specific;
                        SAPbouiCOM.Button btncorreo = (SAPbouiCOM.Button)oForm.Items.Item("Item_39").Specific;
                        btndesc.Item.Enabled = false;
                        btncorreo.Item.Enabled = true;
                    }
                    //evento para mandar correo
                    if (pVal.ItemUID == "Item_39" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid oGrilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
                        SAPbouiCOM.Button btndesc = (SAPbouiCOM.Button)oForm.Items.Item("Item_37").Specific;
                        SAPbouiCOM.Button btncorreo = (SAPbouiCOM.Button)oForm.Items.Item("Item_39").Specific;
                        int GrillaCount = oGrilla.DataTable.Rows.Count;
                        int contador = 0;
                        //barra de progreso
                        //SAPbouiCOM.ProgressBar BarraProgreso;
                        //BarraProgreso = SBO_Application.StatusBar.CreateProgressBar("Enviando documentos por correo", GrillaCount, true);
                        //BarraProgreso.Value = 1;
                        //int progreso = 1;

                        while (GrillaCount > contador)
                        {
                            // barra de progreso, estado
                            //BarraProgreso.Text = "Enviando documentos por correo";
                            //progreso += 1;
                            //BarraProgreso.Value = progreso;
                            string valorchk = oGrilla.DataTable.GetValue(13, contador).ToString();
                            string mailcontrol = oGrilla.DataTable.GetValue(7, contador).ToString();
                            //if(!string.IsNullOrEmpty(mailcontrol))
                            //{

                            //}
                            //else
                            //{

                            //}
                            if (valorchk.Equals("Y"))
                            {


                                string mail = oGrilla.DataTable.GetValue(7, contador).ToString();
                                string cardcode = oGrilla.DataTable.GetValue(3, contador).ToString();
                                string cardname = oGrilla.DataTable.GetValue(4, contador).ToString();
                                if (string.IsNullOrEmpty(mail))
                                {
                                    MessageBox.Show("El Socio de negocio: " + cardcode + ", " + cardname + " no posee correo, favor actualizar!!");
                                    return;
                                }
                                string cdc = oGrilla.DataTable.GetValue(6, contador).ToString();
                                string doc = oGrilla.DataTable.GetValue(5, contador).ToString();
                                DateTime v_fecha = DateTime.Parse(oGrilla.DataTable.GetValue(0, contador).ToString());
                                string fecha = v_fecha.ToString("dd/MM/yyyy");
                                string interno = oGrilla.DataTable.GetValue(2, contador).ToString();
                                string textDocu = oGrilla.DataTable.GetValue(1, contador).ToString();
                                //tipo de documento
                                string tabla = null; string tipodocumento = null; string sub = null; ;
                                if (textDocu.Equals("Factura")) { tabla = "OINV"; tipodocumento = "Factura electrónica"; }
                                if (textDocu.Equals("Nota de crédito")) { tabla = "ORIN"; tipodocumento = "Nota de crédito electrónica"; }
                                if (textDocu.Equals("Remisión entrega")) { tabla = "ODLN"; tipodocumento = "Remisión electrónica"; }
                                if (textDocu.Equals("Remisión traslado")) { tabla = "OWTR"; tipodocumento = "Remisión electrónica"; }
                                if (textDocu.Equals("Nota de débito")) { tabla = "OINV"; sub = " AND \"DocSubType\"='DN' "; tipodocumento = "Factura electrónica"; }
                                if (textDocu.Equals("Factura export")) { tabla = "OINV"; sub = " AND \"DocSubType\"='IX' "; tipodocumento = "Factura electrónica"; }
                                if (textDocu.Equals("Autofactura")) { tabla = ""; tipodocumento = "Autofacura electrónica"; }
                                //buscamos los datos del documento
                                SAPbobsCOM.Recordset oDocDatos;
                                oDocDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oDocDatos.DoQuery("SELECT \"DocTotal\",\"DocCur\" FROM " + tabla + " WHERE \"DocNum\"=" + interno + sub + "");
                                string v_total = oDocDatos.Fields.Item(0).Value.ToString();
                                double total_v = double.Parse(v_total);
                                string total = total_v.ToString("N");
                                string moneda = null;
                                if (oDocDatos.Fields.Item(1).Value.ToString() == "GS") { moneda = "PYG"; } else { moneda = "USD"; }
                                //activamos el evento de mandar correo
                                enviarcorreo(mail, cdc, doc, fecha, moneda, total, tipodocumento);
                            }
                            contador++;
                        }
                        btncorreo.Item.Enabled = false;
                        btndesc.Item.Enabled = true;
                        //BarraProgreso.Stop();
                    }
                    //evento para exportar a excel
                    if (pVal.ItemUID == "Item_38" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        ExportarExcel(oForm);
                    }

                    //evento para tildar o destildar todos los check
                    if (pVal.ItemUID == "Item_40" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
                        SAPbouiCOM.CheckBox chktodos = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_40").Specific;
                        bool v_chek = chktodos.Checked;
                        int lineas = grilla.Rows.Count;
                        int contador = 0;
                        //recorremos la grilla
                        if (v_chek == true)
                        {
                            while (lineas > contador)
                            {
                                grilla.DataTable.SetValue(13, contador, "Y");
                                contador++;
                            }
                        }
                        else
                        {
                            while (lineas >= contador)
                            {
                                grilla.DataTable.SetValue(13, contador, "N");
                                contador++;
                            }
                        }

                    }



                }
                #endregion

                //INUTILIZACION
                #region INUTILIZAR
                if (pVal.FormTypeEx == "UDO_FT_INUTILIZAR")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadinutilizacion(oForm);
                    }

                    //evento para mandar uno por uno
                    if (pVal.ItemUID == "Item_24" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //los datos del documento que vamos a inutilizar
                        SAPbouiCOM.EditText ruc = (SAPbouiCOM.EditText)oForm.Items.Item("Item_16").Specific;
                        SAPbouiCOM.EditText timbrado = (SAPbouiCOM.EditText)oForm.Items.Item("Item_17").Specific;
                        SAPbouiCOM.EditText esta = (SAPbouiCOM.EditText)oForm.Items.Item("Item_18").Specific;
                        SAPbouiCOM.EditText pemi = (SAPbouiCOM.EditText)oForm.Items.Item("Item_19").Specific;
                        SAPbouiCOM.ComboBox documento = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_20").Specific;
                        SAPbouiCOM.EditText desde = (SAPbouiCOM.EditText)oForm.Items.Item("Item_21").Specific;
                        SAPbouiCOM.EditText hasta = (SAPbouiCOM.EditText)oForm.Items.Item("Item_22").Specific;
                        SAPbouiCOM.ComboBox motivo = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_23").Specific;

                        //pasamos los valores a string
                        string v_ruc = ruc.Value;
                        string v_timbrado = timbrado.Value;
                        string v_esta = esta.Value;
                        string v_pemi = pemi.Value;
                        string v_documento = documento.Selected.Value.ToString();
                        string v_desde = desde.Value;
                        string v_hasta = hasta.Value;
                        string v_motivo = motivo.Selected.Description.ToString();

                        string v_tabla = null;
                        if (v_documento.Equals("1")) { v_tabla = "OINV"; }
                        if (v_documento.Equals("2")) { v_tabla = "OINV"; }
                        if (v_documento.Equals("5")) { v_tabla = "ORIN"; }
                        if (v_documento.Equals("7")) { v_tabla = "ODLN"; }
                        if (v_documento.Equals("8")) { v_tabla = "OWTR"; }

                        //consultamos si el documento esta rechazado, sino no ejecutar el proceso
                        SAPbobsCOM.Recordset oConsulta;
                        oConsulta = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oConsulta.DoQuery("SELECT \"U_ESTADO\" FROM " + v_tabla + " WHERE \"U_PEMI\"='" + v_pemi + "' AND \"U_ESTA\"='" + v_esta + "' AND \"FolioNum\"='" + v_desde + "' AND \"U_TIMB\"='" + v_timbrado + "' ");
                        string v_estadoDoc = oConsulta.Fields.Item(0).Value.ToString();
                        if (!v_estadoDoc.Equals("RECHAZADO"))
                        {
                            SBO_Application.SetStatusBarMessage("Solo se puede inutilizar un documento RECHAZADO!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                            return;
                        }
                        else
                        {
                            //ejecutamos el servicio
                            inutilizarDoc(v_ruc, v_timbrado, v_esta, v_pemi, v_documento, v_desde, v_hasta, v_motivo);
                        }



                    }
                    //evento para inutilizar de forma masiva
                    if (pVal.ItemUID == "Item_7" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText urlDirctorio = (SAPbouiCOM.EditText)oForm.Items.Item("Item_0").Specific;
                        string url = urlDirctorio.Value;

                        inutilizarMasivo(url);
                        //ejecutamos el servicio para inutilizacion
                    }

                    //evento para abjuntar el excel
                    if (pVal.ItemUID == "Item_3" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText FILE = (SAPbouiCOM.EditText)oForm.Items.Item("Item_0").Specific;

                        //buscamos el archivo EXCEL para la inutilizacion
                        Thread t = new Thread(() =>
                        {
                            OpenFileDialog openFileDialog = new OpenFileDialog();

                            DialogResult dr = openFileDialog.ShowDialog();
                            if (dr == DialogResult.OK)
                            {
                                string fileName = openFileDialog.FileName;
                                FILE.Value = fileName;
                                //SAPbouiCOM.Framework.Application.SBO_Application.MessageBox(fileName);
                            }
                        });          // Kick off a new thread
                        t.IsBackground = true;
                        t.SetApartmentState(ApartmentState.STA);
                        t.Start();


                    }
                    //evento para descargar la plantilla
                    if (pVal.ItemUID == "Item_1" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        descargarPlantilla();
                    }

                }
                #endregion

                //JENGA - Objetivos
                #region OBJETIVOS
                if (pVal.FormTypeEx == "UDO_FT_JOBJETIVOS")
                {
                    //evento de incio
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadObjetivos(oForm);
                    }
                    //evento al presiona el boton de excel
                    if (pVal.ItemUID == "Item_0" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText FILE = (SAPbouiCOM.EditText)oForm.Items.Item("Item_5").Specific;
                        SAPbouiCOM.Button oBTN = (SAPbouiCOM.Button)oForm.Items.Item("Item_0").Specific;
                        //agarramos el texto del boton
                        string v_textoBtn = oBTN.Caption.ToString();

                        if (v_textoBtn.Equals("Subir excel"))
                        {
                            FILE.Item.Visible = false;

                            //buscamos el archivo EXCEL para la inutilizacion
                            Thread t = new Thread(() =>
                            {
                                OpenFileDialog openFileDialog = new OpenFileDialog();

                                DialogResult dr = openFileDialog.ShowDialog();
                                if (dr == DialogResult.OK)
                                {
                                    string fileName = openFileDialog.FileName;
                                    FILE.Value = fileName;
                                    cargarGrillaObj(fileName, oForm);
                                    //SAPbouiCOM.Framework.Application.SBO_Application.MessageBox(fileName);
                                }
                            });          // Kick off a new thread
                            t.IsBackground = true;
                            t.SetApartmentState(ApartmentState.STA);
                            t.Start();
                        }

                        if (v_textoBtn.Equals("Confirmar"))
                        {
                            SAPbouiCOM.EditText oLegajo = (SAPbouiCOM.EditText)oForm.Items.Item("Item_2").Specific;
                            SAPbouiCOM.Matrix oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("0_U_G").Specific;
                            SAPbouiCOM.Grid oGrilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_4").Specific;
                            SAPbouiCOM.Button oBtn = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                            SAPbouiCOM.Button oBtnExcel = (SAPbouiCOM.Button)oForm.Items.Item("Item_0").Specific;
                            SAPbouiCOM.Button oBtnLimpiar = (SAPbouiCOM.Button)oForm.Items.Item("Item_3").Specific;

                            int v_countGrilla = oGrilla.Rows.Count;
                            int v_filaGrilla = 0;
                            int v_filamat = 0;

                            try
                            {
                                while (v_filaGrilla < v_countGrilla)
                                {
                                    string v_linea = oGrilla.DataTable.GetValue(14, v_filaGrilla).ToString();
                                    string v_legajo = oGrilla.DataTable.GetValue(0, v_filaGrilla).ToString();
                                    string v_cliente = oGrilla.DataTable.GetValue(1, v_filaGrilla).ToString();
                                    string v_metrica = oGrilla.DataTable.GetValue(2, v_filaGrilla).ToString();
                                    string v_medida = oGrilla.DataTable.GetValue(3, v_filaGrilla).ToString();
                                    string v_kilos = oGrilla.DataTable.GetValue(4, v_filaGrilla).ToString();
                                    string v_valor = oGrilla.DataTable.GetValue(5, v_filaGrilla).ToString();
                                    string v_periodo = oGrilla.DataTable.GetValue(6, v_filaGrilla).ToString();
                                    string v_fec_inic = oGrilla.DataTable.GetValue(7, v_filaGrilla).ToString();
                                    DateTime fechaInic = DateTime.Parse(v_fec_inic);
                                    string f_fechainicio = fechaInic.ToString("yyyyMMdd");
                                    string v_fec_fin = oGrilla.DataTable.GetValue(8, v_filaGrilla).ToString();
                                    DateTime fechaFin = DateTime.Parse(v_fec_fin);
                                    string v_fechaFin = fechaFin.ToString("yyyyMMdd");
                                    string v_territorio = oGrilla.DataTable.GetValue(9, v_filaGrilla).ToString();
                                    string v_canal = oGrilla.DataTable.GetValue(10, v_filaGrilla).ToString();
                                    string v_subcanal = oGrilla.DataTable.GetValue(11, v_filaGrilla).ToString();
                                    string v_estado = oGrilla.DataTable.GetValue(12, v_filaGrilla).ToString();
                                    string v_tipo = oGrilla.DataTable.GetValue(13, v_filaGrilla).ToString();

                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_1", v_legajo);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_2", v_cliente);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_3", v_metrica);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_4", v_medida);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_5", v_kilos);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_6", v_valor);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_8", f_fechainicio);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_9", v_fechaFin);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_10", v_territorio);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_11", v_canal);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_12", v_subcanal);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_13", v_estado);
                                    oMatrix.SetCellWithoutValidation(int.Parse(v_linea), "C_0_14", v_tipo);
                                    v_filaGrilla++;
                                    v_filamat++;

                                }
                            }
                            catch (Exception ex)
                            {
                                MessageBox.Show("Campo no puede quedar vacío", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                                return;
                            }

                            oLegajo.Item.Click();
                            oBtnLimpiar.Item.Click();
                            oGrilla.Item.Visible = false;
                            oMatrix.Item.Visible = true;
                            oBtn.Item.Enabled = true;
                            oBtnExcel.Caption = "Subir excel";
                        }



                    }

                    //para filtrar por legajo
                    if (pVal.ItemUID == "Item_3" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {

                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Matrix oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("0_U_G").Specific;
                        SAPbouiCOM.Grid oGrilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_4").Specific;
                        SAPbouiCOM.EditText oLegajo = (SAPbouiCOM.EditText)oForm.Items.Item("Item_2").Specific;
                        SAPbouiCOM.Button oBtnBuscarLimpiar = (SAPbouiCOM.Button)oForm.Items.Item("Item_3").Specific;
                        SAPbouiCOM.Button oBoton = (SAPbouiCOM.Button)oForm.Items.Item("Item_0").Specific;
                        string v_BtnTexto = oBtnBuscarLimpiar.Caption.ToString();
                        if (v_BtnTexto.Equals("Buscar"))
                        {
                            string v_legajo = oLegajo.Value;
                            if (string.IsNullOrEmpty(v_legajo))
                            {
                                MessageBox.Show("Introduzca un legajo!!", "", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                                return;
                            }
                            else
                            {
                                SAPbouiCOM.EditText oDocEntry = (SAPbouiCOM.EditText)oForm.Items.Item("0_U_E").Specific;
                                SAPbouiCOM.Button oBtnOK = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                                SAPbouiCOM.Button oBtnBuscar = (SAPbouiCOM.Button)oForm.Items.Item("Item_3").Specific;
                                oBtnBuscar.Caption = "Limpiar";
                                oBtnOK.Item.Enabled = false;
                                oBoton.Caption = "Confirmar";
                                string v_entry = oDocEntry.Value;
                                //realizamos el query
                                //SAPbobsCOM.Recordset oQuery;
                                //oQuery = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                string query = "SELECT \"U_LEGAJO\",\"U_COD_CLIENTE\",\"U_METRICA\",\"U_UND_MEDIDA\",\"U_KILOS\",\"U_VALOR\",\"U_PERIODO\",\"U_FEC_INIC\",\"U_FEC_FIN\",\"U_TERRITORIO\",\"U_CANAL\",\"U_SUBCANAL\",\"U_ESTADO\",\"U_TIPO\",\"LineId\" FROM \"@JOBJETIVOS\" WHERE \"DocEntry\"='" + v_entry + "' AND \"U_LEGAJO\"='" + v_legajo + "' ";
                                int v_DT = oForm.DataSources.DataTables.Count;
                                if (v_DT == 1)
                                {
                                    oForm.DataSources.DataTables.Add("DTgrilla");
                                }
                                oForm.DataSources.DataTables.Item("DTgrilla").ExecuteQuery(query);
                                oGrilla.DataTable = oForm.DataSources.DataTables.Item("DTgrilla");

                                //hacemos visible la grilla para la edicion
                                oMatrix.Item.Visible = false;
                                oGrilla.Item.Visible = true;
                                //cargamos la grilla
                            }
                        }
                        if (v_BtnTexto.Equals("Limpiar"))
                        {
                            //hacemos visible la grilla normal
                            oGrilla.DataTable.Clear();
                            oBtnBuscarLimpiar.Caption = "Buscar";
                            oLegajo.Value = "";
                            oMatrix.Item.Visible = true;
                            oGrilla.Item.Visible = false;
                            oBoton.Caption = "Subir excel";
                        }

                    }
                }
                #endregion

                //JENGA - Comision
                #region COMISION
                if (pVal.FormTypeEx == "UDO_FT_JLIQUIDACIONES")
                {
                    SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);

                    if (pVal.ItemUID == "Item_0" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        //evento para subir las comisiones
                        //buscamos el archivo EXCEL para la inutilizacion
                        Thread t = new Thread(() =>
                        {
                            OpenFileDialog openFileDialog = new OpenFileDialog();

                            DialogResult dr = openFileDialog.ShowDialog();
                            if (dr == DialogResult.OK)
                            {
                                string fileName = openFileDialog.FileName;
                                //FILE.Value = fileName;
                                cargarGrillaComision(fileName, oForm);
                                //SAPbouiCOM.Framework.Application.SBO_Application.MessageBox(fileName);
                            }
                        });          // Kick off a new thread
                        t.IsBackground = true;
                        t.SetApartmentState(ApartmentState.STA);
                        t.Start();
                    }

                    if (pVal.ItemUID == "Item_5" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        EditText periodo = (EditText)oForm.Items.Item("Item_4").Specific;
                        string v_periodo = periodo.Value;
                        //evetno descargar a excel las comisiones
                        DescargarExcelComision(v_periodo);
                    }

                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        inicioComision(oForm);
                    }
                }
                #endregion

                //NUMERACION DE DOCUMENTOS
                #region NUMERACION
                if (pVal.FormTypeEx == "UDO_FT_NUMERACION")
                {
                    //funcion cuando carga el form
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadNumeracion(oForm);
                    }

                    //evento al presionar el boton OK
                    if (pVal.ItemUID == "Item_9" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oSerie = (SAPbouiCOM.EditText)oForm.Items.Item("0_U_E").Specific;
                        SAPbouiCOM.EditText oFolio = (SAPbouiCOM.EditText)oForm.Items.Item("1_U_E").Specific;
                        SAPbouiCOM.EditText oPref = (SAPbouiCOM.EditText)oForm.Items.Item("Item_4").Specific;
                        SAPbouiCOM.EditText oFolioDoc = (SAPbouiCOM.EditText)oForm.Items.Item("Item_8").Specific;
                        SAPbouiCOM.Folder oFolder1 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_1").Specific;
                        SAPbouiCOM.Folder oFolder2 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_2").Specific;
                        SAPbouiCOM.Folder oFolder4 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_19").Specific;
                        SAPbouiCOM.ComboBox otipoDoc = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_5").Specific;
                        SAPbouiCOM.EditText oCDC = (SAPbouiCOM.EditText)oForm.Items.Item("Item_12").Specific;
                        SAPbouiCOM.EditText oInterno = (SAPbouiCOM.EditText)oForm.Items.Item("Item_13").Specific;
                        SAPbouiCOM.EditText oDocuEspecial = (SAPbouiCOM.EditText)oForm.Items.Item("Item_21").Specific;
                        //mandamos a un string los valores
                        string v_folder1 = oFolder1.Selected.ToString();
                        string v_folder2 = oFolder2.Selected.ToString();
                        string v_folder4 = oFolder4.Selected.ToString();
                        string v_docuEspecial = oDocuEspecial.Value;



                        if (v_folder1.Equals("True"))
                        {
                            string v_serie = oSerie.Value.ToString();
                            string v_folio = oFolio.Value.ToString();
                            actualizarSerie(v_serie, v_folio);
                            oSerie.Value = "";
                            oFolio.Value = "";
                        }
                        if (v_folder2.Equals("True"))
                        {
                            string v_prefijo = oPref.Value.ToString();
                            string v_folioDoc = oFolioDoc.Value.ToString();
                            string v_tipoDoc = otipoDoc.Selected.Value.ToString();
                            string v_CDC = oCDC.Value.ToString();
                            string v_interno = oInterno.Value.ToString();
                            foliarDesfoliar(v_prefijo, v_folioDoc, v_CDC, v_tipoDoc, v_interno);
                            oPref.Value = "";
                            oFolioDoc.Value = "";
                            oCDC.Value = "";
                            oInterno.Value = "";
                        }
                        if (v_folder4.Equals("True"))
                        {
                            CrearDocumentoEspecial(v_docuEspecial, "OINV", "INV1", "1", "FACTURA", "Factura electrónica");
                        }

                    }

                    //evento para subir excel
                    if (pVal.ItemUID == "Item_18" && pVal.BeforeAction==false && pVal.EventType==BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oTexto = (SAPbouiCOM.EditText)oForm.Items.Item("Item_16").Specific;
                        string v_texto = oTexto.Value;

                        //buscamos el archivo EXCEL para la inutilizacion
                        Thread t = new Thread(() =>
                        {
                            OpenFileDialog openFileDialog = new OpenFileDialog();

                            DialogResult dr = openFileDialog.ShowDialog();
                            if (dr == DialogResult.OK)
                            {
                                string fileName = openFileDialog.FileName; 
                                oTexto.Value = fileName;                               
                            }
                        });          // Kick off a new thread
                        t.IsBackground = true;
                        t.SetApartmentState(ApartmentState.STA);
                        t.Start();
                    }

                    //procesar facturas
                    if (pVal.ItemUID == "Item_17" && pVal.BeforeAction==false && pVal.EventType==BoEventTypes.et_ITEM_PRESSED)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oTexto = (SAPbouiCOM.EditText)oForm.Items.Item("Item_16").Specific;
                        string v_texto = oTexto.Value;
                        //launch evento de creacion de facturas
                        crearFacturas(v_texto);
                        SBO_Application.StatusBar.SetText("Facturas creadas con éxito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                    }
                }
                #endregion




            }
            catch (Exception ex)
            {

                //SBO_Application.StatusBar.SetText("Error General - " + ex.ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //MessageBox.Show(ex.ToString());
                if (oCompany.InTransaction)
                {
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                }
                //}

            }
        }

        #region EVENTOS DEL MENU
        //eventos del menu
        public static void SBO_Application_MenuEvent(ref SAPbouiCOM.MenuEvent pVal, out bool BubbleEvent)
        {
            BubbleEvent = true;
            try
            {
                if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                //if (compania.Equals("FG_DESA"))
                {

                    //visualizar form de anular
                    if (pVal.BeforeAction && (pVal.MenuUID == "botonSAP.anular"))
                    {
                        if (v_permiso == true)
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "ANULAR", "");
                        }
                        else
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }

                    }
                    //visualizar form de cancelar
                    if (pVal.BeforeAction && (pVal.MenuUID == "botonSAP.cancelar"))
                    {
                        if (v_permiso == true)
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "CANCELAR", "");
                        }
                        else
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }

                    }
                    //viualizar form de auditoria
                    if (pVal.BeforeAction && (pVal.MenuUID == "auditoria"))
                    {
                        if (v_permiso == true)
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "AUDITORIAFE", "");
                        }
                        else
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                    }
                    //viualizar form de inutilizar
                    if (pVal.BeforeAction && (pVal.MenuUID == "inutilizar"))
                    {
                        if (v_permiso == true)
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "INUTILIZAR", "");
                        }
                        else
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                    }

                    //visualizar form de numeracion
                    if (pVal.BeforeAction && (pVal.MenuUID == "numeracion"))
                    {
                        if (v_permiso == true)
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "NUMERACION", "");

                        }
                        else
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                    }
                    //visualizar form de objetivos
                    if (pVal.BeforeAction && (pVal.MenuUID == "botonSAP.Obejtivo"))
                    {
                        if (v_Jenga == false)
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                        else
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "JOBJETIVOS", "");
                        }
                        
                    }
                    //visualizar el form de comision
                    if (pVal.BeforeAction && (pVal.MenuUID == "botonSAP.Comision"))
                    {
                        if (v_Jenga == false)
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                        else
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "JLIQUIDACIONES", "");
                        }
                        
                    }
                    //visualizar el form de metrica
                    if (pVal.BeforeAction && (pVal.MenuUID == "Metrica"))
                    {
                        if (v_Jenga == false)
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                        else
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "jMETRICA", "");
                        }
                       
                    }
                    if (pVal.BeforeAction && (pVal.MenuUID == "Llave"))
                    {
                        if (v_Jenga == false)
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                        else
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "jLLAVES", "");
                        }
                        
                    }
                    if (pVal.BeforeAction && (pVal.MenuUID == "Equivalencia"))
                    {
                        if (v_Jenga == false)
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                        else
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "jEQUIVALENCIAS", "");
                        }
                        
                    }
                    if (pVal.BeforeAction && (pVal.MenuUID == "escala"))
                    {
                        if (v_Jenga == false)
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                        else
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "jESCALAS", "");
                        }
                        
                    }

                    if (pVal.BeforeAction && (pVal.MenuUID == "EquivalenciaSap"))
                    {
                        if (v_permiso == false)
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                        else
                        {                          
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "EQUIVALENCIA_FE", "");
                        }
                    }
                    if (pVal.BeforeAction && (pVal.MenuUID == "Configuracion"))
                    {
                        if (v_permiso == true)
                        {
                            SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "APP_CONFIG", "");
                        }
                        else
                        {
                            MessageBox.Show("No posee autorización!!, favor consultar con el administrador.", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }

                    }

                    //controlar si no esta abierto doble pantalla
                    if (pVal.MenuUID == "2053")
                    {
                        //agarramos el usuario logeado
                        string v_usu = oCompany.UserName.ToString();
                        //buscamos si tiene restrinccion
                        SAPbobsCOM.Recordset oUsuario;
                        oUsuario = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oUsuario.DoQuery("SELECT COUNT(*) FROM \"@APP_CONFIG\" WHERE \"Name\"='VENTANA UNICA' AND \"U_Empresa\"='FG' AND \"U_Valor\"='" + v_usu + "' ");
                        int v_resultado = int.Parse(oUsuario.Fields.Item(0).Value.ToString());
                        if (v_resultado > 0)
                        {
                            SBO_Application.Forms.GetForm("133", 2).Close();
                            MessageBox.Show("No se puede abrir 2 formularios de Factura Deudores!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                        }
                    }
                }
                else
                {
                    //visualizar form de anular
                    if (pVal.BeforeAction && (pVal.MenuUID == "botonSAP.anular"))
                    {
                        SBO_Application.ActivateMenuItem("47630");//47660 FG_DESA
                        SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                    }
                    //visualizar form de cancelar
                    if (pVal.BeforeAction && (pVal.MenuUID == "botonSAP.cancelar"))
                    {
                        SBO_Application.ActivateMenuItem("47629");//47660 FG_DESA
                        SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;

                    }
                    //viualizar form de auditoria
                    if (pVal.BeforeAction && (pVal.MenuUID == "auditoria"))
                    {
                        SBO_Application.ActivateMenuItem("47631");
                        SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                    }
                }

            }
            catch (Exception ex)
            {

            }
        }
        #endregion

        #region FUNCIONES
        //funcion para consultar al web servce de Efirma
        private static void CrearDocumento(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc)
        {
            try
            {
                //BasicHttpBinding httpBinding = new BasicHttpBinding();
                //httpBinding.MaxReceivedMessageSize = Int32.MaxValue;
                //httpBinding.MaxBufferSize = Int32.MaxValue;

                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              

                #region QUERY DOCUMENTO
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }
                    else
                    {
                        //GRANUSA
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)   " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T12.\"U_Nombre\"||','||T12.\"U_Apellido\",CASE WHEN T11.\"U_CHAPA_CARRE\" IS NULL THEN  T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END ,T11.\"U_MARCA\",T12.\"U_Documento\",T12.\"U_Direccion\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN \"@CHOFERES\" T12 ON T12.\"Code\"=T0.\"U_CHOFERES\" " +
                                       //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }
                    else
                    {
                        //GRANUSA
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T12.\"U_Nombre\"||','||T12.\"U_Apellido\",CASE WHEN T11.\"U_CHAPA_CARRE\" IS NULL THEN  T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T12.\"U_Documento\",T12.\"U_Direccion\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN \"@CHOFERES\" T12 ON T12.\"Code\"=T0.\"U_CHOFERES\" " +
                                       //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }
                }
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string CodLicitacion = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string infoadicional = oDatos.Fields.Item(53).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //actualizamos el folio de la factura
                Recordset oActUDF;
                oActUDF = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActUDF.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                string oper = oDatos.Fields.Item(25).Value.ToString();
                if (!string.IsNullOrEmpty(infoadicional))
                {
                    gOpeDE.dInfoEmi = infoadicional;
                }
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                if (tablacab.Equals("OINV"))
                {
                    gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                    gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                }              
               
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                if (oDatos.Fields.Item(26).Value.ToString() == "2")
                {
                    gDatRec.iTiOpe = "2";
                    //gDatRec.iTiContRec = "1";
                }
                else
                {
                    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //validad si el pais esta vacio, enviar PRY por defecto
                string pais = oDatos.Fields.Item(16).Value.ToString();
                if (string.IsNullOrEmpty(pais))
                {
                    gDatRec.cPaisRec = "PRY";
                }
                else
                {
                    gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                }

                //gDatRec.dDesPaisRe = "Paraguay";

                if (tablacab.Equals("ORIN"))
                {
                    gCamNCDE.iMotEmi = "1";//hay que modificar
                }
                //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1" || oDatos.Fields.Item(26).Value.ToString() == "3")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }

                if (tablacab.Equals("OINV"))
                {
                    //REMITO
                    #region REMITO
                    if (!string.IsNullOrEmpty(trans))
                    {
                        string chof = oDatos.Fields.Item(32).Value.ToString();
                        if (!chof.Equals("PERSONAL"))
                        {
                            string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                            if (!string.IsNullOrEmpty(CedChofer))
                            {
                                string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                                string NewDirRec = null;
                                if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    NewDirRec = dirReceptor;

                                }
                                string salDire = oDatos.Fields.Item(37).Value.ToString();
                                string newsalDire = null;
                                if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newsalDire = salDire;

                                }
                                string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                                string newDomFiscal = null;
                                if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDomFiscal = DomFiscal;

                                }
                                string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                                string newDireChofer = null;
                                if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDireChofer = DireChofer;

                                }
                                string codTransp = null;
                                string descTrans = null;
                                if (oDatos.Fields.Item(38).Value.ToString() == varE)
                                {
                                    codTransp = "1";
                                    descTrans = "Propio";
                                }
                                else
                                {
                                    codTransp = "2";
                                    descTrans = "Tercero";
                                }
                                gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gDatRec.dNumCasRec = "0";
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                                //gCamSal               
                                gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                                gCamSal.dNumCasSal = "0";
                                //gCamSal.dComp1Sal =  "aviadores del chaco";
                                gCamSal.cDepSal = sal_dep;
                                gCamSal.cCiuSal = sal_loc;
                                gCamSal.cDisSal = sal_dist;
                                //gCamEnt
                                gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gCamEnt.dNumCasEnt = "0";
                                gCamEnt.cDepEnt = rec_dep;
                                gCamEnt.cCiuEnt = rec_loc;
                                gCamEnt.cDisEnt = rec_dist;
                                gCamEnt1[0] = gCamEnt;
                                gTransp.iTipTrans = codTransp;// "2";
                                gTransp.dDesTipTrans = descTrans;// "Tercero";
                                gTransp.iModTrans = "1";
                                gTransp.iRespFlete = RespFlete;
                                gTransp.dIniTras = fe;
                                gTransp.dIniTrasSpecified = true;
                                gTransp.dFinTras = fe;
                                gTransp.dFinTrasSpecified = true;
                                //gVehTras
                                //gTransp.gVehTras = gVehTras1;
                                gVehTras1[0] = gVehTras;
                                gVehTras.dTiVehTras = "Terrestre";
                                gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                                gVehTras.dTipIdenVeh = "2";
                                gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                                //gCamTrans
                                gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                                gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                                //deconstruimos el RUC del transportista
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                string rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                string dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                                gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                                gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                                gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                                gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                                gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                                gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                                   //gCamNRE
                                                                   //gCamNRE.iMotEmiNR = "1";
                                                                   //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                                   //gCamNRE.iRespEmiNR = "1";
                                                                   //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                                gCamNRE.dKmR = "3";
                                //gDtipDE.gCamNRE = gCamNRE;
                                gTransp.gCamTrans = gCamTrans;
                                gTransp.gCamSal = gCamSal;
                                gTransp.gCamEnt = gCamEnt1;
                                gTransp.gVehTras = gVehTras1;
                                gDtipDE.gTransp = gTransp;
                            }

                        }


                    }
                    #endregion
                }

                //LICITACION
                #region LICITACION
                if (oDatos.Fields.Item(25).Value.ToString() == "3")
                {
                    Recordset oLicitacion;
                    oLicitacion = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oLicitacion.DoQuery("SELECT \"U_dModCont\",\"U_dEntCont\",\"U_dAnoCont\",\"U_dSecCont\",\"U_dFeCodCont\" FROM \"@LICITACION\" WHERE \"U_LICI\"='" + CodLicitacion + "'");

                    gCompPub.dModCont = oLicitacion.Fields.Item(0).Value.ToString();//"LP";
                    gCompPub.dEntCont = oLicitacion.Fields.Item(1).Value.ToString(); //"12009";
                    gCompPub.dAnoCont = oLicitacion.Fields.Item(2).Value.ToString(); //"22";
                    int sec = int.Parse(oLicitacion.Fields.Item(3).Value.ToString());
                    gCompPub.dSecCont = sec.ToString("D7");// oLicitacion.Fields.Item(3).Value.ToString(); //"218529";
                    DateTime v_fechaLic = DateTime.Parse(oLicitacion.Fields.Item(4).Value.ToString());
                    string fechalic_v = v_fechaLic.ToString("yyyy-MM-dd");
                    gCompPub.dFeCodCont = DateTime.Parse(fechalic_v);//DateTime.Parse("2022-08-31");
                    gCompPub.dFeCodContSpecified = true;
                    gCamFE.gCompPub = gCompPub;
                    //gDtipDE.gCamFE = gCamFE;
                }
                #endregion



                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //convertimos a INT la cantidad de decimales
                int v_CanDecimal = int.Parse(v_DecimalFG);
                while (!oDatos.EoF)
                {
                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        string pp = oDatos.Fields.Item(14).Value.ToString();
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        //gValorRestaItem.dDescItem = decimal.Parse("24000000"); ;
                        //gValorRestaItem.dDescItemSpecified = true;
                        //string deci = "1,2";
                        //gValorRestaItem.dPorcDesIt = decimal.Parse(deci);
                        //gValorRestaItem.dPorcDesItSpecified = true;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    //gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    //gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem2.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem2.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem2.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    //gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    //gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                    gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem3.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem3.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem3.dTotBruOpeItem = Math.Ceiling(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        //gValorRestaItem
                        gValorRestaItem3.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem4.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem4.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem4.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem5.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem5.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem5.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA5.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA5.iAfecIVA = "3";
                            gCamIVA5.dBasGravIVA = 0;
                            gCamIVA5.dLiqIVAItem = 0;
                        }
                        gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem5.gValorRestaItem = gValorRestaItem5;
                        gCamItem5.gValorItem = gValorItem5;
                        gCamItem5.gCamIVA = gCamIVA5;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem6.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem6.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem6.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA6.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA6.iAfecIVA = "3";
                            gCamIVA6.dBasGravIVA = 0;
                            gCamIVA6.dLiqIVAItem = 0;
                        }
                        gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem6.gValorRestaItem = gValorRestaItem6;
                        gCamItem6.gValorItem = gValorItem6;
                        gCamItem6.gCamIVA = gCamIVA6;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem7.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem7.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem7.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA7.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA7.iAfecIVA = "3";
                            gCamIVA7.dBasGravIVA = 0;
                            gCamIVA7.dLiqIVAItem = 0;
                        }
                        gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem7.gValorRestaItem = gValorRestaItem7;
                        gCamItem7.gValorItem = gValorItem7;
                        gCamItem7.gCamIVA = gCamIVA7;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem8.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem8.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem8.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA8.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA8.iAfecIVA = "3";
                            gCamIVA8.dBasGravIVA = 0;
                            gCamIVA8.dLiqIVAItem = 0;
                        }
                        gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem8.gValorRestaItem = gValorRestaItem8;
                        gCamItem8.gValorItem = gValorItem8;
                        gCamItem8.gCamIVA = gCamIVA8;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem9.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem9.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem9.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA9.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA9.iAfecIVA = "3";
                            gCamIVA9.dBasGravIVA = 0;
                            gCamIVA9.dLiqIVAItem = 0;
                        }
                        gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem9.gValorRestaItem = gValorRestaItem9;
                        gCamItem9.gValorItem = gValorItem9;
                        gCamItem9.gCamIVA = gCamIVA9;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem10.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem10.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem10.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA10.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA10.iAfecIVA = "3";
                            gCamIVA10.dBasGravIVA = 0;
                            gCamIVA10.dLiqIVAItem = 0;
                        }
                        gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem10.gValorRestaItem = gValorRestaItem10;
                        gCamItem10.gValorItem = gValorItem10;
                        gCamItem10.gCamIVA = gCamIVA10;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem11.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem11.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem11.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA11.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA11.iAfecIVA = "3";
                            gCamIVA11.dBasGravIVA = 0;
                            gCamIVA11.dLiqIVAItem = 0;
                        }
                        gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem11.gValorRestaItem = gValorRestaItem11;
                        gCamItem11.gValorItem = gValorItem11;
                        gCamItem11.gCamIVA = gCamIVA11;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem12.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem12.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem12.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA12.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA12.iAfecIVA = "3";
                            gCamIVA12.dBasGravIVA = 0;
                            gCamIVA12.dLiqIVAItem = 0;
                        }
                        gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem12.gValorRestaItem = gValorRestaItem12;
                        gCamItem12.gValorItem = gValorItem12;
                        gCamItem12.gCamIVA = gCamIVA12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem13.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem13.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem13.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA13.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA13.iAfecIVA = "3";
                            gCamIVA13.dBasGravIVA = 0;
                            gCamIVA13.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem13.gValorRestaItem = gValorRestaItem13;
                        gCamItem13.gValorItem = gValorItem13;
                        gCamItem13.gCamIVA = gCamIVA13;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem14.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem14.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem14.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA14.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA14.iAfecIVA = "3";
                            gCamIVA14.dBasGravIVA = 0;
                            gCamIVA14.dLiqIVAItem = 0;
                        }
                        gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem14.gValorRestaItem = gValorRestaItem14;
                        gCamItem14.gValorItem = gValorItem14;
                        gCamItem14.gCamIVA = gCamIVA14;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem15.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem15.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem15.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA15.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA15.iAfecIVA = "3";
                            gCamIVA15.dBasGravIVA = 0;
                            gCamIVA15.dLiqIVAItem = 0;
                        }
                        gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem15.gValorRestaItem = gValorRestaItem15;
                        gCamItem15.gValorItem = gValorItem15;
                        gCamItem15.gCamIVA = gCamIVA15;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem16.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem16.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem16.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA16.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA16.iAfecIVA = "3";
                            gCamIVA16.dBasGravIVA = 0;
                            gCamIVA16.dLiqIVAItem = 0;

                        }
                        gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem16.gValorRestaItem = gValorRestaItem16;
                        gCamItem16.gValorItem = gValorItem16;
                        gCamItem16.gCamIVA = gCamIVA16;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem17.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem17.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem17.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA17.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA17.iAfecIVA = "3";
                            gCamIVA17.dBasGravIVA = 0;
                            gCamIVA17.dLiqIVAItem = 0;
                        }
                        gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem17.gValorRestaItem = gValorRestaItem17;
                        gCamItem17.gValorItem = gValorItem17;
                        gCamItem17.gCamIVA = gCamIVA17;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem18.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem18.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem18.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA18.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA18.iAfecIVA = "3";
                            gCamIVA18.dBasGravIVA = 0;
                            gCamIVA18.dLiqIVAItem = 0;
                        }
                        gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem18.gValorRestaItem = gValorRestaItem18;
                        gCamItem18.gValorItem = gValorItem18;
                        gCamItem18.gCamIVA = gCamIVA18;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem19.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem19.dDncpG = dncpNum.ToString("D8");
                        }
                        //gValorItem
                        gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem19.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA19.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA19.iAfecIVA = "3";
                            gCamIVA19.dBasGravIVA = 0;
                            gCamIVA19.dLiqIVAItem = 0;
                        }
                        gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem19.gValorRestaItem = gValorRestaItem19;
                        gCamItem19.gValorItem = gValorItem19;
                        gCamItem19.gCamIVA = gCamIVA19;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem20.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem20.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem20.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA20.iAfecIVA = "3";
                            gCamIVA20.dBasGravIVA = 0;
                            gCamIVA20.dLiqIVAItem = 0;
                        }
                        gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem20.gValorRestaItem = gValorRestaItem20;
                        gCamItem20.gValorItem = gValorItem20;
                        gCamItem20.gCamIVA = gCamIVA20;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem21.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA21.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA21.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA21.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA21.iAfecIVA = "3";
                            gCamIVA21.dBasGravIVA = 0;
                            gCamIVA21.dLiqIVAItem = 0;
                        }
                        gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem21.gValorRestaItem = gValorRestaItem21;
                        gCamItem21.gValorItem = gValorItem21;
                        gCamItem21.gCamIVA = gCamIVA21;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem22.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA22.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA22.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA22.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA22.iAfecIVA = "3";
                            gCamIVA22.dBasGravIVA = 0;
                            gCamIVA22.dLiqIVAItem = 0;
                        }
                        gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem22.gValorRestaItem = gValorRestaItem22;
                        gCamItem22.gValorItem = gValorItem22;
                        gCamItem22.gCamIVA = gCamIVA22;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem23.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA23.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA23.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA23.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA23.iAfecIVA = "3";
                            gCamIVA23.dBasGravIVA = 0;
                            gCamIVA23.dLiqIVAItem = 0;
                        }
                        gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem23.gValorRestaItem = gValorRestaItem23;
                        gCamItem23.gValorItem = gValorItem23;
                        gCamItem23.gCamIVA = gCamIVA23;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem24.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA24.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA24.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA24.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA24.iAfecIVA = "3";
                            gCamIVA24.dBasGravIVA = 0;
                            gCamIVA24.dLiqIVAItem = 0;
                        }
                        gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem24.gValorRestaItem = gValorRestaItem24;
                        gCamItem24.gValorItem = gValorItem24;
                        gCamItem24.gCamIVA = gCamIVA24;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem25.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA25.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA25.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA25.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA25.iAfecIVA = "3";
                            gCamIVA25.dBasGravIVA = 0;
                            gCamIVA25.dLiqIVAItem = 0;
                        }
                        gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem25.gValorRestaItem = gValorRestaItem25;
                        gCamItem25.gValorItem = gValorItem25;
                        gCamItem25.gCamIVA = gCamIVA25;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem26.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA26.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA26.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA26.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA26.iAfecIVA = "3";
                            gCamIVA26.dBasGravIVA = 0;
                            gCamIVA26.dLiqIVAItem = 0;
                        }
                        gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem26.gValorRestaItem = gValorRestaItem26;
                        gCamItem26.gValorItem = gValorItem26;
                        gCamItem26.gCamIVA = gCamIVA26;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem27.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA27.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA27.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA27.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA27.iAfecIVA = "3";
                            gCamIVA27.dBasGravIVA = 0;
                            gCamIVA27.dLiqIVAItem = 0;
                        }
                        gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem27.gValorRestaItem = gValorRestaItem27;
                        gCamItem27.gValorItem = gValorItem27;
                        gCamItem27.gCamIVA = gCamIVA27;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem28.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA28.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA28.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA28.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA28.iAfecIVA = "3";
                            gCamIVA28.dBasGravIVA = 0;
                            gCamIVA28.dLiqIVAItem = 0;
                        }
                        gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem28.gValorRestaItem = gValorRestaItem28;
                        gCamItem28.gValorItem = gValorItem28;
                        gCamItem28.gCamIVA = gCamIVA28;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem29.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA29.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA29.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA29.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA29.iAfecIVA = "3";
                            gCamIVA29.dBasGravIVA = 0;
                            gCamIVA29.dLiqIVAItem = 0;
                        }
                        gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem29.gValorRestaItem = gValorRestaItem29;
                        gCamItem29.gValorItem = gValorItem29;
                        gCamItem29.gCamIVA = gCamIVA29;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem30.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA30.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA30.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA30.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA30.iAfecIVA = "3";
                            gCamIVA30.dBasGravIVA = 0;
                            gCamIVA30.dLiqIVAItem = 0;
                        }
                        gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem30.gValorRestaItem = gValorRestaItem30;
                        gCamItem30.gValorItem = gValorItem30;
                        gCamItem30.gCamIVA = gCamIVA30;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem31.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA31.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA31.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA31.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA31.iAfecIVA = "3";
                            gCamIVA31.dBasGravIVA = 0;
                            gCamIVA31.dLiqIVAItem = 0;
                        }
                        gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem31.gValorRestaItem = gValorRestaItem31;
                        gCamItem31.gValorItem = gValorItem31;
                        gCamItem31.gCamIVA = gCamIVA31;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem32.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA32.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA32.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA32.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA32.iAfecIVA = "3";
                            gCamIVA32.dBasGravIVA = 0;
                            gCamIVA32.dLiqIVAItem = 0;
                        }
                        gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem32.gValorRestaItem = gValorRestaItem32;
                        gCamItem32.gValorItem = gValorItem32;
                        gCamItem32.gCamIVA = gCamIVA32;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem33.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA33.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA33.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA33.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA33.iAfecIVA = "3";
                            gCamIVA33.dBasGravIVA = 0;
                            gCamIVA33.dLiqIVAItem = 0;
                        }
                        gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem33.gValorRestaItem = gValorRestaItem33;
                        gCamItem33.gValorItem = gValorItem33;
                        gCamItem33.gCamIVA = gCamIVA33;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem34.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA34.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA34.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA34.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA34.iAfecIVA = "3";
                            gCamIVA34.dBasGravIVA = 0;
                            gCamIVA34.dLiqIVAItem = 0;
                        }
                        gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem34.gValorRestaItem = gValorRestaItem34;
                        gCamItem34.gValorItem = gValorItem34;
                        gCamItem34.gCamIVA = gCamIVA34;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem35.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA35.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA35.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA35.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA35.iAfecIVA = "3";
                            gCamIVA35.dBasGravIVA = 0;
                            gCamIVA35.dLiqIVAItem = 0;
                        }
                        gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem35.gValorRestaItem = gValorRestaItem35;
                        gCamItem35.gValorItem = gValorItem35;
                        gCamItem35.gCamIVA = gCamIVA35;
                        gCamItem1[f] = gCamItem35;
                    }
                    if (f == 35)
                    {
                        gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem36.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA36.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA36.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA36.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA36.iAfecIVA = "3";
                            gCamIVA36.dBasGravIVA = 0;
                            gCamIVA36.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem36.gValorRestaItem = gValorRestaItem36;
                        gCamItem36.gValorItem = gValorItem36;
                        gCamItem36.gCamIVA = gCamIVA36;
                        gCamItem1[f] = gCamItem36;
                    }
                    if (f == 36)
                    {
                        gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem37.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA37.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA37.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA37.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA37.iAfecIVA = "3";
                            gCamIVA37.dBasGravIVA = 0;
                            gCamIVA37.dLiqIVAItem = 0;
                        }
                        gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem37.gValorRestaItem = gValorRestaItem37;
                        gCamItem37.gValorItem = gValorItem37;
                        gCamItem37.gCamIVA = gCamIVA37;
                        gCamItem1[f] = gCamItem37;
                    }
                    if (f == 37)
                    {
                        gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem38.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA38.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA38.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA38.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA38.iAfecIVA = "3";
                            gCamIVA38.dBasGravIVA = 0;
                            gCamIVA38.dLiqIVAItem = 0;
                        }
                        gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem38.gValorRestaItem = gValorRestaItem38;
                        gCamItem38.gValorItem = gValorItem38;
                        gCamItem38.gCamIVA = gCamIVA38;
                        gCamItem1[f] = gCamItem38;
                    }
                    if (f == 38)
                    {
                        gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem39.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA39.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA39.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA39.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA39.iAfecIVA = "3";
                            gCamIVA39.dBasGravIVA = 0;
                            gCamIVA39.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem39.gValorRestaItem = gValorRestaItem39;
                        gCamItem39.gValorItem = gValorItem39;
                        gCamItem39.gCamIVA = gCamIVA39;
                        gCamItem1[f] = gCamItem39;
                    }
                    if (f == 39)
                    {
                        gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem40.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA40.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA40.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA40.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA40.iAfecIVA = "3";
                            gCamIVA40.dBasGravIVA = 0;
                            gCamIVA40.dLiqIVAItem = 0;
                        }
                        gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem40.gValorRestaItem = gValorRestaItem40;
                        gCamItem40.gValorItem = gValorItem40;
                        gCamItem40.gCamIVA = gCamIVA40;
                        gCamItem1[f] = gCamItem40;
                    }
                    if (f == 40)
                    {
                        gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem41.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA41.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA41.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA41.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA41.iAfecIVA = "3";
                            gCamIVA41.dBasGravIVA = 0;
                            gCamIVA41.dLiqIVAItem = 0;
                        }
                        gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem41.gValorRestaItem = gValorRestaItem41;
                        gCamItem41.gValorItem = gValorItem41;
                        gCamItem41.gCamIVA = gCamIVA41;
                        gCamItem1[f] = gCamItem41;
                    }
                    if (f == 41)
                    {
                        gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem42.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA42.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA42.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA42.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA42.iAfecIVA = "3";
                            gCamIVA42.dBasGravIVA = 0;
                            gCamIVA42.dLiqIVAItem = 0;
                        }
                        gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem42.gValorRestaItem = gValorRestaItem42;
                        gCamItem42.gValorItem = gValorItem42;
                        gCamItem42.gCamIVA = gCamIVA42;
                        gCamItem1[f] = gCamItem42;
                    }
                    if (f == 42)
                    {
                        gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem43.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA43.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA43.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA43.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA43.iAfecIVA = "3";
                            gCamIVA43.dBasGravIVA = 0;
                            gCamIVA43.dLiqIVAItem = 0;
                        }
                        gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem43.gValorRestaItem = gValorRestaItem43;
                        gCamItem43.gValorItem = gValorItem43;
                        gCamItem43.gCamIVA = gCamIVA43;
                        gCamItem1[f] = gCamItem43;
                    }
                    if (f == 43)
                    {
                        gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem44.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA44.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA44.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA44.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA44.iAfecIVA = "3";
                            gCamIVA44.dBasGravIVA = 0;
                            gCamIVA44.dLiqIVAItem = 0;
                        }
                        gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem44.gValorRestaItem = gValorRestaItem44;
                        gCamItem44.gValorItem = gValorItem44;
                        gCamItem44.gCamIVA = gCamIVA44;
                        gCamItem1[f] = gCamItem44;
                    }
                    if (f == 44)
                    {
                        gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem45.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA45.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA45.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA45.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA45.iAfecIVA = "3";
                            gCamIVA45.dBasGravIVA = 0;
                            gCamIVA45.dLiqIVAItem = 0;
                        }
                        gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem45.gValorRestaItem = gValorRestaItem45;
                        gCamItem45.gValorItem = gValorItem45;
                        gCamItem45.gCamIVA = gCamIVA45;
                        gCamItem1[f] = gCamItem45;
                    }
                    #endregion


                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                if (string.IsNullOrEmpty(trans))
                {
                    parametros.templateKuDE = "FACTURA_SIMPLE";
                }
                else
                {
                    parametros.templateKuDE = template;
                }
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }

                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }
                if (tablacab.Equals("ORIN") && electronico.Equals("Si"))
                {

                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T2.\"U_CDC\" FROM ORIN T0 INNER JOIN RIN1 T1 ON T0.\"DocEntry\"=t1.\"DocEntry\" INNER JOIN OINV T2 ON T1.\"BaseEntry\"=t2.\"DocEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (tablacab.Equals("ORIN") && electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    // DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }



                gCamCond.gPaConEIni = gPaConEIni1;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                //gValorItem.gValorRestaItem = gValorRestaItem;
                //gCamItem.gValorItem = gValorItem;
                //gCamItem.gCamIVA = gCamIVA;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");

                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
            }
            catch (Exception e)
            {
                if (e.ToString().Contains("System.ServiceModel.EndpointNotFoundException"))
                {
                    MessageBox.Show("Problema de conexión, favor consultar con el administrador!!","Atención",MessageBoxButtons.OK,MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("System.indexOutOfRangeException"))
                {
                    MessageBox.Show("Dirección duplicada o ruc inválido, favor revisar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("java.lang.NumberFormatException"))
                {
                    MessageBox.Show("Verificar campos obligatorios, formato incorrecto o vacío!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("org.hibernate.engine.jdbc"))
                {
                    MessageBox.Show("Error en la base de datos, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                else
                {
                    MessageBox.Show(e.ToString());
                }

                //oCompany.EndTransaction(BoWfTransOpt.wf_Commit);
            }

        }

        //funcion para anular documento
        private static void AnularDocumento(string esta, string pemi, string fol, string moti, string tabla, string SubType)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instnciamos las variables
            servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
            servicio.anularRequest anular = new servicio.anularRequest();
            servicio.anularResponse response = new servicio.anularResponse();

            //realizamos el query para traer el CDC correspondiente
            string tim = null;
            if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                tim = "16094946";
            }
            else
            {
                tim = "16148774";
            }
            string type = null;
            if (!string.IsNullOrEmpty(SubType))
            {
                type = " \"DocSubType\"='IX' ";
            }
            SAPbobsCOM.Recordset query;
            query = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            query.DoQuery//("SELECT \"U_CDC\",\"DocEntry\" FROM " + tabla + " WHERE \"U_ESTA\"='" + esta + "' and \"U_PEMI\"='" + pemi + "' and \"FolioNum\"='" + fol + "' and \"U_TIMB\"='" + tim + "' "+ type);
            ("SELECT \"U_CDC\",\"DocEntry\" FROM " + tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"FolioNum\"='" + fol + "' AND \"U_TIMB\"='" + tim + "' " + SubType);
            //consultamos si existe el numero de documento
            if (query.EoF)
            {
                //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("No existe el Documento!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                SBO_Application.StatusBar.SetText("No existe el documento!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                return;
            }
            //enviamos las variables al servicio
            anular.cdc = query.Fields.Item(0).Value.ToString();
            anular.motivo = moti;
            //ejecutamos el servicio
            response = cliente.anular(anular);
            bool resp = response.ok;

            if (resp == true)
            {
                int nrodocu = int.Parse(query.Fields.Item(1).Value.ToString());
                if (tabla.Equals("OINV") && string.IsNullOrEmpty(type))
                {
                    anularFactura(nrodocu);
                }
                else if (tabla.Equals("ORIN"))
                {
                    anularNC(nrodocu);
                }
                else if (tabla.Equals("ODLN"))
                {
                    anularEntrega(nrodocu);
                }
                else if (tabla.Equals("OWTR"))
                {
                    anularTraslado(nrodocu);
                }
                if (tabla.Equals("OINV") && !string.IsNullOrEmpty(type))
                {
                    anularFacturaExport(nrodocu);
                }


            }
            else
            {
                SBO_Application.StatusBar.SetText("Documento ya se encuentra anulado!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //SBO_Application.SetStatusBarMessage("Documento ya se encuentra anulado", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                return;
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para remision
        private static void NotaRemision(string codigo, string tablacab, string tabladet)
        {
            try
            {
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();

                Recordset oDireTras;
                oDireTras = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                string direTras = null;
                if (tablacab.Equals("OWTR"))
                {
                    oDireTras.DoQuery("SELECT T2.\"Address\" FROM OWTR T0 LEFT JOIN OCRD T1 ON T1.\"CardCode\"=T0.\"CardCode\" " +
                                      "LEFT JOIN CRD1 T2 ON T2.\"CardCode\"=T1.\"CardCode\" AND T2.\"AdresType\"='B' WHERE T0.\"DocNum\"='" + codigo + "'");
                    direTras = oDireTras.Fields.Item(0).Value.ToString();
                    if (string.IsNullOrEmpty(direTras))
                    {
                        SBO_Application.StatusBar.SetText("Cargar direccion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                }
                //proceso para mandar documento
                //consultamos los datos del documento              
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);

                #region QUERY REMISION
                if (tablacab.Equals("OWTR"))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {
                        if (!string.IsNullOrEmpty(direTras))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                       "T0.\"U_Vehiculo\",T11.\"U_Marca\",T0.\"U_Trans\", " +
                                       "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"Pager\",T15.\"Name\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                       "T13.\"Street\",T15.\"Address\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_Info_Export\" " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                       "LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_Trans\" and T15.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {

                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                       "T0.\"U_Vehiculo\",T11.\"U_Marca\",T0.\"U_Trans\", " +
                                       "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"Pager\",T15.\"Name\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                       "T13.\"Street\",T15.\"Address\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_Info_Export\" " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='S' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                       "LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_Trans\" and T15.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }

                    }
                    //GRANUSA
                    else
                    {
                        if (!string.IsNullOrEmpty(direTras))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                  "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                  "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                  "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                  "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                  "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                  "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                  "T13.\"Street\",T15.\"U_Direccion\", " +
                                  "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                  "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_Info_Export\" " +
                                  "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                  "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                  "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                  "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                  "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                  "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                  "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                  "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                  "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                  "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                  //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                  "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                  "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                  "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                  "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                  "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                  "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                  "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                  "T13.\"Street\",T15.\"U_Direccion\", " +
                                  "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                  "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_Info_Export\" " +
                                  "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                  "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='S' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                  "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                  "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                  "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                  "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                  "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                  "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                  "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                  "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                  //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                  "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }

                    }
                }
                else
                {
                    //consultamos la direccion que se eligio
                    if (!string.IsNullOrEmpty(direShip))
                    {
                        if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                           "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                           "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                           "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                           "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                           "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                           "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                           "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                           "T0.\"U_Vehiculo\",T11.\"U_Marca\",T0.\"U_Trans\", " +
                                           "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"Pager\",T15.\"Name\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                           "T13.\"Street\",T15.\"Address\", " +
                                           "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                           "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_Info_Export\" " +
                                           "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                           "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                           "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                           "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                           "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                           "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                           "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                           "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_Trans\" " +
                                           "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                           "LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_Trans\" and T15.\"Name\"=T0.\"U_Chofer\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                           "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {
                            //GRANUSA
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                      "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                      "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                      "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                      "T13.\"Street\",T15.\"U_Direccion\", " +
                                      "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                      "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_Info_Export\" " +
                                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                      "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                      "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                      "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                      "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                      //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                      "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                    }
                    else
                    {
                        if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                           "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                           "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                           "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                           "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                           "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                           "T0.\"U_Vehiculo\",T11.\"U_Marca\",T0.\"U_Trans\", " +
                                           "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"Pager\",T15.\"Name\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                           "T13.\"Street\",T15.\"Address\", " +
                                           "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                           "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_Info_Export\" " +
                                           "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                           "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                           "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                           "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                           "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                           "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                           "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                           "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_Trans\" " +
                                           "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                           "LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_Trans\" and T15.\"Name\"=T0.\"U_Chofer\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                           "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {
                            //GRANUSA
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                      "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)   " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                      "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                      "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                      "T13.\"Street\",T15.\"U_Direccion\", " +
                                      "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                      "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_Info_Export\" " +
                                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                      "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                      "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                      "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                      "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                      //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                      "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                    }
                }

                #endregion

                //validamos los campos obligatorios
                #region VALIDACIONES
                if (tablacab.Equals("ODLN"))
                {
                    if (string.IsNullOrEmpty(direPay))
                    {
                        if (string.IsNullOrEmpty(direShip))
                        {
                            SBO_Application.StatusBar.SetText("Cargar direccion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                            return;
                        }
                    }
                }

                string v_natu = oDatos.Fields.Item(26).Value.ToString();
                if (string.IsNullOrEmpty(v_natu))
                {
                    SBO_Application.StatusBar.SetText("Cargar naturaleza al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_ope = oDatos.Fields.Item(25).Value.ToString();
                if (string.IsNullOrEmpty(v_ope) || v_ope.Equals("0"))
                {
                    SBO_Application.StatusBar.SetText("Cargar tipo de operacion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_cont = oDatos.Fields.Item(27).Value.ToString();
                if (string.IsNullOrEmpty(v_cont))
                {
                    SBO_Application.StatusBar.SetText("Cargar tipo de contribuyente al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    return;
                }
                string v_direSal = oDatos.Fields.Item(39).Value.ToString();
                if (string.IsNullOrEmpty(v_direSal))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion del establecimiento", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_natTrans = oDatos.Fields.Item(32).Value.ToString();
                if (string.IsNullOrEmpty(v_natTrans))
                {
                    SBO_Application.StatusBar.SetText("Cargar naturaleza del transportista", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_direTrans = oDatos.Fields.Item(41).Value.ToString();
                if (string.IsNullOrEmpty(v_direTrans))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion del transportista", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_chof = oDatos.Fields.Item(37).Value.ToString();
                if (string.IsNullOrEmpty(v_chof))
                {
                    SBO_Application.StatusBar.SetText("Cargar un chofer a la remision", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_idchof = oDatos.Fields.Item(36).Value.ToString();
                if (string.IsNullOrEmpty(v_idchof))
                {
                    SBO_Application.StatusBar.SetText("Cargar cedula al chofer", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_direChof = oDatos.Fields.Item(42).Value.ToString();
                if (string.IsNullOrEmpty(v_direChof))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion al chofer", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                #endregion


                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(43).Value.ToString();
                string rec_dist = oDatos.Fields.Item(44).Value.ToString();
                string rec_loc = oDatos.Fields.Item(45).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(46).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string ResFlete = oDatos.Fields.Item(47).Value.ToString();
                string CodLicitacion = oDatos.Fields.Item(48).Value.ToString();
                string transId = oDatos.Fields.Item(49).Value.ToString();
                string infoadicional = oDatos.Fields.Item(50).Value.ToString();
                string infoExport = oDatos.Fields.Item(51).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //actualizamos los UDF
                Recordset oActUDF;
                oActUDF = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActUDF.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                ////actualizamos la numeracion de la serie           
                //Recordset oActSerie;
                //oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                string serieremi = oDatos.Fields.Item(17).Value.ToString();
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (!oDatos.Fields.Item(25).Value.ToString().Equals("4"))
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                }
                //instaciamos los objetos que vutilizaremos
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                #endregion
                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                gOpeDE.dInfoFisc = "Remision";
                string oper = oDatos.Fields.Item(25).Value.ToString();
                if (oper.Equals("3"))
                {
                    gOpeDE.dInfoEmi = infoadicional;
                }
                if (oper.Equals("4"))
                {
                    gOpeDE.dInfoEmi = infoExport;
                }
                //gTimb
                gTimb.iTiDE = "7";
                gTimb.dNumTim = timbrado;// timbrado;
                gTimb.dEst = esta;// esta;
                gTimb.dPunExp = pun;// pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                string pais = oDatos.Fields.Item(16).Value.ToString();
                if (string.IsNullOrEmpty(pais))
                {
                    gDatRec.cPaisRec = "PRY";
                }
                else
                {
                    gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                }
                //gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.dDesPaisRe = oDatos.Fields.Item(38).Value.ToString();

                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                string direRec = oDatos.Fields.Item(5).Value.ToString();
                string newdireRec = null;
                if (!Regex.IsMatch(direRec, @"^[a-zA-Z-0-9]+$") == true)
                {
                    newdireRec = Regex.Replace(direRec, @"[^0-9a-zA-Z ]+", "");
                }
                else
                {
                    newdireRec = direRec;
                }
                gDatRec.dDirRec = newdireRec;// oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                if (oDatos.Fields.Item(16).Value.ToString() == "PRY")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                    gDatRec.cDepRec = rec_dep;
                    gDatRec.cDisRec = rec_dist;
                    gDatRec.cCiuRec = rec_loc;
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gCamSal
                gCamSal.dDirLocSal = oDatos.Fields.Item(39).Value.ToString();
                gCamSal.dNumCasSal = "0";
                //gCamSal.dComp1Sal =  "aviadores del chaco";
                gCamSal.cDepSal = sal_dep;
                gCamSal.cDisSal = sal_dist;
                gCamSal.cCiuSal = sal_loc;
                //gCamEnt
                gCamEnt.dDirLocEnt = newdireRec;// oDatos.Fields.Item(5).Value.ToString(); //"santa teresa";
                gCamEnt.dNumCasEnt = "0";
                gCamEnt.cDepEnt = rec_dep;
                gCamEnt.cDisEnt = rec_dist;
                gCamEnt.cCiuEnt = rec_loc;
                gCamEnt1[0] = gCamEnt;

                //LICITACION
                #region LICITACION
                if (oDatos.Fields.Item(25).Value.ToString() == "3")
                {
                    Recordset oLicitacion;
                    oLicitacion = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oLicitacion.DoQuery("SELECT \"U_dModCont\",\"U_dEntCont\",\"U_dAnoCont\",\"U_dSecCont\",\"U_dFeCodCont\" FROM \"@LICITACION\" WHERE \"U_LICI\"='" + CodLicitacion + "'");

                    gCompPub.dModCont = oLicitacion.Fields.Item(0).Value.ToString();//"LP";
                    gCompPub.dEntCont = oLicitacion.Fields.Item(1).Value.ToString(); //"12009";
                    gCompPub.dAnoCont = oLicitacion.Fields.Item(2).Value.ToString(); //"22";
                    int sec = int.Parse(oLicitacion.Fields.Item(2).Value.ToString());
                    gCompPub.dSecCont = sec.ToString("D7");// oLicitacion.Fields.Item(3).Value.ToString(); //"218529";
                    DateTime v_fechaLic = DateTime.Parse(oLicitacion.Fields.Item(4).Value.ToString());
                    string fechalic_v = v_fechaLic.ToString("yyyy-MM-dd");
                    gCompPub.dFeCodCont = DateTime.Parse(fechalic_v);//DateTime.Parse("2022-08-31");
                    gCompPub.dFeCodContSpecified = true;
                    gCamFE.gCompPub = gCompPub;
                    //gDtipDE.gCamFE = gCamFE;


                }
                #endregion


                if (oDatos.Fields.Item(34).Value.ToString() == varE)
                {
                    gTransp.iTipTrans = "1";
                    gTransp.dDesTipTrans = "Propio";
                }
                else
                {
                    gTransp.iTipTrans = "2";
                    gTransp.dDesTipTrans = "Tercero";
                }
                gTransp.iModTrans = "1";
                gTransp.iRespFlete = ResFlete;
                gTransp.dIniTras = fe;
                gTransp.dIniTrasSpecified = true;
                gTransp.dFinTras = fe;
                gTransp.dFinTrasSpecified = true;
                //gVehTras
                //gTransp.gVehTras = gVehTras1;
                gVehTras1[0] = gVehTras;
                gVehTras.dTiVehTras = "Terrestre";
                gVehTras.dMarVeh = oDatos.Fields.Item(30).Value.ToString();
                gVehTras.dTipIdenVeh = "2";
                gVehTras.dNroMatVeh = oDatos.Fields.Item(29).Value.ToString();
                //gCamTrans
                gCamTrans.iNatTrans = oDatos.Fields.Item(32).Value.ToString();
                gCamTrans.dNomTrans = oDatos.Fields.Item(33).Value.ToString();
                //deconstruimos el RUC del transportista
                string rucCam = null;
                string dvCam = null;
                if (oDatos.Fields.Item(32).Value.ToString() == "1")
                {
                    string varCam = oDatos.Fields.Item(34).Value.ToString();
                    int indexCam = varCam.IndexOf("-");
                    int canCam = oDatos.Fields.Item(34).Value.ToString().Length;
                    rucCam = oDatos.Fields.Item(34).Value.ToString().Remove(indexCam, canCam - indexCam);
                    dvCam = oDatos.Fields.Item(34).Value.ToString().Remove(0, indexCam + 1);
                }
                string paisTrans = oDatos.Fields.Item(35).Value.ToString();
                if (paisTrans.Equals("PRY"))
                {
                    gCamTrans.dRucTrans = rucCam;
                    gCamTrans.dDVTrans = dvCam;
                }
                else
                {
                    gCamTrans.dNumIDTrans = oDatos.Fields.Item(34).Value.ToString();
                    gCamTrans.iTipIDTrans = "3";
                    gCamTrans.dDTipIDTrans = "Cédula extranjera";
                }
                gCamTrans.cNacTrans = oDatos.Fields.Item(35).Value.ToString();
                gCamTrans.dDesNacTrans = oDatos.Fields.Item(40).Value.ToString();
                gCamTrans.dDomFisc = oDatos.Fields.Item(41).Value.ToString();
                gCamTrans.dNumIDChof = oDatos.Fields.Item(36).Value.ToString();
                gCamTrans.dNomChof = oDatos.Fields.Item(37).Value.ToString();
                string direChofer = oDatos.Fields.Item(42).Value.ToString();
                string newdireChofer = null;
                if (!Regex.IsMatch(direChofer, @"^[a-zA-Z-0-9]+$") == true)
                {
                    newdireChofer = Regex.Replace(direChofer, @"[^0-9a-zA-Z ]+", "");
                }
                else
                {
                    newdireChofer = direChofer;
                }
                gCamTrans.dDirChof = newdireChofer;// oDatos.Fields.Item(42).Value.ToString();
                //gCamNRE
                string motivo = null;
                string codmotivo = null;
                if (tablacab.Equals("OWTR"))
                {
                    codmotivo = "7";
                    motivo = "Traslado entre locales de la empresa";
                }
                else
                {
                    codmotivo = "1";
                    motivo = "Traslado por ventas";
                }
                gCamNRE.iMotEmiNR = codmotivo;// "1";
                gCamNRE.dDesMotEmiNR = motivo;// "Traslado por ventas";
                gCamNRE.iRespEmiNR = "1";
                gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                gCamNRE.dKmR = "3";
                //gCamItem
                int f = 0;
                //recorremos el recordset y mandamos los datos del detalle al objeto
                while (!oDatos.EoF)
                {
                    #region DETALLE
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem.dDncpG = dncpNum.ToString();
                        }
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        decimal ll = decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem2.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();// "024";
                            double dncpNum2 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem2.dDncpG = dncpNum2.ToString();
                        }
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {

                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem3.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum3 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem3.dDncpG = dncpNum3.ToString();
                        }
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem4.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum4 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem4.dDncpG = dncpNum4.ToString();
                        }
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem5.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum5 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem5.dDncpG = dncpNum5.ToString();
                        }
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem6.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum6 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem6.dDncpG = dncpNum6.ToString();
                        }
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem7.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); // "024";
                            double dncpNum7 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem7.dDncpG = dncpNum7.ToString();
                        }
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem8.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum8 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem8.dDncpG = dncpNum8.ToString();
                        }
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem9.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum9 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem9.dDncpG = dncpNum9.ToString();
                        }
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem10.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum10 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem10.dDncpG = dncpNum10.ToString();
                        }
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem11.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum11 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem11.dDncpG = dncpNum11.ToString();
                        }
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem12.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum12 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem12.dDncpG = dncpNum12.ToString();
                        }
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem13.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum13 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem13.dDncpG = dncpNum13.ToString();
                        }
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem14.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum14 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem14.dDncpG = dncpNum14.ToString();
                        }
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem15.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum15 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem15.dDncpG = dncpNum15.ToString();
                        }
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem16.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum16 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem16.dDncpG = dncpNum16.ToString();
                        }
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem17.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum17 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem17.dDncpG = dncpNum17.ToString();
                        }
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem18.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum18 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem18.dDncpG = dncpNum18.ToString();
                        }
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem19.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum19 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem19.dDncpG = dncpNum19.ToString();
                        }
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem20.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum20 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem20.dDncpG = dncpNum20.ToString();
                        }
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem21.dDncpE = "024";
                            int dncpNum21 = 50112001;
                            gCamItem21.dDncpG = dncpNum21.ToString();
                        }
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem22.dDncpE = "024";
                            int dncpNum22 = 50112001;
                            gCamItem22.dDncpG = dncpNum22.ToString();
                        }
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem23.dDncpE = "024";
                            int dncpNum23 = 50112001;
                            gCamItem23.dDncpG = dncpNum23.ToString("");
                        }
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem24.dDncpE = "024";
                            int dncpNum24 = 50112001;
                            gCamItem24.dDncpG = dncpNum24.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem25.dDncpE = "024";
                            int dncpNum25 = 50112001;
                            gCamItem25.dDncpG = dncpNum25.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem26.dDncpE = "024";
                            int dncpNum26 = 50112001;
                            gCamItem26.dDncpG = dncpNum26.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem27.dDncpE = "024";
                            int dncpNum27 = 50112001;
                            gCamItem27.dDncpG = dncpNum27.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem28.dDncpE = "024";
                            int dncpNum28 = 50112001;
                            gCamItem28.dDncpG = dncpNum28.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem29.dDncpE = "024";
                            int dncpNum29 = 50112001;
                            gCamItem29.dDncpG = dncpNum29.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem30.dDncpE = "024";
                            int dncpNum30 = 50112001;
                            gCamItem30.dDncpG = dncpNum30.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem31.dDncpE = "024";
                            int dncpNum31 = 50112001;
                            gCamItem31.dDncpG = dncpNum31.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem32.dDncpE = "024";
                            int dncpNum32 = 50112001;
                            gCamItem32.dDncpG = dncpNum32.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem33.dDncpE = "024";
                            int dncpNum33 = 50112001;
                            gCamItem33.dDncpG = dncpNum33.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem34.dDncpE = "024";
                            int dncpNum34 = 50112001;
                            gCamItem34.dDncpG = dncpNum34.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem35.dDncpE = "024";
                            int dncpNum35 = 50112001;
                            gCamItem35.dDncpG = dncpNum35.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem35;
                    }
                    #endregion

                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = "NOTA_REMISION";
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;
                gDtipDE.gTransp = gTransp;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                gDtipDE.gCamNRE = gCamNRE;
                gTransp.gCamTrans = gCamTrans;
                gTransp.gCamSal = gCamSal;
                gTransp.gCamEnt = gCamEnt1;
                gTransp.gVehTras = gVehTras1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento
                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (true == oCompany.InTransaction)
                {
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                }
                if (resultadoOK == false)
                {
                    string mensajeError = resultadoProcesamiento[0].mensajeError;
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Remision no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Remision creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");
                    //actualizar el estado del documento si es B2G
                    if (v_ope.Equals("3"))
                    {
                        Recordset oActEstado;
                        oActEstado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActEstado.DoQuery("UPDATE " + tablacab + " SET \"Printed\"='Y' where \"DocNum\"='" + codigo + "'");
                    }

                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + serieremi + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 250)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Remision creada con exito", "", MessageBoxButtons.OK, MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Remision creado con exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                if (e.ToString().Contains("System.ServiceModel.EndpointNotFoundException"))
                {
                    MessageBox.Show("Problema de conexión, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("System.indexOutOfRangeException"))
                {
                    MessageBox.Show("Dirección duplicada o ruc inválido, favor revisar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("java.lang.NumberFormatException"))
                {
                    MessageBox.Show("Verificar campos obligatorios, formato incorrecto o vacío!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("org.hibernate.engine.jdbc"))
                {
                    MessageBox.Show("Error en la base de datos, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                else
                {
                    MessageBox.Show(e.ToString());
                }
            }

        }

        //cargar datos en form de anular
        private static void loadAnular(SAPbouiCOM.Form form)
        {
            //cargar combo de documentos
            SAPbouiCOM.ComboBox cboDocu;
            cboDocu = (SAPbouiCOM.ComboBox)form.Items.Item("cboDocu").Specific;
            cboDocu.ValidValues.Add("1", "Factura");
            cboDocu.ValidValues.Add("2", "Nota Credito");
            cboDocu.ValidValues.Add("3", "Nota Debito");
            cboDocu.ValidValues.Add("4", "Entrega");
            cboDocu.ValidValues.Add("5", "Traslado");
            cboDocu.ValidValues.Add("6", "Factura Exportacion");
            cboDocu.Item.DisplayDesc = true;
            //cargar combo de motivos
            SAPbouiCOM.ComboBox cbomoti;
            cbomoti = (SAPbouiCOM.ComboBox)form.Items.Item("cboMoti").Specific;
            cbomoti.ValidValues.Add("1", "Documento mal hecho");
            cbomoti.ValidValues.Add("2", "Documento no corresponde al cliente");
            cbomoti.ValidValues.Add("3", "Error en valor de la operacion");
            cbomoti.ValidValues.Add("4", "Producto mal facturado");
            cbomoti.Item.DisplayDesc = true;
            //cboDocu.ExpandType = BoExpandType.et_DescriptionOnly;
            SAPbouiCOM.StaticText descmoti = (SAPbouiCOM.StaticText)form.Items.Item("Item_8").Specific;
            SAPbouiCOM.EditText desc = (SAPbouiCOM.EditText)form.Items.Item("1_U_E").Specific;
            descmoti.Item.Visible = false;
            desc.Item.Visible = false;

        }

        //cargar datos en form cancelar
        private static void loadCancelar(SAPbouiCOM.Form form)
        {
            //cargar combo de documentos
            SAPbouiCOM.ComboBox cboDocu;
            cboDocu = (SAPbouiCOM.ComboBox)form.Items.Item("cboTipo").Specific;
            cboDocu.ValidValues.Add("1", "Factura");
            cboDocu.ValidValues.Add("2", "Nota Credito");
            cboDocu.ValidValues.Add("3", "Nota Debito");
            cboDocu.ValidValues.Add("4", "Entrega");
            cboDocu.ValidValues.Add("5", "Traslado");
            cboDocu.ValidValues.Add("6", "Factura Exportacion");
            cboDocu.Item.DisplayDesc = true;
            ////cargar combo de motivos
            //SAPbouiCOM.ComboBox cbomoti;
            //cbomoti = (SAPbouiCOM.ComboBox)form.Items.Item("cboMoti").Specific;
            //cbomoti.ValidValues.Add("1", "Documento mal hecho");
            //cbomoti.ValidValues.Add("2", "Documento no corresponde al cliente");
            //cbomoti.ValidValues.Add("3", "Error en valor de la operacion");
            //cbomoti.ValidValues.Add("4", "Producto mal facturado");
            //cbomoti.Item.DisplayDesc = true;
            ////cboDocu.ExpandType = BoExpandType.et_DescriptionOnly;
            //SAPbouiCOM.StaticText descmoti = (SAPbouiCOM.StaticText)form.Items.Item("Item_8").Specific;
            //SAPbouiCOM.EditText desc = (SAPbouiCOM.EditText)form.Items.Item("1_U_E").Specific;
            //descmoti.Item.Visible = false;
            //desc.Item.Visible = false;

        }

        //cargar datos en form export
        private static void loadExport(SAPbouiCOM.Form form)
        {
            //cargar columnas en la grilla
            SAPbouiCOM.Grid grilla;
            SAPbouiCOM.Columns columns;
            SAPbouiCOM.ComboBoxColumn col;
            grilla = (SAPbouiCOM.Grid)form.Items.Item("Item_0").Specific;
            form.DataSources.DataTables.Add("data1");
            grilla.DataTable = form.DataSources.DataTables.Item("data1");
            grilla.DataTable.Columns.Add("ItemCode", BoFieldsType.ft_Text, 0);
            grilla.DataTable.Columns.Add("Descripcion", BoFieldsType.ft_Text, 1);
            grilla.DataTable.Columns.Add("Cantidad", BoFieldsType.ft_Text, 2);
            grilla.DataTable.Columns.Add("Monto", BoFieldsType.ft_Text, 3);
            grilla.AutoResizeColumns();
            grilla.Columns.Item("RowsHeader").TitleObject.Caption = "#";
            //grilla.DataTable.Rows.Add();
            EditTextColumn gridCBo = (SAPbouiCOM.EditTextColumn)grilla.Columns.Item(0);
            gridCBo.Type = BoGridColumnType.gct_ComboBox;
            col = (SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item(0);
            col.ValidValues.Add("EXP0001", "Carne Congelada");
            col.ValidValues.Add("EXP0002", "Menudencia vacuna congelada");
            col.ValidValues.Add("EXP0003", "Carne vacuna enfriada");
            col.ValidValues.Add("EXP0004", "Hamburguesa");
            col.ValidValues.Add("EXP0005", "Sebo bovino fundido");
            col.ValidValues.Add("EXP0006", "Hamburguesa gigante sarubbi 4X8X198 GRS");
            col.ValidValues.Add("EXP0007", "Hamburguesa premium sarubbi 6X12X95 GRS");
            col.ValidValues.Add("EXP0008", "Hamburguesa premium sarubbi 2X50X95 GRS");
            col.ValidValues.Add("EXP0009", "Carne 10/1");
            col.ValidValues.Add("EXP0010", "Carne 4/1");
            col.ValidValues.Add("EXP0011", "Hamburguesa de cane vacuna congelada 110 GR");
            col.ValidValues.Add("EXP0012", "Hamburguesa de carne vacuna congelada 216 GR");
            col.ValidValues.Add("EXP0013", "Hamburguesa premium sarubbi 12X6X95 GRS");

            //agregamos el DocNum de la factura export
            SAPbouiCOM.EditText DocNum;
            DocNum = (SAPbouiCOM.EditText)form.Items.Item("1_U_E").Specific;
            DocNum.Value = codigo;

            SAPbouiCOM.EditText TotalDoc;
            TotalDoc = (SAPbouiCOM.EditText)form.Items.Item("0_U_E").Specific;
            TotalDoc.Value = DocTotal;

            //datos extras export
            SAPbouiCOM.ComboBox oCombo;
            oCombo = (SAPbouiCOM.ComboBox)form.Items.Item("Item_13").Specific;
            oCombo.ValidValues.Add("CFR", "CFR VALUES USD");
            oCombo.ValidValues.Add("CIF", "CIF VALUES USD");
            oCombo.ValidValues.Add("CIP", "CIP VALUES USD");
            oCombo.ValidValues.Add("CPT", "CPT VALUES USD");
            oCombo.ValidValues.Add("EXWORKS", "EXWORKS VALUES USD");
            oCombo.ValidValues.Add("FCA", "FCA VALUES USD");
            oCombo.ValidValues.Add("FOB", "FOB VALUES USD");
            oCombo.ValidValues.Add("FOB A", "FOB ASUNCION");
            oCombo.ValidValues.Add("FOB PA", "FOB PARANAGUA");
            oCombo.ValidValues.Add("FOB BA", "FOB BUENOS AIRES");




        }

        //funcion para anular factura
        private static void anularFactura(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.Documents documento;
            SAPbobsCOM.Documents docCancel;
            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);

            try
            {
                if (documento.GetByKey(nrodocu))
                {
                    //desfoliamos el documento
                    string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                    documento.NumAtCard = folioAnu;
                    documento.FolioPrefixString = "";
                    documento.FolioNumber = 0;
                    documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                    int desfoliar = documento.Update();
                    string descerror = oCompany.GetLastErrorDescription().ToString();
                    if (desfoliar != 0)
                    {
                        SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                        //SBO_Application.SetStatusBarMessage("Error al desfoliar el documento", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                        return;
                    }
                    docCancel = documento.CreateCancellationDocument();
                    int cancelado = docCancel.Add();
                    if (cancelado == 0)
                    {
                        SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                        //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                    }
                    else
                    {
                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                        //SBO_Application.SetStatusBarMessage("Error al cancelar documento", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    }
                }
            }
            catch(Exception e)
            {

            }
            
            Cursor.Current = Cursors.Default;
        }

        //funcion para anular factura export
        private static void anularFacturaExport(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.Documents documento;
            SAPbobsCOM.Documents docCancel;
            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);

            if (documento.GetByKey(nrodocu))
            {
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.NumAtCard = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                string descerror = oCompany.GetLastErrorDescription().ToString();
                if (desfoliar != 0)
                {
                    SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    //SBO_Application.SetStatusBarMessage("Error al desfoliar el documento", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                docCancel = documento.CreateCancellationDocument();
                int cancelado = docCancel.Add();
                if (cancelado == 0)
                {
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    //SBO_Application.SetStatusBarMessage("Error al cancelar documento", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para anular nota de credito
        private static void anularNC(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.Documents documento;
            SAPbobsCOM.Documents docCancel;
            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);

            if (documento.GetByKey(nrodocu))
            {
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.NumAtCard = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                if (desfoliar != 0)
                {
                    SBO_Application.SetStatusBarMessage("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                docCancel = documento.CreateCancellationDocument();
                int cancelado = docCancel.Add();
                if (cancelado == 0)
                {
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.SetStatusBarMessage("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para anular entrega
        private static void anularEntrega(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.Documents documento;
            SAPbobsCOM.Documents docCancel;
            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);

            if (documento.GetByKey(nrodocu))
            {
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.NumAtCard = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                if (desfoliar != 0)
                {
                    SBO_Application.SetStatusBarMessage("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                docCancel = documento.CreateCancellationDocument();
                int cancelado = docCancel.Add();
                if (cancelado == 0)
                {
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.SetStatusBarMessage("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para anular traslado
        private static void anularTraslado(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.StockTransfer documento;
            SAPbobsCOM.StockTransfer docCancel;
            documento = (SAPbobsCOM.StockTransfer)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
            docCancel = (SAPbobsCOM.StockTransfer)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);

            if (documento.GetByKey(nrodocu))
            {
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.Comments = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                if (desfoliar != 0)
                {
                    SBO_Application.SetStatusBarMessage("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                //docCancel = documento.CreateCancellationDocument();
                int cancelado = documento.Cancel();
                if (cancelado == 0)
                {
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.SetStatusBarMessage("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para boquear campos
        private static void bloquearCampos(SAPbouiCOM.Form oForm)
        {
            Item i_cdc = oForm.Items.Item("U_CDC");
            Item i_id = oForm.Items.Item("U_ID");
            Item i_kude = oForm.Items.Item("U_KUDE");
            Item i_xml = oForm.Items.Item("U_XMLFIRMADO");
            Item i_mensaje = oForm.Items.Item("U_MensajeError");
            Item i_estado = oForm.Items.Item("U_ESTADO");
            Item i_fecha = oForm.Items.Item("U_FechaT");
            Item i_qr = oForm.Items.Item("U_CODIGOQR");

            EditText c_cdc = (SAPbouiCOM.EditText)i_cdc.Specific;
            EditText c_id = (SAPbouiCOM.EditText)i_id.Specific;
            EditText c_kude = (SAPbouiCOM.EditText)i_kude.Specific;
            EditText c_xml = (SAPbouiCOM.EditText)i_xml.Specific;
            EditText c_mensaje = (SAPbouiCOM.EditText)i_mensaje.Specific;
            EditText c_estado = (SAPbouiCOM.EditText)i_estado.Specific;
            EditText c_fecha = (SAPbouiCOM.EditText)i_fecha.Specific;
            EditText c_qr = (SAPbouiCOM.EditText)i_qr.Specific;

            c_cdc.Item.Enabled = false;
            c_id.Item.Enabled = false;
            c_kude.Item.Enabled = false;
            c_xml.Item.Enabled = false;
            c_mensaje.Item.Enabled = false;
            c_estado.Item.Enabled = false;
            c_fecha.Item.Enabled = false;
            c_qr.Item.Enabled = false;
        }

        //funcion para autofactura
        private static void CrearAutofactura()
        {

        }

        //funcion para crear nota de debito
        private static void CrearNotaDebito(string codigo)
        {
            try
            {
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM OINV T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE OINV SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from OINV where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);

                #region QUERY NOTA DEBITO
                //consultamos cual direccion se eligio
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\"))," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\",T0.\"TransId\" " +
                                   "FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                   "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "' and T0.\"DocSubType\"='DN'");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\"))," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\",T0.\"TransId\" " +
                                   "FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                   "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "' and T0.\"DocSubType\"='DN'");
                    }
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\"))," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\",T0.\"TransId\" " +
                                   "FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                   "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "' and T0.\"DocSubType\"='DN'");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\"))," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\",T0.\"TransId\" " +
                                   "FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                   "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "' and T0.\"DocSubType\"='DN'");
                    }
                }
                #endregion


                String Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string transId = oDatos.Fields.Item(46).Value.ToString();
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from INV1 where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                ////actualizamos el folio de la factura
                //Recordset oActFolio;
                //oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActFolio.DoQuery("UPDATE OINV SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "' and \"DocSubType\"='DN'");
                ////actualizamos la numeracion de la serie           
                //Recordset oActSerie;
                //oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = oDatos.Fields.Item(4).Value.ToString();
                int index = var.IndexOf("-");
                int can = oDatos.Fields.Item(4).Value.ToString().Length;
                string ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                string dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                //instaciamos los objetos que vutilizaremos
                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                //gTimb
                gTimb.iTiDE = "6";
                gTimb.dDesTiDE = "Nota de débito electrónica";
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }
                gOpeCom.iTipTra = oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = "1";// oDatos.Fields.Item(26).Value.ToString();
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.iTiContRec = "1";// oDatos.Fields.Item(27).Value.ToString();
                                         //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }
                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";  
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //motivo de emision 
                gCamNCDE.iMotEmi = "1";//hay que modificar
                                       //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto
                while (!oDatos.EoF)
                {
                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                       //gValorItem
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem2.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA2.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA2.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem3.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA3.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA3.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem4.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA4.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA4.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem5.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA5.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA5.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA5.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA5.iAfecIVA = "3";
                            gCamIVA5.dBasGravIVA = 0;
                            gCamIVA5.dLiqIVAItem = 0;
                        }
                        gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem5.gValorRestaItem = gValorRestaItem5;
                        gCamItem5.gValorItem = gValorItem5;
                        gCamItem5.gCamIVA = gCamIVA5;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem6.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA6.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA6.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA6.iAfecIVA = "3";
                            gCamIVA6.dBasGravIVA = 0;
                            gCamIVA6.dLiqIVAItem = 0;
                        }
                        gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem6.gValorRestaItem = gValorRestaItem6;
                        gCamItem6.gValorItem = gValorItem6;
                        gCamItem6.gCamIVA = gCamIVA6;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem7.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA7.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA7.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA7.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA7.iAfecIVA = "3";
                            gCamIVA7.dBasGravIVA = 0;
                            gCamIVA7.dLiqIVAItem = 0;
                        }
                        gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem7.gValorRestaItem = gValorRestaItem7;
                        gCamItem7.gValorItem = gValorItem7;
                        gCamItem7.gCamIVA = gCamIVA7;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem8.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA8.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA8.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA8.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA8.iAfecIVA = "3";
                            gCamIVA8.dBasGravIVA = 0;
                            gCamIVA8.dLiqIVAItem = 0;
                        }
                        gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem8.gValorRestaItem = gValorRestaItem8;
                        gCamItem8.gValorItem = gValorItem8;
                        gCamItem8.gCamIVA = gCamIVA8;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem9.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA9.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA9.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA9.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA9.iAfecIVA = "3";
                            gCamIVA9.dBasGravIVA = 0;
                            gCamIVA9.dLiqIVAItem = 0;
                        }
                        gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem9.gValorRestaItem = gValorRestaItem9;
                        gCamItem9.gValorItem = gValorItem9;
                        gCamItem9.gCamIVA = gCamIVA9;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem10.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA10.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA10.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA10.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA10.iAfecIVA = "3";
                            gCamIVA10.dBasGravIVA = 0;
                            gCamIVA10.dLiqIVAItem = 0;
                        }
                        gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem10.gValorRestaItem = gValorRestaItem10;
                        gCamItem10.gValorItem = gValorItem10;
                        gCamItem10.gCamIVA = gCamIVA10;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem11.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA11.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA11.iAfecIVA = "3";
                            gCamIVA11.dBasGravIVA = 0;
                            gCamIVA11.dLiqIVAItem = 0;
                        }
                        gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem11.gValorRestaItem = gValorRestaItem11;
                        gCamItem11.gValorItem = gValorItem11;
                        gCamItem11.gCamIVA = gCamIVA11;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem12.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA12.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA12.iAfecIVA = "3";
                            gCamIVA12.dBasGravIVA = 0;
                            gCamIVA12.dLiqIVAItem = 0;
                        }
                        gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem12.gValorRestaItem = gValorRestaItem12;
                        gCamItem12.gValorItem = gValorItem12;
                        gCamItem12.gCamIVA = gCamIVA12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem13.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA13.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA13.iAfecIVA = "3";
                            gCamIVA13.dBasGravIVA = 0;
                            gCamIVA13.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem13.gValorRestaItem = gValorRestaItem13;
                        gCamItem13.gValorItem = gValorItem13;
                        gCamItem13.gCamIVA = gCamIVA13;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem14.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA14.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA14.iAfecIVA = "3";
                            gCamIVA14.dBasGravIVA = 0;
                            gCamIVA14.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem14.gValorRestaItem = gValorRestaItem14;
                        gCamItem14.gValorItem = gValorItem14;
                        gCamItem14.gCamIVA = gCamIVA14;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem15.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA15.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA15.iAfecIVA = "3";
                            gCamIVA15.dBasGravIVA = 0;
                            gCamIVA15.dLiqIVAItem = 0;
                        }
                        gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem15.gValorRestaItem = gValorRestaItem15;
                        gCamItem15.gValorItem = gValorItem15;
                        gCamItem15.gCamIVA = gCamIVA15;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem16.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA16.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA16.iAfecIVA = "3";
                            gCamIVA16.dBasGravIVA = 0;
                            gCamIVA16.dLiqIVAItem = 0;
                        }
                        gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem16.gValorRestaItem = gValorRestaItem16;
                        gCamItem16.gValorItem = gValorItem16;
                        gCamItem16.gCamIVA = gCamIVA16;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem17.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA17.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA17.iAfecIVA = "3";
                            gCamIVA17.dBasGravIVA = 0;
                            gCamIVA17.dLiqIVAItem = 0;
                        }
                        gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem17.gValorRestaItem = gValorRestaItem17;
                        gCamItem17.gValorItem = gValorItem17;
                        gCamItem17.gCamIVA = gCamIVA17;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem18.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA18.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA18.iAfecIVA = "3";
                            gCamIVA18.dBasGravIVA = 0;
                            gCamIVA18.dLiqIVAItem = 0;
                        }
                        gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem18.gValorRestaItem = gValorRestaItem18;
                        gCamItem18.gValorItem = gValorItem18;
                        gCamItem18.gCamIVA = gCamIVA18;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem19.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA19.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA19.iAfecIVA = "3";
                            gCamIVA19.dBasGravIVA = 0;
                            gCamIVA19.dLiqIVAItem = 0;
                        }
                        gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem19.gValorRestaItem = gValorRestaItem19;
                        gCamItem19.gValorItem = gValorItem19;
                        gCamItem19.gCamIVA = gCamIVA19;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem20.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA20.iAfecIVA = "3";
                            gCamIVA20.dBasGravIVA = 0;
                            gCamIVA20.dLiqIVAItem = 0;
                        }
                        gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem20.gValorRestaItem = gValorRestaItem20;
                        gCamItem20.gValorItem = gValorItem20;
                        gCamItem20.gCamIVA = gCamIVA20;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem21.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA21.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA21.iAfecIVA = "3";
                            gCamIVA21.dBasGravIVA = 0;
                            gCamIVA21.dLiqIVAItem = 0;
                        }
                        gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem21.gValorRestaItem = gValorRestaItem21;
                        gCamItem21.gValorItem = gValorItem21;
                        gCamItem21.gCamIVA = gCamIVA21;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem22.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA22.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA22.iAfecIVA = "3";
                            gCamIVA22.dBasGravIVA = 0;
                            gCamIVA22.dLiqIVAItem = 0;
                        }
                        gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem22.gValorRestaItem = gValorRestaItem22;
                        gCamItem22.gValorItem = gValorItem22;
                        gCamItem22.gCamIVA = gCamIVA22;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem23.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA23.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA23.iAfecIVA = "3";
                            gCamIVA23.dBasGravIVA = 0;
                            gCamIVA23.dLiqIVAItem = 0;
                        }
                        gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem23.gValorRestaItem = gValorRestaItem23;
                        gCamItem23.gValorItem = gValorItem23;
                        gCamItem23.gCamIVA = gCamIVA23;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem24.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA24.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA24.iAfecIVA = "3";
                            gCamIVA24.dBasGravIVA = 0;
                            gCamIVA24.dLiqIVAItem = 0;
                        }
                        gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem24.gValorRestaItem = gValorRestaItem24;
                        gCamItem24.gValorItem = gValorItem24;
                        gCamItem24.gCamIVA = gCamIVA24;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem25.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA25.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA25.iAfecIVA = "3";
                            gCamIVA25.dBasGravIVA = 0;
                            gCamIVA25.dLiqIVAItem = 0;
                        }
                        gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem25.gValorRestaItem = gValorRestaItem25;
                        gCamItem25.gValorItem = gValorItem25;
                        gCamItem25.gCamIVA = gCamIVA25;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem26.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA26.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA26.iAfecIVA = "3";
                            gCamIVA26.dBasGravIVA = 0;
                            gCamIVA26.dLiqIVAItem = 0;
                        }
                        gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem26.gValorRestaItem = gValorRestaItem26;
                        gCamItem26.gValorItem = gValorItem26;
                        gCamItem26.gCamIVA = gCamIVA26;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem27.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA27.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA27.iAfecIVA = "3";
                            gCamIVA27.dBasGravIVA = 0;
                            gCamIVA27.dLiqIVAItem = 0;
                        }
                        gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem27.gValorRestaItem = gValorRestaItem27;
                        gCamItem27.gValorItem = gValorItem27;
                        gCamItem27.gCamIVA = gCamIVA27;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem28.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA28.iAfecIVA = "3";
                            gCamIVA28.dBasGravIVA = 0;
                            gCamIVA28.dLiqIVAItem = 0;
                        }
                        gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem28.gValorRestaItem = gValorRestaItem28;
                        gCamItem28.gValorItem = gValorItem28;
                        gCamItem28.gCamIVA = gCamIVA28;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem29.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA29.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA29.iAfecIVA = "3";
                            gCamIVA29.dBasGravIVA = 0;
                            gCamIVA29.dLiqIVAItem = 0;
                        }
                        gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem29.gValorRestaItem = gValorRestaItem29;
                        gCamItem29.gValorItem = gValorItem29;
                        gCamItem29.gCamIVA = gCamIVA29;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem30.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA30.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA30.iAfecIVA = "3";
                            gCamIVA30.dBasGravIVA = 0;
                            gCamIVA30.dLiqIVAItem = 0;
                        }
                        gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem30.gValorRestaItem = gValorRestaItem30;
                        gCamItem30.gValorItem = gValorItem30;
                        gCamItem30.gCamIVA = gCamIVA30;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem31.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA31.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA31.iAfecIVA = "3";
                            gCamIVA31.dBasGravIVA = 0;
                            gCamIVA31.dLiqIVAItem = 0;
                        }
                        gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem31.gValorRestaItem = gValorRestaItem31;
                        gCamItem31.gValorItem = gValorItem31;
                        gCamItem31.gCamIVA = gCamIVA31;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem32.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA32.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA32.iAfecIVA = "3";
                            gCamIVA32.dBasGravIVA = 0;
                            gCamIVA32.dLiqIVAItem = 0;
                        }
                        gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem32.gValorRestaItem = gValorRestaItem32;
                        gCamItem32.gValorItem = gValorItem32;
                        gCamItem32.gCamIVA = gCamIVA32;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem33.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA33.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA33.iAfecIVA = "3";
                            gCamIVA33.dBasGravIVA = 0;
                            gCamIVA33.dLiqIVAItem = 0;
                        }
                        gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem33.gValorRestaItem = gValorRestaItem33;
                        gCamItem33.gValorItem = gValorItem33;
                        gCamItem33.gCamIVA = gCamIVA33;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem34.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA34.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA34.iAfecIVA = "3";
                            gCamIVA34.dBasGravIVA = 0;
                            gCamIVA34.dLiqIVAItem = 0;
                        }
                        gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem34.gValorRestaItem = gValorRestaItem34;
                        gCamItem34.gValorItem = gValorItem34;
                        gCamItem34.gCamIVA = gCamIVA34;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem35.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA35.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA35.iAfecIVA = "3";
                            gCamIVA35.dBasGravIVA = 0;
                            gCamIVA35.dLiqIVAItem = 0;
                        }
                        gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem35.gValorRestaItem = gValorRestaItem35;
                        gCamItem35.gValorItem = gValorItem35;
                        gCamItem35.gCamIVA = gCamIVA35;
                        gCamItem1[f] = gCamItem35;
                    }
                    #endregion
                    f++;
                    oDatos.MoveNext();
                }

                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = "NOTA_DEBITO";
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;

                if (electronico.Equals("Si"))
                {

                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T1.\"U_CDC\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {

                        //gCamDEAsoc.iTipDocAso = "2";
                        //gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        //gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        //gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        //gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        //gCamDEAsoc.iTipoDocAso = "1";//factura
                        //DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        //string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        //string fechaDoc = FechaDA + "T" + hora2;
                        ////string DAfecha = DateTime.Parse();//FechaDA.ToString("YYYY-MM-DD");//fecha de la factura YYYY-mm-DD
                        //gCamDEAsoc.dFecEmiDI = DateTime.Parse(fechaDoc);
                        //gCamDEAsoc.dFecEmiDISpecified = true;
                        //gCamDEAsoc1[0] = gCamDEAsoc;
                        //gDtipDE.gCamNCDE = gCamNCDE;
                        //DE.gCamDEAsoc = gCamDEAsoc1;
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }
                gCamCond.gPaConEIni = gPaConEIni1;
                gDtipDE.gCamItem = gCamItem1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento
                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE OINV SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "', \"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocEntry\"='" + Entry + "' and \"DocSubType\"='DN'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con Error!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE OINV SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + Entry + "' and \"DocSubType\"='DN'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");


                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE OINV SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "' and \"DocSubType\"='DN'");
                    //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }

            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
            }

        }

        //funcion para crear factura de exportacion
        private static void CrearDocumentoExport(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc, string infoExp, int cantidadGrilla)
        {
            try
            {
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'  AND T0.\"DocSubType\"='IX' ");
                //procedemos a actualizar el documento
                //SAPbobsCOM.Recordset oDocAct;
                //oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "'  AND \"DocSubType\"='IX' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'  AND \"DocSubType\"='IX' ");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio
                //oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                //                      "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\")) END," +
                //                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                //                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                //                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                //                      "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                //                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                //                      "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                //                      "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                //                      "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                //                      "T13.\"U_DESC_SET_FE\",1 " +
                //                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                //                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                //                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                //                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                //                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                //                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                //                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                //                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                //                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                //                      "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                //                      "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                //                      "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                //                      "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                //                      "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                //                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                //                      "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX'");

                #region QUERY DOCUMENTO
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\",\"PriceAfVAT\" ");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\",\"PriceAfVAT\" ");
                    }
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\",\"PriceAfVAT\" ");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\",\"PriceAfVAT\" ");
                    }
                }
                //DETALLE
                SAPbobsCOM.Recordset oDetalleExp;
                oDetalleExp = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDetalleExp.DoQuery("SELECT \"U_U_ItemCode\",\"U_U_Dscription\",\"U_U_cantidad\",\"U_U_TotalLine\" FROM \"@EXPORT\" WHERE \"U_U_DocEntry\"='" + codigo + "'");
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string InfoAdicional = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string InfoExport = oDatos.Fields.Item(53).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //actualizamos el folio de la factura
                //Recordset oActFolio;
                //oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (!oDatos.Fields.Item(25).Value.ToString().Equals("4"))
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion
                //string lplp = "EXPORTACION, CIP, CHILE, BG TRANSPORTE SRL, BG TRANSPORTE SRL, N/A, N/A, N/A, Intermediary Bank: Wells Fargo Bank N.A. (New York USA) Swift Code: PNBPUS3NNYC ABA Code: 026005092 Banco GNB Paraguay SA (Asunción, Paraguay) Swift Code: BGNBPYPX Account Number in PNBPUS3NNYC: 2000192000673 /1101705086 FRIGORIFICO GUARANI SACI - CIP: 129.136,95 USD - FLETE: 5.000,00 USD - SEGURO: 322,84 USD - FCA: 123.814,11 USD - 28 PALLETS - PESO NETO: KG. 23.914,25 - PESO BRUTO: KG.  24.966,35 - TOTAL PIEZAS: 8.641.-";
                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                gOpeDE.dInfoFisc = infoExp;
                gOpeDE.dInfoEmi = infoExp;
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";

                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                //if (oDatos.Fields.Item(26).Value.ToString() == "2")
                //{
                //    gDatRec.iTiOpe = "4";
                //    //gDatRec.iTiContRec = "1";
                //}
                //else
                //{
                //    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                //    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //}
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();
                gDatRec.dNumCasRec = "0";
                //gDatRec.dDesPaisRe = "Paraguay";
                if (oDatos.Fields.Item(16).Value.ToString() == "PRY")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }


                //}


                //REMITO
                #region REMITO
                if (!string.IsNullOrEmpty(trans))
                {
                    string chof = oDatos.Fields.Item(32).Value.ToString();
                    if (!chof.Equals("PERSONAL"))
                    {
                        string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                        if (!string.IsNullOrEmpty(CedChofer))
                        {
                            string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                            string NewDirRec = null;
                            if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                NewDirRec = dirReceptor;

                            }
                            string salDire = oDatos.Fields.Item(37).Value.ToString();
                            string newsalDire = null;
                            if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newsalDire = salDire;

                            }
                            string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                            string newDomFiscal = null;
                            if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newDomFiscal = DomFiscal;

                            }
                            string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                            string newDireChofer = null;
                            if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newDireChofer = DireChofer;

                            }
                            string codTransp = null;
                            string descTrans = null;
                            if (oDatos.Fields.Item(38).Value.ToString() == varE)
                            {
                                codTransp = "1";
                                descTrans = "Propio";
                            }
                            else
                            {
                                codTransp = "2";
                                descTrans = "Tercero";
                            }
                            gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                            gDatRec.dNumCasRec = "0";
                            if (oDatos.Fields.Item(25).Value.ToString() != "4")
                            {
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                            }
                            //gCamSal               
                            gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                            gCamSal.dNumCasSal = "0";
                            //gCamSal.dComp1Sal =  "aviadores del chaco";
                            gCamSal.cDepSal = sal_dep;
                            gCamSal.cCiuSal = sal_loc;
                            gCamSal.cDisSal = sal_dist;
                            //gCamEnt
                            gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                            gCamEnt.dNumCasEnt = "0";
                            gCamEnt.cDepEnt = rec_dep;
                            gCamEnt.cCiuEnt = rec_loc;
                            gCamEnt.cDisEnt = rec_dist;
                            gCamEnt1[0] = gCamEnt;
                            gTransp.iTipTrans = codTransp;// "2";
                            gTransp.dDesTipTrans = descTrans;// "Tercero";
                            gTransp.iModTrans = "1";
                            gTransp.iRespFlete = RespFlete;
                            gTransp.dIniTras = fe;
                            gTransp.dIniTrasSpecified = true;
                            gTransp.dFinTras = fe;
                            gTransp.dFinTrasSpecified = true;
                            //gVehTras
                            //gTransp.gVehTras = gVehTras1;
                            gVehTras1[0] = gVehTras;
                            gVehTras.dTiVehTras = "Terrestre";
                            gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                            gVehTras.dTipIdenVeh = "2";
                            gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                            //gCamTrans
                            gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                            gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                            //deconstruimos el RUC del transportista
                            string rucCam = null;
                            string dvCam = null;
                            if (oDatos.Fields.Item(40).Value.ToString() == "1")
                            {
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                            }

                            string paisTrans = oDatos.Fields.Item(43).Value.ToString();
                            if (paisTrans.Equals("PRY"))
                            {
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                            }
                            else
                            {
                                gCamTrans.dNumIDTrans = oDatos.Fields.Item(38).Value.ToString();
                                gCamTrans.iTipIDTrans = "3";
                                gCamTrans.dDTipIDTrans = "Cédula extranjera";
                            }
                            gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                            gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                            gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                            gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                            gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                            gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                               //gCamNRE
                                                               //gCamNRE.iMotEmiNR = "1";
                                                               //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                               //gCamNRE.iRespEmiNR = "1";
                                                               //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                            gCamNRE.dKmR = "3";
                            //gDtipDE.gCamNRE = gCamNRE;
                            gTransp.gCamTrans = gCamTrans;
                            gTransp.gCamSal = gCamSal;
                            gTransp.gCamEnt = gCamEnt1;
                            gTransp.gVehTras = gVehTras1;
                            gDtipDE.gTransp = gTransp;
                        }

                    }


                }
                #endregion

                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //detalle export
                string codItem = null;
                string descr = null;
                string cant = null;
                string totallinea = null;
                //validad cual detalle mandar
                int v_canDecimal = int.Parse(v_DecimalFG);
                if (cantidadGrilla > 0)
                {
                    while (!oDetalleExp.EoF)
                    {
                        codItem = oDetalleExp.Fields.Item(0).Value.ToString();
                        descr = oDetalleExp.Fields.Item(1).Value.ToString();
                        cant = oDetalleExp.Fields.Item(2).Value.ToString().Replace(".", ",");
                        totallinea = oDetalleExp.Fields.Item(3).Value.ToString().Replace(".", ",");

                        #region DETALLE EXPORT

                        if (f == 0)
                        {
                            gCamItem.dCodInt = codItem;
                            gCamItem.dDesProSer = descr;
                            gCamItem.dCantProSer = decimal.Parse(cant);
                            gValorItem.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA.iAfecIVA = "1";
                                gCamIVA.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA.iAfecIVA = "3";
                                gCamIVA.dBasGravIVA = 0;
                                gCamIVA.dLiqIVAItem = 0;
                            }
                            gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem.gValorRestaItem = gValorRestaItem;
                            gCamItem.gValorItem = gValorItem;
                            gCamItem.gCamIVA = gCamIVA;
                            gCamItem1[f] = gCamItem;
                        }
                        if (f == 1)
                        {
                            gCamItem2.dCodInt = codItem;
                            gCamItem2.dDesProSer = descr;
                            gCamItem2.dCantProSer = decimal.Parse(cant);
                            gValorItem2.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem2.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem2.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem2.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA2.iAfecIVA = "1";
                                gCamIVA2.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA2.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA2.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA2.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA2.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA2.iAfecIVA = "3";
                                gCamIVA2.dBasGravIVA = 0;
                                gCamIVA2.dLiqIVAItem = 0;
                            }
                            gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem2.gValorRestaItem = gValorRestaItem2;
                            gCamItem2.gValorItem = gValorItem2;
                            gCamItem2.gCamIVA = gCamIVA2;
                            gCamItem1[f] = gCamItem2;
                        }
                        if (f == 2)
                        {
                            gCamItem3.dCodInt = codItem;
                            gCamItem3.dDesProSer = descr;
                            gCamItem3.dCantProSer = decimal.Parse(cant);
                            gValorItem3.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem3.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem3.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem3.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA3.iAfecIVA = "1";
                                gCamIVA3.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA3.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA3.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA3.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA3.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA3.iAfecIVA = "3";
                                gCamIVA3.dBasGravIVA = 0;
                                gCamIVA3.dLiqIVAItem = 0;
                            }
                            gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem3.gValorRestaItem = gValorRestaItem3;
                            gCamItem3.gValorItem = gValorItem3;
                            gCamItem3.gCamIVA = gCamIVA3;
                            gCamItem1[f] = gCamItem3;
                        }
                        if (f == 3)
                        {
                            gCamItem4.dCodInt = codItem;
                            gCamItem4.dDesProSer = descr;
                            gCamItem4.dCantProSer = decimal.Parse(cant);
                            gValorItem4.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem4.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem4.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem4.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA4.iAfecIVA = "1";
                                gCamIVA4.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA4.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA4.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA4.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA4.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA4.iAfecIVA = "3";
                                gCamIVA4.dBasGravIVA = 0;
                                gCamIVA4.dLiqIVAItem = 0;
                            }
                            gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem4.gValorRestaItem = gValorRestaItem4;
                            gCamItem4.gValorItem = gValorItem4;
                            gCamItem4.gCamIVA = gCamIVA4;
                            gCamItem1[f] = gCamItem4;
                        }
                        if (f == 4)
                        {
                            gCamItem5.dCodInt = codItem;
                            gCamItem5.dDesProSer = descr;
                            gCamItem5.dCantProSer = decimal.Parse(cant);
                            gValorItem5.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem5.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem5.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem5.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA5.iAfecIVA = "1";
                                gCamIVA5.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA5.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA5.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA5.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA5.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA5.iAfecIVA = "3";
                                gCamIVA5.dBasGravIVA = 0;
                                gCamIVA5.dLiqIVAItem = 0;
                            }
                            gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem5.gValorRestaItem = gValorRestaItem5;
                            gCamItem5.gValorItem = gValorItem5;
                            gCamItem5.gCamIVA = gCamIVA5;
                            gCamItem1[f] = gCamItem5;
                        }
                        if (f == 5)
                        {
                            gCamItem6.dCodInt = codItem;
                            gCamItem6.dDesProSer = descr;
                            gCamItem6.dCantProSer = decimal.Parse(cant);
                            gValorItem6.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                            gValorItem6.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem6.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem6.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA6.iAfecIVA = "1";
                                gCamIVA6.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA6.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA6.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA6.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA6.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA6.iAfecIVA = "3";
                                gCamIVA6.dBasGravIVA = 0;
                                gCamIVA6.dLiqIVAItem = 0;
                            }
                            gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem6.gValorRestaItem = gValorRestaItem6;
                            gCamItem6.gValorItem = gValorItem6;
                            gCamItem6.gCamIVA = gCamIVA6;
                            gCamItem1[f] = gCamItem6;
                        }

                        #endregion
                        f++;
                        oDetalleExp.MoveNext();
                        if (false == oCompany.InTransaction)
                        {
                            oCompany.StartTransaction();
                        }
                    }
                }
                else
                {
                    while (!oDatos.EoF)
                    {
                        if (!oDatos.Fields.Item(11).Value.ToString().Equals("I0000059") && !oDatos.Fields.Item(11).Value.ToString().Equals("I0000060") && !oDatos.Fields.Item(11).Value.ToString().Equals("I0000061"))
                        {
                            #region DETALLE DOCUMENTO
                            if (f == 0)
                            {
                                gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;                       

                                //gValorItem
                                string pp = oDatos.Fields.Item(14).Value.ToString();
                                gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA.iAfecIVA = "1";
                                    gCamIVA.dPropIVA = 100;
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA.iAfecIVA = "3";
                                    gCamIVA.dBasGravIVA = 0;
                                    gCamIVA.dLiqIVAItem = 0;
                                }
                                gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem.gValorRestaItem = gValorRestaItem;
                                gCamItem.gValorItem = gValorItem;
                                gCamItem.gCamIVA = gCamIVA;
                                gCamItem1[f] = gCamItem;
                            }
                            if (f == 1)
                            {
                                gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem2.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA2.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA2.iAfecIVA = "3";
                                    gCamIVA2.dBasGravIVA = 0;
                                    gCamIVA2.dLiqIVAItem = 0;
                                }
                                gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem2.gValorRestaItem = gValorRestaItem2;
                                gCamItem2.gValorItem = gValorItem2;
                                gCamItem2.gCamIVA = gCamIVA2;
                                gCamItem1[f] = gCamItem2;
                            }
                            if (f == 2)
                            {
                                gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem3.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA3.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA3.iAfecIVA = "3";
                                    gCamIVA3.dBasGravIVA = 0;
                                    gCamIVA3.dLiqIVAItem = 0;
                                }
                                gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem3.gValorRestaItem = gValorRestaItem3;
                                gCamItem3.gValorItem = gValorItem3;
                                gCamItem3.gCamIVA = gCamIVA3;
                                gCamItem1[f] = gCamItem3;
                            }
                            if (f == 3)
                            {
                                gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem4.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA4.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA4.iAfecIVA = "3";
                                    gCamIVA4.dBasGravIVA = 0;
                                    gCamIVA4.dLiqIVAItem = 0;
                                }
                                gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem4.gValorRestaItem = gValorRestaItem4;
                                gCamItem4.gValorItem = gValorItem4;
                                gCamItem4.gCamIVA = gCamIVA4;
                                gCamItem1[f] = gCamItem4;
                            }
                            if (f == 4)
                            {
                                gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem5.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA5.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA5.iAfecIVA = "3";
                                    gCamIVA5.dBasGravIVA = 0;
                                    gCamIVA5.dLiqIVAItem = 0;
                                }
                                gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem5.gValorRestaItem = gValorRestaItem5;
                                gCamItem5.gValorItem = gValorItem5;
                                gCamItem5.gCamIVA = gCamIVA5;
                                gCamItem1[f] = gCamItem5;
                            }
                            if (f == 5)
                            {
                                gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem6.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA6.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA6.iAfecIVA = "3";
                                    gCamIVA6.dBasGravIVA = 0;
                                    gCamIVA6.dLiqIVAItem = 0;
                                }
                                gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem6.gValorRestaItem = gValorRestaItem6;
                                gCamItem6.gValorItem = gValorItem6;
                                gCamItem6.gCamIVA = gCamIVA6;
                                gCamItem1[f] = gCamItem6;
                            }
                            if (f == 6)
                            {
                                gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem7.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA7.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA7.iAfecIVA = "3";
                                    gCamIVA7.dBasGravIVA = 0;
                                    gCamIVA7.dLiqIVAItem = 0;
                                }
                                gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem7.gValorRestaItem = gValorRestaItem7;
                                gCamItem7.gValorItem = gValorItem7;
                                gCamItem7.gCamIVA = gCamIVA7;
                                gCamItem1[f] = gCamItem7;
                            }
                            if (f == 7)
                            {
                                gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem8.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA8.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA8.iAfecIVA = "3";
                                    gCamIVA8.dBasGravIVA = 0;
                                    gCamIVA8.dLiqIVAItem = 0;
                                }
                                gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem8.gValorRestaItem = gValorRestaItem8;
                                gCamItem8.gValorItem = gValorItem8;
                                gCamItem8.gCamIVA = gCamIVA8;
                                gCamItem1[f] = gCamItem8;
                            }
                            if (f == 8)
                            {
                                gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem9.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA9.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA9.iAfecIVA = "3";
                                    gCamIVA9.dBasGravIVA = 0;
                                    gCamIVA9.dLiqIVAItem = 0;
                                }
                                gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem9.gValorRestaItem = gValorRestaItem9;
                                gCamItem9.gValorItem = gValorItem9;
                                gCamItem9.gCamIVA = gCamIVA9;
                                gCamItem1[f] = gCamItem9;
                            }
                            if (f == 9)
                            {
                                gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem10.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA10.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA10.iAfecIVA = "3";
                                    gCamIVA10.dBasGravIVA = 0;
                                    gCamIVA10.dLiqIVAItem = 0;
                                }
                                gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem10.gValorRestaItem = gValorRestaItem10;
                                gCamItem10.gValorItem = gValorItem10;
                                gCamItem10.gCamIVA = gCamIVA10;
                                gCamItem1[f] = gCamItem10;
                            }
                            if (f == 10)
                            {
                                gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem11.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA11.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA11.iAfecIVA = "3";
                                    gCamIVA11.dBasGravIVA = 0;
                                    gCamIVA11.dLiqIVAItem = 0;
                                }
                                gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem11.gValorRestaItem = gValorRestaItem11;
                                gCamItem11.gValorItem = gValorItem11;
                                gCamItem11.gCamIVA = gCamIVA11;
                                gCamItem1[f] = gCamItem11;
                            }
                            if (f == 11)
                            {
                                gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem12.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA12.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA12.iAfecIVA = "3";
                                    gCamIVA12.dBasGravIVA = 0;
                                    gCamIVA12.dLiqIVAItem = 0;
                                }
                                gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem12.gValorRestaItem = gValorRestaItem12;
                                gCamItem12.gValorItem = gValorItem12;
                                gCamItem12.gCamIVA = gCamIVA12;
                                gCamItem1[f] = gCamItem12;
                            }
                            if (f == 12)
                            {
                                gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem13.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA13.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA13.iAfecIVA = "3";
                                    gCamIVA13.dBasGravIVA = 0;
                                    gCamIVA13.dLiqIVAItem = 0;
                                }
                                gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem13.gValorRestaItem = gValorRestaItem13;
                                gCamItem13.gValorItem = gValorItem13;
                                gCamItem13.gCamIVA = gCamIVA13;
                                gCamItem1[f] = gCamItem13;
                            }
                            if (f == 13)
                            {
                                gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem14.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA14.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA14.iAfecIVA = "3";
                                    gCamIVA14.dBasGravIVA = 0;
                                    gCamIVA14.dLiqIVAItem = 0;
                                }
                                gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem14.gValorRestaItem = gValorRestaItem14;
                                gCamItem14.gValorItem = gValorItem14;
                                gCamItem14.gCamIVA = gCamIVA14;
                                gCamItem1[f] = gCamItem14;
                            }
                            if (f == 14)
                            {
                                gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem15.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA15.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA15.iAfecIVA = "3";
                                    gCamIVA15.dBasGravIVA = 0;
                                    gCamIVA15.dLiqIVAItem = 0;
                                }
                                gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem15.gValorRestaItem = gValorRestaItem15;
                                gCamItem15.gValorItem = gValorItem15;
                                gCamItem15.gCamIVA = gCamIVA15;
                                gCamItem1[f] = gCamItem15;
                            }
                            if (f == 15)
                            {
                                gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem16.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA16.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA16.iAfecIVA = "3";
                                    gCamIVA16.dBasGravIVA = 0;
                                    gCamIVA16.dLiqIVAItem = 0;
                                }
                                gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem16.gValorRestaItem = gValorRestaItem16;
                                gCamItem16.gValorItem = gValorItem16;
                                gCamItem16.gCamIVA = gCamIVA16;
                                gCamItem1[f] = gCamItem16;
                            }
                            if (f == 16)
                            {
                                gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem17.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA17.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA17.iAfecIVA = "3";
                                    gCamIVA17.dBasGravIVA = 0;
                                    gCamIVA17.dLiqIVAItem = 0;
                                }
                                gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem17.gValorRestaItem = gValorRestaItem17;
                                gCamItem17.gValorItem = gValorItem17;
                                gCamItem17.gCamIVA = gCamIVA17;
                                gCamItem1[f] = gCamItem17;
                            }
                            if (f == 17)
                            {
                                gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem18.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA18.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA18.iAfecIVA = "3";
                                    gCamIVA18.dBasGravIVA = 0;
                                    gCamIVA18.dLiqIVAItem = 0;
                                }
                                gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem18.gValorRestaItem = gValorRestaItem18;
                                gCamItem18.gValorItem = gValorItem18;
                                gCamItem18.gCamIVA = gCamIVA18;
                                gCamItem1[f] = gCamItem18;
                            }
                            if (f == 18)
                            {
                                gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem19.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA19.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA19.iAfecIVA = "3";
                                    gCamIVA19.dBasGravIVA = 0;
                                    gCamIVA19.dLiqIVAItem = 0;
                                }
                                gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem19.gValorRestaItem = gValorRestaItem19;
                                gCamItem19.gValorItem = gValorItem19;
                                gCamItem19.gCamIVA = gCamIVA19;
                                gCamItem1[f] = gCamItem19;
                            }
                            if (f == 19)
                            {
                                gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem20.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA20.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA20.iAfecIVA = "3";
                                    gCamIVA20.dBasGravIVA = 0;
                                    gCamIVA20.dLiqIVAItem = 0;
                                }
                                gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem20.gValorRestaItem = gValorRestaItem20;
                                gCamItem20.gValorItem = gValorItem20;
                                gCamItem20.gCamIVA = gCamIVA20;
                                gCamItem1[f] = gCamItem20;
                            }
                            if (f == 20)
                            {
                                gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem21.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA21.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA21.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA21.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA21.iAfecIVA = "3";
                                    gCamIVA21.dBasGravIVA = 0;
                                    gCamIVA21.dLiqIVAItem = 0;
                                }
                                gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem21.gValorRestaItem = gValorRestaItem21;
                                gCamItem21.gValorItem = gValorItem21;
                                gCamItem21.gCamIVA = gCamIVA21;
                                gCamItem1[f] = gCamItem21;
                            }
                            if (f == 21)
                            {
                                gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem22.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA22.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA22.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA22.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA22.iAfecIVA = "3";
                                    gCamIVA22.dBasGravIVA = 0;
                                    gCamIVA22.dLiqIVAItem = 0;
                                }
                                gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem22.gValorRestaItem = gValorRestaItem22;
                                gCamItem22.gValorItem = gValorItem22;
                                gCamItem22.gCamIVA = gCamIVA22;
                                gCamItem1[f] = gCamItem22;
                            }
                            if (f == 22)
                            {
                                gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem23.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA23.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA23.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA23.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA23.iAfecIVA = "3";
                                    gCamIVA23.dBasGravIVA = 0;
                                    gCamIVA23.dLiqIVAItem = 0;
                                }
                                gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem23.gValorRestaItem = gValorRestaItem23;
                                gCamItem23.gValorItem = gValorItem23;
                                gCamItem23.gCamIVA = gCamIVA23;
                                gCamItem1[f] = gCamItem23;
                            }
                            if (f == 23)
                            {
                                gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem24.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA24.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA24.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA24.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA24.iAfecIVA = "3";
                                    gCamIVA24.dBasGravIVA = 0;
                                    gCamIVA24.dLiqIVAItem = 0;
                                }
                                gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem24.gValorRestaItem = gValorRestaItem24;
                                gCamItem24.gValorItem = gValorItem24;
                                gCamItem24.gCamIVA = gCamIVA24;
                                gCamItem1[f] = gCamItem24;
                            }
                            if (f == 24)
                            {
                                gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem25.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA25.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA25.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA25.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA25.iAfecIVA = "3";
                                    gCamIVA25.dBasGravIVA = 0;
                                    gCamIVA25.dLiqIVAItem = 0;
                                }
                                gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem25.gValorRestaItem = gValorRestaItem25;
                                gCamItem25.gValorItem = gValorItem25;
                                gCamItem25.gCamIVA = gCamIVA25;
                                gCamItem1[f] = gCamItem25;
                            }
                            if (f == 25)
                            {
                                gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem26.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA26.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA26.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA26.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA26.iAfecIVA = "3";
                                    gCamIVA26.dBasGravIVA = 0;
                                    gCamIVA26.dLiqIVAItem = 0;
                                }
                                gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem26.gValorRestaItem = gValorRestaItem26;
                                gCamItem26.gValorItem = gValorItem26;
                                gCamItem26.gCamIVA = gCamIVA26;
                                gCamItem1[f] = gCamItem26;
                            }
                            if (f == 26)
                            {
                                gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem27.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA27.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA27.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA27.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA27.iAfecIVA = "3";
                                    gCamIVA27.dBasGravIVA = 0;
                                    gCamIVA27.dLiqIVAItem = 0;
                                }
                                gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem27.gValorRestaItem = gValorRestaItem27;
                                gCamItem27.gValorItem = gValorItem27;
                                gCamItem27.gCamIVA = gCamIVA27;
                                gCamItem1[f] = gCamItem27;
                            }
                            if (f == 27)
                            {
                                gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem28.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA28.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA28.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA28.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA28.iAfecIVA = "3";
                                    gCamIVA28.dBasGravIVA = 0;
                                    gCamIVA28.dLiqIVAItem = 0;
                                }
                                gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem28.gValorRestaItem = gValorRestaItem28;
                                gCamItem28.gValorItem = gValorItem28;
                                gCamItem28.gCamIVA = gCamIVA28;
                                gCamItem1[f] = gCamItem28;
                            }
                            if (f == 28)
                            {
                                gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem29.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA29.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA29.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA29.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA29.iAfecIVA = "3";
                                    gCamIVA29.dBasGravIVA = 0;
                                    gCamIVA29.dLiqIVAItem = 0;
                                }
                                gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem29.gValorRestaItem = gValorRestaItem29;
                                gCamItem29.gValorItem = gValorItem29;
                                gCamItem29.gCamIVA = gCamIVA29;
                                gCamItem1[f] = gCamItem29;
                            }
                            if (f == 29)
                            {
                                gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem30.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA30.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA30.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA30.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA30.iAfecIVA = "3";
                                    gCamIVA30.dBasGravIVA = 0;
                                    gCamIVA30.dLiqIVAItem = 0;
                                }
                                gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem30.gValorRestaItem = gValorRestaItem30;
                                gCamItem30.gValorItem = gValorItem30;
                                gCamItem30.gCamIVA = gCamIVA30;
                                gCamItem1[f] = gCamItem30;
                            }
                            if (f == 30)
                            {
                                gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem31.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA31.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA31.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA31.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA31.iAfecIVA = "3";
                                    gCamIVA31.dBasGravIVA = 0;
                                    gCamIVA31.dLiqIVAItem = 0;
                                }
                                gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem31.gValorRestaItem = gValorRestaItem31;
                                gCamItem31.gValorItem = gValorItem31;
                                gCamItem31.gCamIVA = gCamIVA31;
                                gCamItem1[f] = gCamItem31;
                            }
                            if (f == 31)
                            {
                                gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem32.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA32.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA32.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA32.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA32.iAfecIVA = "3";
                                    gCamIVA32.dBasGravIVA = 0;
                                    gCamIVA32.dLiqIVAItem = 0;
                                }
                                gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem32.gValorRestaItem = gValorRestaItem32;
                                gCamItem32.gValorItem = gValorItem32;
                                gCamItem32.gCamIVA = gCamIVA32;
                                gCamItem1[f] = gCamItem32;
                            }
                            if (f == 32)
                            {
                                gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem33.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA33.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA33.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA33.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA33.iAfecIVA = "3";
                                    gCamIVA33.dBasGravIVA = 0;
                                    gCamIVA33.dLiqIVAItem = 0;
                                }
                                gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem33.gValorRestaItem = gValorRestaItem33;
                                gCamItem33.gValorItem = gValorItem33;
                                gCamItem33.gCamIVA = gCamIVA33;
                                gCamItem1[f] = gCamItem33;
                            }
                            if (f == 33)
                            {
                                gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem34.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA34.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA34.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA34.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA34.iAfecIVA = "3";
                                    gCamIVA34.dBasGravIVA = 0;
                                    gCamIVA34.dLiqIVAItem = 0;
                                }
                                gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem34.gValorRestaItem = gValorRestaItem34;
                                gCamItem34.gValorItem = gValorItem34;
                                gCamItem34.gCamIVA = gCamIVA34;
                                gCamItem1[f] = gCamItem34;
                            }
                            if (f == 34)
                            {
                                gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem35.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA35.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA35.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA35.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA35.iAfecIVA = "3";
                                    gCamIVA35.dBasGravIVA = 0;
                                    gCamIVA35.dLiqIVAItem = 0;
                                }
                                gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem35.gValorRestaItem = gValorRestaItem35;
                                gCamItem35.gValorItem = gValorItem35;
                                gCamItem35.gCamIVA = gCamIVA35;
                                gCamItem1[f] = gCamItem35;
                            }
                            if (f == 35)
                            {
                                gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem36.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA36.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA36.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA36.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA36.iAfecIVA = "3";
                                    gCamIVA36.dBasGravIVA = 0;
                                    gCamIVA36.dLiqIVAItem = 0;
                                }
                                gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem36.gValorRestaItem = gValorRestaItem36;
                                gCamItem36.gValorItem = gValorItem36;
                                gCamItem36.gCamIVA = gCamIVA36;
                                gCamItem1[f] = gCamItem36;
                            }
                            if (f == 36)
                            {
                                gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem37.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA37.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA37.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA37.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA37.iAfecIVA = "3";
                                    gCamIVA37.dBasGravIVA = 0;
                                    gCamIVA37.dLiqIVAItem = 0;
                                }
                                gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem37.gValorRestaItem = gValorRestaItem37;
                                gCamItem37.gValorItem = gValorItem37;
                                gCamItem37.gCamIVA = gCamIVA37;
                                gCamItem1[f] = gCamItem37;
                            }
                            if (f == 37)
                            {
                                gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem38.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA38.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA38.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA38.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA38.iAfecIVA = "3";
                                    gCamIVA38.dBasGravIVA = 0;
                                    gCamIVA38.dLiqIVAItem = 0;
                                }
                                gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem38.gValorRestaItem = gValorRestaItem38;
                                gCamItem38.gValorItem = gValorItem38;
                                gCamItem38.gCamIVA = gCamIVA38;
                                gCamItem1[f] = gCamItem38;
                            }
                            if (f == 38)
                            {
                                gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem39.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA39.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA39.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA39.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA39.iAfecIVA = "3";
                                    gCamIVA39.dBasGravIVA = 0;
                                    gCamIVA39.dLiqIVAItem = 0;
                                }
                                gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem39.gValorRestaItem = gValorRestaItem39;
                                gCamItem39.gValorItem = gValorItem39;
                                gCamItem39.gCamIVA = gCamIVA39;
                                gCamItem1[f] = gCamItem39;
                            }
                            if (f == 39)
                            {
                                gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem40.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA40.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA40.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA40.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA40.iAfecIVA = "3";
                                    gCamIVA40.dBasGravIVA = 0;
                                    gCamIVA40.dLiqIVAItem = 0;
                                }
                                gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem40.gValorRestaItem = gValorRestaItem40;
                                gCamItem40.gValorItem = gValorItem40;
                                gCamItem40.gCamIVA = gCamIVA40;
                                gCamItem1[f] = gCamItem40;
                            }
                            if (f == 40)
                            {
                                gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem41.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA41.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA41.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA41.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA41.iAfecIVA = "3";
                                    gCamIVA41.dBasGravIVA = 0;
                                    gCamIVA41.dLiqIVAItem = 0;
                                }
                                gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem41.gValorRestaItem = gValorRestaItem41;
                                gCamItem41.gValorItem = gValorItem41;
                                gCamItem41.gCamIVA = gCamIVA41;
                                gCamItem1[f] = gCamItem41;
                            }
                            if (f == 41)
                            {
                                gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem42.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA42.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA42.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA42.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA42.iAfecIVA = "3";
                                    gCamIVA42.dBasGravIVA = 0;
                                    gCamIVA42.dLiqIVAItem = 0;
                                }
                                gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem42.gValorRestaItem = gValorRestaItem42;
                                gCamItem42.gValorItem = gValorItem42;
                                gCamItem42.gCamIVA = gCamIVA42;
                                gCamItem1[f] = gCamItem42;
                            }
                            if (f == 42)
                            {
                                gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem43.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA43.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA43.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA43.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA43.iAfecIVA = "3";
                                    gCamIVA43.dBasGravIVA = 0;
                                    gCamIVA43.dLiqIVAItem = 0;
                                }
                                gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem43.gValorRestaItem = gValorRestaItem43;
                                gCamItem43.gValorItem = gValorItem43;
                                gCamItem43.gCamIVA = gCamIVA43;
                                gCamItem1[f] = gCamItem43;
                            }
                            if (f == 43)
                            {
                                gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem44.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA44.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA44.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA44.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA44.iAfecIVA = "3";
                                    gCamIVA44.dBasGravIVA = 0;
                                    gCamIVA44.dLiqIVAItem = 0;
                                }
                                gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem44.gValorRestaItem = gValorRestaItem44;
                                gCamItem44.gValorItem = gValorItem44;
                                gCamItem44.gCamIVA = gCamIVA44;
                                gCamItem1[f] = gCamItem44;
                            }
                            if (f == 44)
                            {
                                gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem45.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA45.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA45.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA45.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA45.iAfecIVA = "3";
                                    gCamIVA45.dBasGravIVA = 0;
                                    gCamIVA45.dLiqIVAItem = 0;
                                }
                                gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem45.gValorRestaItem = gValorRestaItem45;
                                gCamItem45.gValorItem = gValorItem45;
                                gCamItem45.gCamIVA = gCamIVA45;
                                gCamItem1[f] = gCamItem45;
                            }
                            #endregion
                        }

                        f++;
                        oDatos.MoveNext();
                        if (false == oCompany.InTransaction)
                        {
                            oCompany.StartTransaction();
                        }
                    }
                }


                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = "FACTURA_SIMPLE";
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }

                gCamCond.gPaConEIni = gPaConEIni1;
                gDtipDE.gCamItem = gCamItem1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "' AND \"DocSubType\"='IX' ");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "',\"Printed\"='Y',\"U_Info_Export\"='" + infoExp + "' where \"DocNum\"='" + codigo + "' AND \"DocSubType\"='IX'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");


                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                if (e.ToString().Contains("System.ServiceModel.EndpointNotFoundException"))
                {
                    MessageBox.Show("Problema de conexión, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("System.indexOutOfRangeException"))
                {
                    MessageBox.Show("Dirección duplicada o ruc inválido, favor revisar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("java.lang.NumberFormatException"))
                {
                    MessageBox.Show("Verificar campos obligatorios, formato incorrecto o vacío!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("org.hibernate.engine.jdbc"))
                {
                    MessageBox.Show("Error en la base de datos, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                else
                {
                    MessageBox.Show(e.ToString());
                }
            }
        }

        //funcion para cambiar los mensajes de botones
        public class MessageBoxManager
        {
            private delegate IntPtr HookProc(int nCode, IntPtr wParam, IntPtr lParam);
            private delegate bool EnumChildProc(IntPtr hWnd, IntPtr lParam);

            private const int WH_CALLWNDPROCRET = 12;
            private const int WM_DESTROY = 0x0002;
            private const int WM_INITDIALOG = 0x0110;
            private const int WM_TIMER = 0x0113;
            private const int WM_USER = 0x400;
            private const int DM_GETDEFID = WM_USER + 0;

            private const int MBOK = 1;
            private const int MBCancel = 2;
            private const int MBAbort = 3;
            private const int MBRetry = 4;
            private const int MBIgnore = 5;
            private const int MBYes = 6;
            private const int MBNo = 7;


            [DllImport("user32.dll")]
            private static extern IntPtr SendMessage(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);

            [DllImport("user32.dll")]
            private static extern IntPtr SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, int threadId);

            [DllImport("user32.dll")]
            private static extern int UnhookWindowsHookEx(IntPtr idHook);

            [DllImport("user32.dll")]
            private static extern IntPtr CallNextHookEx(IntPtr idHook, int nCode, IntPtr wParam, IntPtr lParam);

            [DllImport("user32.dll", EntryPoint = "GetWindowTextLengthW", CharSet = CharSet.Unicode)]
            private static extern int GetWindowTextLength(IntPtr hWnd);

            [DllImport("user32.dll", EntryPoint = "GetWindowTextW", CharSet = CharSet.Unicode)]
            private static extern int GetWindowText(IntPtr hWnd, StringBuilder text, int maxLength);

            [DllImport("user32.dll")]
            private static extern int EndDialog(IntPtr hDlg, IntPtr nResult);

            [DllImport("user32.dll")]
            private static extern bool EnumChildWindows(IntPtr hWndParent, EnumChildProc lpEnumFunc, IntPtr lParam);

            [DllImport("user32.dll", EntryPoint = "GetClassNameW", CharSet = CharSet.Unicode)]
            private static extern int GetClassName(IntPtr hWnd, StringBuilder lpClassName, int nMaxCount);

            [DllImport("user32.dll")]
            private static extern int GetDlgCtrlID(IntPtr hwndCtl);

            [DllImport("user32.dll")]
            private static extern IntPtr GetDlgItem(IntPtr hDlg, int nIDDlgItem);

            [DllImport("user32.dll", EntryPoint = "SetWindowTextW", CharSet = CharSet.Unicode)]
            private static extern bool SetWindowText(IntPtr hWnd, string lpString);


            [StructLayout(LayoutKind.Sequential)]
            public struct CWPRETSTRUCT
            {
                public IntPtr lResult;
                public IntPtr lParam;
                public IntPtr wParam;
                public uint message;
                public IntPtr hwnd;
            };

            private static HookProc hookProc;
            private static EnumChildProc enumProc;
            [ThreadStatic]
            private static IntPtr hHook;
            [ThreadStatic]
            private static int nButton;

            /// <summary>
            /// OK text
            /// </summary>
            public static string OK = "&OK";
            /// <summary>
            /// Cancel text
            /// </summary>
            public static string Cancel = "&Cancel";
            /// <summary>
            /// Abort text
            /// </summary>
            public static string Abort = "&Abort";
            /// <summary>
            /// Retry text
            /// </summary>
            public static string Retry = "&Retry";
            /// <summary>
            /// Ignore text
            /// </summary>
            public static string Ignore = "&Ignore";
            /// <summary>
            /// Yes text
            /// </summary>
            public static string Yes = "&Yes";
            /// <summary>
            /// No text
            /// </summary>
            public static string No = "&No";

            static MessageBoxManager()
            {
                hookProc = new HookProc(MessageBoxHookProc);
                enumProc = new EnumChildProc(MessageBoxEnumProc);
                hHook = IntPtr.Zero;
            }

            /// <summary>
            /// Enables MessageBoxManager functionality
            /// </summary>
            /// <remarks>
            /// MessageBoxManager functionality is enabled on current thread only.
            /// Each thread that needs MessageBoxManager functionality has to call this method.
            /// </remarks>
            public static void Register()
            {
                if (hHook != IntPtr.Zero)
                    throw new NotSupportedException("One hook per thread allowed.");
                hHook = SetWindowsHookEx(WH_CALLWNDPROCRET, hookProc, IntPtr.Zero, AppDomain.GetCurrentThreadId());
            }

            /// <summary>
            /// Disables MessageBoxManager functionality
            /// </summary>
            /// <remarks>
            /// Disables MessageBoxManager functionality on current thread only.
            /// </remarks>
            public static void Unregister()
            {
                if (hHook != IntPtr.Zero)
                {
                    UnhookWindowsHookEx(hHook);
                    hHook = IntPtr.Zero;
                }
            }

            private static IntPtr MessageBoxHookProc(int nCode, IntPtr wParam, IntPtr lParam)
            {
                if (nCode < 0)
                    return CallNextHookEx(hHook, nCode, wParam, lParam);

                CWPRETSTRUCT msg = (CWPRETSTRUCT)Marshal.PtrToStructure(lParam, typeof(CWPRETSTRUCT));
                IntPtr hook = hHook;

                if (msg.message == WM_INITDIALOG)
                {
                    int nLength = GetWindowTextLength(msg.hwnd);
                    StringBuilder className = new StringBuilder(10);
                    GetClassName(msg.hwnd, className, className.Capacity);
                    if (className.ToString() == "#32770")
                    {
                        nButton = 0;
                        EnumChildWindows(msg.hwnd, enumProc, IntPtr.Zero);
                        if (nButton == 1)
                        {
                            IntPtr hButton = GetDlgItem(msg.hwnd, MBCancel);
                            if (hButton != IntPtr.Zero)
                                SetWindowText(hButton, OK);
                        }
                    }
                }

                return CallNextHookEx(hook, nCode, wParam, lParam);
            }

            private static bool MessageBoxEnumProc(IntPtr hWnd, IntPtr lParam)
            {
                StringBuilder className = new StringBuilder(10);
                GetClassName(hWnd, className, className.Capacity);
                if (className.ToString() == "Button")
                {
                    int ctlId = GetDlgCtrlID(hWnd);
                    switch (ctlId)
                    {
                        case MBOK:
                            SetWindowText(hWnd, OK);
                            break;
                        case MBCancel:
                            SetWindowText(hWnd, Cancel);
                            break;
                        case MBAbort:
                            SetWindowText(hWnd, Abort);
                            break;
                        case MBRetry:
                            SetWindowText(hWnd, Retry);
                            break;
                        case MBIgnore:
                            SetWindowText(hWnd, Ignore);
                            break;
                        case MBYes:
                            SetWindowText(hWnd, Yes);
                            break;
                        case MBNo:
                            SetWindowText(hWnd, No);
                            break;

                    }
                    nButton++;
                }

                return true;
            }


        }

        //funcion para auditoria
        private static void loadAuditoria(SAPbouiCOM.Form oForm)
        {
            SAPbouiCOM.EditText oFechaD = (SAPbouiCOM.EditText)oForm.Items.Item("Item_2").Specific;
            SAPbouiCOM.EditText oFechaH = (SAPbouiCOM.EditText)oForm.Items.Item("Item_3").Specific;
            SAPbouiCOM.EditText oSerie = (SAPbouiCOM.EditText)oForm.Items.Item("Item_6").Specific;
            SAPbouiCOM.ComboBox oCboDoc = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_8").Specific;
            SAPbouiCOM.ComboBox oEstado = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_11").Specific;
            SAPbouiCOM.StaticText oLabel1 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_15").Specific;
            SAPbouiCOM.StaticText oLabel2 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_27").Specific;
            SAPbouiCOM.StaticText oLabel3 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_28").Specific;
            SAPbouiCOM.StaticText oLabel4 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_26").Specific;
            SAPbouiCOM.StaticText oLabel5 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_32").Specific;
            SAPbouiCOM.StaticText oLabel6 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_33").Specific;
            SAPbouiCOM.EditText oSN = (SAPbouiCOM.EditText)oForm.Items.Item("Item_36").Specific;
            SAPbouiCOM.Button btndesc = (SAPbouiCOM.Button)oForm.Items.Item("Item_37").Specific;
            SAPbouiCOM.Button btncorreo = (SAPbouiCOM.Button)oForm.Items.Item("Item_39").Specific;
            SAPbouiCOM.CheckBox chkcorreo = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_34").Specific;
            oForm.DataSources.UserDataSources.Add("chkcorreo", BoDataType.dt_SHORT_TEXT, 1);
            chkcorreo.ValOff = "N";
            chkcorreo.ValOn = "Y";
            chkcorreo.DataBind.SetBound(true, "", "chkcorreo");
            oForm.DataSources.UserDataSources.Item("chkcorreo").Value = "Y";
            SAPbouiCOM.CheckBox chktodos = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_40").Specific;
            oForm.DataSources.UserDataSources.Add("chktodos", BoDataType.dt_SHORT_TEXT, 1);
            chktodos.ValOff = "N";
            chktodos.ValOn = "Y";
            chktodos.DataBind.SetBound(true, "", "chktodos");
            oForm.DataSources.UserDataSources.Item("chktodos").Value = "N";
            chktodos.Caption = "Marcar todos";

            btncorreo.Item.Enabled = false;


            oForm.DataSources.DataTables.Add("data1");
            //tamaño de los labels
            oLabel1.Item.FontSize = 25;
            oLabel1.Item.Height = 25;
            oLabel1.Item.RightJustified = true;
            //oLabel1.Item.ForeColor = Color.Green.G;
            string colorcode = "#FF008000";
            int argb = Int32.Parse(colorcode.Replace("#", ""), NumberStyles.HexNumber);
            oLabel1.Item.ForeColor = argb;

            oLabel2.Item.FontSize = 25;
            oLabel2.Item.Height = 25;
            oLabel2.Item.RightJustified = true;
            oLabel2.Item.ForeColor = Color.Red.A;

            oLabel3.Item.FontSize = 25;
            oLabel3.Item.Height = 25;
            oLabel3.Item.RightJustified = true;

            oLabel4.Item.FontSize = 25;
            oLabel4.Item.Height = 25;
            oLabel4.Item.RightJustified = true;

            oLabel5.Item.FontSize = 25;
            oLabel5.Item.Height = 25;
            oLabel5.Item.RightJustified = true;

            oLabel6.Item.FontSize = 25;
            oLabel6.Item.Height = 25;
            oLabel6.Item.RightJustified = true;
            //oLabelF.Item.ForeColor = 128;// Color.FromArgb(0,128,0).B;
            //listado de documentos.
            oCboDoc.ValidValues.Add("1", "Factura");
            oCboDoc.ValidValues.Add("2", "Nota de Crédito");
            oCboDoc.ValidValues.Add("3", "Remisión Entrega");
            oCboDoc.ValidValues.Add("4", "Remisión Traslado");
            oCboDoc.ValidValues.Add("5", "Nota de Débito");
            oCboDoc.ValidValues.Add("6", "Autofactura");
            oCboDoc.ValidValues.Add("7", "Factura Export");
            oCboDoc.Item.DisplayDesc = true;
            //listado de estados
            oEstado.ValidValues.Add("1", "APROBADO");
            oEstado.ValidValues.Add("2", "RECHAZADO");
            oEstado.Item.DisplayDesc = true;

            //cargamos los valores aprobados
            SAPbobsCOM.Recordset oFacApro;
            oFacApro = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacApro.DoQuery("select count(*) from OINV where \"U_ESTADO\"='APROBADO' and \"CANCELED\"='N' ");

            SAPbobsCOM.Recordset oNCApro;
            oNCApro = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCApro.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='APROBADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oEntApro;
            oEntApro = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntApro.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='APROBADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oTrasApro;
            oTrasApro = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasApro.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='APROBADO' and \"CANCELED\"='N'");

            double v_valor = double.Parse(oFacApro.Fields.Item(0).Value.ToString()) + double.Parse(oNCApro.Fields.Item(0).Value.ToString()) + double.Parse(oEntApro.Fields.Item(0).Value.ToString()) + double.Parse(oTrasApro.Fields.Item(0).Value.ToString());
            oLabel1.Caption = v_valor.ToString();

            //cargamos los valores rechazados
            SAPbobsCOM.Recordset oFacRech;
            oFacRech = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacRech.DoQuery("select count(*) from OINV where \"U_ESTADO\"='RECHAZADO' and \"CANCELED\"='N' ");

            SAPbobsCOM.Recordset oNCRech;
            oNCRech = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCRech.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='RECHAZADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oEntRech;
            oEntRech = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntRech.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='RECHAZADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oTrasRech;
            oTrasRech = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasRech.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='RECHAZADO' and \"CANCELED\"='N'");

            double v_valor2 = double.Parse(oFacRech.Fields.Item(0).Value.ToString()) + double.Parse(oNCRech.Fields.Item(0).Value.ToString()) + double.Parse(oEntRech.Fields.Item(0).Value.ToString()) + double.Parse(oTrasRech.Fields.Item(0).Value.ToString());
            oLabel2.Caption = v_valor2.ToString();

            //cargamos los documentos inutilizados
            SAPbobsCOM.Recordset oFacInu;
            oFacInu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacInu.DoQuery("select count(*) from OINV where \"U_ESTADO\"='INUTILIZADO'");

            SAPbobsCOM.Recordset oNCInu;
            oNCInu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCInu.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='INUTILIZADO'");

            SAPbobsCOM.Recordset oEntInu;
            oEntInu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntInu.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='INUTILIZADO'");

            SAPbobsCOM.Recordset oTrasInu;
            oTrasInu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasInu.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='INUTILIZADO'");

            double v_valor4 = double.Parse(oFacInu.Fields.Item(0).Value.ToString()) + double.Parse(oNCInu.Fields.Item(0).Value.ToString()) + double.Parse(oEntInu.Fields.Item(0).Value.ToString()) + double.Parse(oTrasInu.Fields.Item(0).Value.ToString());
            oLabel4.Caption = v_valor4.ToString();

            //cargamos los documentos cancelados
            SAPbobsCOM.Recordset oFacCan;
            oFacCan = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacCan.DoQuery("select count(*) from OINV where \"U_ESTADO\"='CANCELADO'");

            SAPbobsCOM.Recordset oNCCan;
            oNCCan = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCCan.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='CANCELADO'");

            SAPbobsCOM.Recordset oEntCan;
            oEntCan = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntCan.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='CANCELADO'");

            SAPbobsCOM.Recordset oTrasCan;
            oTrasCan = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasCan.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='CANCELADO'");

            double v_valor5 = double.Parse(oFacCan.Fields.Item(0).Value.ToString()) + double.Parse(oNCCan.Fields.Item(0).Value.ToString()) + double.Parse(oEntCan.Fields.Item(0).Value.ToString()) + double.Parse(oTrasCan.Fields.Item(0).Value.ToString());
            oLabel5.Caption = v_valor5.ToString();

            //cargamos los documentos procesados
            SAPbobsCOM.Recordset oFacProc;
            oFacProc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacProc.DoQuery("select count(*) from OINV where \"U_ESTADO\"='PROCESADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oNCProc;
            oNCProc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCProc.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='PROCESADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oEntProc;
            oEntProc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntProc.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='PROCESADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oTrasProc;
            oTrasProc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasProc.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='PROCESADO' and \"CANCELED\"='N'");

            double v_valor6 = double.Parse(oFacProc.Fields.Item(0).Value.ToString()) + double.Parse(oNCProc.Fields.Item(0).Value.ToString()) + double.Parse(oEntProc.Fields.Item(0).Value.ToString()) + double.Parse(oTrasProc.Fields.Item(0).Value.ToString());
            oLabel6.Caption = v_valor6.ToString();


        }

        //funcion para inutilizacion
        private static void loadinutilizacion(SAPbouiCOM.Form oForm)
        {
            //combobox de tipo de documento
            SAPbouiCOM.ComboBox cbodocu = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_20").Specific;
            cbodocu.ValidValues.Add("1", "Factura");
            cbodocu.ValidValues.Add("2", "Factura Export");
            cbodocu.ValidValues.Add("3", "Factura importación");
            cbodocu.ValidValues.Add("4", "Autofactura");
            cbodocu.ValidValues.Add("5", "Nota de crédito");
            cbodocu.ValidValues.Add("6", "Nota de débito");
            cbodocu.ValidValues.Add("7", "Remisión Entrega");
            cbodocu.ValidValues.Add("8", "Remisión Traslado");
            cbodocu.Item.DisplayDesc = true;

            //combobox de motivo
            SAPbouiCOM.ComboBox cbomoti = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_23").Specific;
            cbomoti.ValidValues.Add("1", "Folio inutilizado");
            cbomoti.Item.DisplayDesc = true;

            //folders
            SAPbouiCOM.Folder folder1 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_5").Specific;
            SAPbouiCOM.Folder folder2 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_6").Specific;
            //folder2.Item.Enabled = false;

            //checkbox
            //SAPbouiCOM.CheckBox chk1 = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_0").Specific;
            //oForm.DataSources.UserDataSources.Add("chk1", BoDataType.dt_SHORT_TEXT, 1);
            //chk1.ValOn = "Y";
            //chk1.ValOff = "N";
            //chk1.DataBind.SetBound(true, "", "chk1");
            //oForm.DataSources.UserDataSources.Item("chk1").Value = "Y";
            //SAPbouiCOM.CheckBox chk2 = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_1").Specific;
            //oForm.DataSources.UserDataSources.Add("chk2", BoDataType.dt_SHORT_TEXT, 1);
            //chk2.ValOn = "Y";
            //chk2.ValOff = "N";
            //chk2.DataBind.SetBound(true, "", "chk2");
            //oForm.DataSources.UserDataSources.Item("chk2").Value = "N";

            //Buscamos el timbrado y ruc de la empresa logeada
            //SAPbobsCOM.Recordset oDatos;
            //oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            //oDatos.DoQuery("");

            string v_ruc = null;
            string v_timbrado = null;
            if (oCompany.CompanyName.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                v_ruc = "80003232-2";
                v_timbrado = "16094946";
            }
            else
            {
                v_ruc = "80082380-0";
                v_timbrado = "16148774";
            }
            SAPbouiCOM.EditText ruc = (SAPbouiCOM.EditText)oForm.Items.Item("Item_16").Specific;
            SAPbouiCOM.EditText timb = (SAPbouiCOM.EditText)oForm.Items.Item("Item_17").Specific;
            ruc.Value = v_ruc;
            timb.Value = v_timbrado;

        }

        //funcion para objetivos
        private static void loadObjetivos(SAPbouiCOM.Form oForm)
        {
            SAPbouiCOM.EditText v_texto = (SAPbouiCOM.EditText)oForm.Items.Item("Item_5").Specific;
            SAPbouiCOM.EditText v_periodo = (SAPbouiCOM.EditText)oForm.Items.Item("20_U_E").Specific;
            SAPbouiCOM.Grid v_grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_4").Specific;
            v_periodo.Item.Click();
            v_texto.Item.Visible = false;
            v_grilla.Item.Visible = false;


        }

        //funcion para formulario de contro FE
        private static void ControlFE(SAPbouiCOM.Form oForm)
        {
            //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(oform);
            SAPbouiCOM.Grid grilla;
            SAPbouiCOM.EditText oFechaD = (SAPbouiCOM.EditText)oForm.Items.Item("Item_2").Specific;
            SAPbouiCOM.EditText oFechaH = (SAPbouiCOM.EditText)oForm.Items.Item("Item_3").Specific;
            SAPbouiCOM.EditText oSerie = (SAPbouiCOM.EditText)oForm.Items.Item("Item_6").Specific;
            SAPbouiCOM.ComboBox oDoc = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_8").Specific;
            SAPbouiCOM.ComboBox oEstado = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_11").Specific;
            SAPbouiCOM.EditText oCardCode = (SAPbouiCOM.EditText)oForm.Items.Item("Item_36").Specific;
            SAPbouiCOM.CheckBox chkcorreo = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_34").Specific;
            SAPbouiCOM.CheckBox chktodos = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_40").Specific;


            string v_fechaD = oFechaD.Value;
            string v_fechaH = oFechaH.Value;
            string v_serie = oSerie.Value;
            string v_doc = oDoc.Selected.Value.ToString();
            string v_estadoD = oEstado.Selected.Description.ToString();
            string v_CardCode = oCardCode.Value;
            bool v_chkcorreo = chkcorreo.Checked;
            bool v_chktodos = chktodos.Checked;
            string v_tabla = null, v_sub = null;
            string q_serie = null, v_object = null, v_SeriBusq = null, v_docu = null; string v_busqsn = null;
            //tabla que corresponde la busqueda
            if (v_doc.Equals("1")) { v_tabla = "OINV"; v_object = "13"; v_docu = "Factura"; }
            if (v_doc.Equals("2")) { v_tabla = "ORIN"; v_object = "14"; v_docu = "Nota de crédito"; }
            if (v_doc.Equals("3")) { v_tabla = "ODLN"; v_object = "15"; v_docu = "Remisión entrega"; }
            if (v_doc.Equals("4")) { v_tabla = "OWTR"; v_object = "67"; v_docu = "Remisión traslado"; }
            if (v_doc.Equals("5")) { v_tabla = "OINV"; v_object = "13"; v_sub = " AND T0.\"DocSubType\"='ND' "; v_docu = "Nota de débito"; }
            if (v_doc.Equals("6")) { v_tabla = "@OAFE"; v_docu = "Autofactura"; }
            if (v_doc.Equals("7")) { v_tabla = "OINV"; v_object = "13"; v_sub = " AND T0.\"DocSubType\"='IX' "; v_docu = "Factura Export"; }

            //para buscar por serie
            q_serie = " AND \"ObjectCode\"='" + v_object + "' ";
            //buscamos el nombre de la serie para realizar la busqueda en el query
            if (!string.IsNullOrEmpty(v_serie))
            {
                SAPbobsCOM.Recordset oCodSerie;
                oCodSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oCodSerie.DoQuery("SELECT \"Series\" FROM NNM1 WHERE \"SeriesName\"='" + v_serie + "' " + q_serie + " ");

                v_SeriBusq = " AND T0.\"Series\"='" + oCodSerie.Fields.Item(0).Value.ToString() + "' ";
            }
            //busqueda de socio de negocio
            if (!string.IsNullOrEmpty(v_CardCode)) { v_busqsn = " AND T1.\"LicTradNum\"='" + v_CardCode + "' "; }
            //para buscar solo los clientes que tengan correo
            string v_busqcorreo = null;
            if (v_chkcorreo == true) { v_busqcorreo = " AND T1.\"E_Mail\" IS NOT NULL "; }

            //DataTable datos = new DataTable();
            string tim = null;
            if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                tim = "16094946";
            }
            else
            {
                tim = "16148774";
            }
            string query = "SELECT T0.\"DocDate\" as \"FECHA\",'" + v_docu + "' AS \"TIPO DOCUMENTO\",T0.\"DocNum\" as \"# INTERNO\",T1.\"LicTradNum\" as \"RUC\",T1.\"CardName\" as \"RAZON SOCIAL\",T0.\"U_ESTA\"||'-'||T0.\"U_PEMI\"||'-'||LPAD(T0.\"FolioNum\",7,'0') AS \"# DOCUMENTO\",T0.\"U_CDC\" as \"CDC\",T1.\"E_Mail\" as \"Correo Electrónico\",T0.\"ReceiptNum\" as \"COBRO\",T0.\"U_ESTADO\" as \"ESTADO\",\"U_MensajeError\" AS \"MENSAJE DE ERROR\",T2.\"CORREO_CLIENTE\" as \"CORREO ENVIADO\", CASE WHEN T2.\"ESTADO_ENVIO\" IS NULL THEN 'N' ELSE T2.\"ESTADO_ENVIO\"  END AS \"ESTADO ENVIO\",'' AS \"Chek\" " +
                           "FROM " + v_tabla + " T0 " +
                           "INNER JOIN OCRD T1 ON T1.\"CardCode\"=T0.\"CardCode\" " +
                           "LEFT JOIN \"INF_HOLDING\".\"DOC_ELECTRONICO\" T2 ON T2.\"CDC\"=T0.\"U_CDC\" " +
                           "WHERE T0.\"DocDate\" BETWEEN '" + v_fechaD + "' AND '" + v_fechaH + "' AND T0.\"U_TIMB\"='" + tim + "' AND T0.\"U_ESTADO\" ='" + v_estadoD + "' AND T0.\"CANCELED\"='N' " + v_sub + v_SeriBusq + v_busqsn + v_busqcorreo + "   ORDER BY 1,4 ASC";
            SAPbobsCOM.Recordset oDatosDoc;
            oDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDoc.DoQuery(query);
            int cantdatos = oDatosDoc.RecordCount;
            //consultas.ConsultasClient cliente = new consultas.ConsultasClient();
            //consultas.consultaRequest consultaEstado = new consultas.consultaRequest();
            //consultas.consultaRequest1[] consultaEstado1 = new consultas.consultaRequest1[1];
            //consultas.consultaResponse consultaResp = new consultas.consultaResponse();
            //consultas.consultaResponse1 consultaResp1 = new consultas.consultaResponse1();
            //consultas.numeroTipoDocumento numTipo = new consultas.numeroTipoDocumento();
            //consultas.numeroTipoDocumento[] numTipo1 = new consultas.numeroTipoDocumento[1];


            string[] v_cdc = new string[1];
            int fila = 0;
            string v_estado = null;

            grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
            //grilla.DataTable.Clear();

            grilla.DataTable = oForm.DataSources.DataTables.Item("data1");
            grilla.DataTable.Columns.Add("Fecha", BoFieldsType.ft_Text, 0);
            grilla.DataTable.Columns.Add("Tipo Documento", BoFieldsType.ft_Text, 1);
            grilla.DataTable.Columns.Add("# INTERNO", BoFieldsType.ft_Text, 2);
            grilla.DataTable.Columns.Add("Numero Documento", BoFieldsType.ft_Text, 3);
            grilla.DataTable.Columns.Add("CDC", BoFieldsType.ft_Text, 4);
            grilla.DataTable.Columns.Add("Correo electrónico", BoFieldsType.ft_Text, 5);
            grilla.DataTable.Columns.Add("Estado", BoFieldsType.ft_Text, 6);
            grilla.DataTable.Columns.Add("Mensaje de error", BoFieldsType.ft_Text, 7);
            grilla.DataTable.Columns.Add("ENLACE", BoFieldsType.ft_Text, 8);
            grilla.AutoResizeColumns();
            grilla.Columns.Item("RowsHeader").TitleObject.Caption = "#";
            //grilla.DataTable.Rows.Add();
            oForm.DataSources.DataTables.Item("data1").ExecuteQuery(query);
            grilla.DataTable = oForm.DataSources.DataTables.Item("data1");
            string v_fecha, v_tipodoc, v_interno, v_numdoc, v_factura;

            //while (!oDatosDoc.EoF)
            //{
            //    v_fecha = oDatosDoc.Fields.Item(0).Value.ToString();
            //    v_tipodoc = oDatosDoc.Fields.Item(1).Value.ToString();
            //    v_interno = oDatosDoc.Fields.Item(2).Value.ToString();
            //    v_factura = oDatosDoc.Fields.Item(4).Value.ToString();
            //    // consumimos el servicio para saber el estado del documento
            //    string msjError = null;
            //    v_cdc[0] = oDatosDoc.Fields.Item(3).Value.ToString();//"01800032322017002000726312023011717496606328";
            //    consultaEstado.cdc = v_cdc;
            //    consultaEstado.ruc = 80003232;
            //    consultaResp = cliente.consulta(consultaEstado);
            //    v_estado = consultaResp.documento[0].estado;
            //    if (v_estado.Equals("RECHAZADO") || v_estado.Equals("RECHAZADO_REINGRESADO"))
            //    {
            //        msjError = consultaResp.documento[0].documentoError[0].mensaje.ToString();
            //    }
            //    //grilla.DataTable.Rows.Add();
            //    //grilla.DataTable.SetValue(0, fila, v_fecha);
            //    //grilla.DataTable.SetValue(1, fila, v_tipodoc);
            //    //grilla.DataTable.SetValue(2, fila, v_interno);
            //    //grilla.DataTable.SetValue(3, fila, v_factura);
            //    grilla.DataTable.SetValue(5, fila, v_estado);
            //    grilla.DataTable.SetValue(6, fila, msjError);
            //    //grilla.DataTable.SetValue(6, fila, v_fecha);
            //    oDatosDoc.MoveNext();
            //    fila++;
            //}
            //consultaEstado.ruc = 80003232;
            //consultaEstado.rucSpecified = true;
            //consultaEstado.dv = "2";           
            //consultaEstado.fechaEmisionDesde = DateTime.Parse("2023-01-13");
            //consultaEstado.fechaEmisionDesdeSpecified = true;
            //consultaEstado.fechaEmisionHasta = DateTime.Parse("2023-01-14");
            //consultaEstado.fechaEmisionHastaSpecified = true;
            //numTipo.tipo = "1";
            //numTipo1[0] = numTipo;
            //consultaEstado.numeroTipoDocumento = numTipo1;
            //consultaResp = cliente.consulta(consultaEstado);
            //string v_cant = consultaResp.cantidadTotalResultados;



            //agregar check box a la columna
            SAPbouiCOM.CheckBoxColumn col;
            EditTextColumn gridbutton = (SAPbouiCOM.EditTextColumn)grilla.Columns.Item(13);
            gridbutton.Type = BoGridColumnType.gct_CheckBox;
            col = (SAPbouiCOM.CheckBoxColumn)grilla.Columns.Item(13);
        }

        //funcion para actualizar los estados
        private static void ActualizarEstados()
        {

            //prueba actualizar estados
            consultas.ConsultasClient cliente = new consultas.ConsultasClient();
            consultas.consultaRequest consultaEstado = new consultas.consultaRequest();
            consultas.consultaRequest1[] consultaEstado1 = new consultas.consultaRequest1[1];
            consultas.consultaResponse consultaResp = new consultas.consultaResponse();
            consultas.consultaResponse1 consultaResp1 = new consultas.consultaResponse1();
            consultas.numeroTipoDocumento numTipo = new consultas.numeroTipoDocumento();
            consultas.numeroTipoDocumento[] numTipo1 = new consultas.numeroTipoDocumento[1];
            string[] v_cdc = new string[1];//AND T0.\"U_CDC\" !='' AND \"CANCELED\"='N' T0.\"DocDate\" BETWEEN '20230101' AND '20230131' AND

            //FACTURAS
            string tim = null;
            if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                tim = "16094946";
            }
            else
            {
                tim = "16148774";
            }
            string query = "SELECT T0.\"DocNum\",T0.\"U_CDC\" " +
                           "FROM OINV T0 " +
                           "WHERE  \"U_TIMB\"='" + tim + "' AND  ( \"U_ESTADO\"='RECHAZADO'  or \"U_ESTADO\"='PROCESADO' or \"U_ESTADO\"='PENDIENTE') ORDER BY 1 ASC";
            SAPbobsCOM.Recordset oDatosDoc;
            oDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDoc.DoQuery(query);
            int cantdatos = oDatosDoc.RecordCount;
            string v_est = null;
            Cursor.Current = Cursors.WaitCursor;
            while (!oDatosDoc.EoF)

            {
                //consumimos el servicio para saber el estado del documento
                string msjError = null;
                v_cdc[0] = oDatosDoc.Fields.Item(1).Value.ToString();//"01800032322017002000726312023011717496606328";
                consultaEstado.cdc = v_cdc;
                consultaEstado.ruc = 80003232;
                consultaEstado.dv = "2";
                consultaResp = cliente.consulta(consultaEstado);
                int canResu = int.Parse(consultaResp.cantidadResultados.ToString());
                if (canResu == 1)
                {
                    v_est = consultaResp.documento[0].estado;
                }
                else
                {
                    v_est = consultaResp.documento[canResu - 1].estado;
                }

                string estadoFac = null;
                if (v_est.Equals("RECHAZADO") || v_est.Equals("RECHAZADO_REINGRESADO") || v_est.Equals("RECHAZADO_INUTILIZADO"))
                {
                    msjError = consultaResp.documento[canResu - 1].documentoError[0].mensaje.ToString();
                    estadoFac = "RECHAZADO";
                }
                else
                {
                    estadoFac = v_est;
                    msjError = "";
                }
                //actualizamos el estado del documento
                SAPbobsCOM.Recordset oAct;
                oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAct.DoQuery("UPDATE OINV SET \"U_ESTADO\"='" + estadoFac + "',\"U_MensajeError\"='" + msjError + "' WHERE \"DocNum\"='" + oDatosDoc.Fields.Item(0).Value.ToString() + "' ");
                //buscamos si existe o no el documento en la tabla de auditoria
                SAPbobsCOM.Recordset oAuditoria;
                oAuditoria = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAuditoria.DoQuery("SELECT * FROM \"INF_HOLDING\".\"DOC_ELECTRONICO\" T0 INNER JOIN OINV T1 ON T0.\"CDC\"=T1.\"U_CDC\" WHERE T1.\"DocNum\"='" + oDatosDoc.Fields.Item(0).Value.ToString() + "' AND T0.\"TIPO_DOCUMENTO\"='1'  ");
                int contDoc = oAuditoria.RecordCount;
                if (contDoc > 0)
                {
                    //realizamos un UPDATE
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET  \"ESTADO\"='" + estadoFac + "' WHERE \"NRO_DOCUMENTO\"='" + oDatosDoc.Fields.Item(0).Value.ToString() + "' AND \"TIPO_DOCUMENTO\"='1' ");
                }
                else
                {
                    //buscamos los datos del documento
                    SAPbobsCOM.Recordset pDatosDoc;
                    pDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    string queryDoc = "SELECT T2.\"TaxIdNum\",'1',T0.\"U_ID\",T0.\"CardCode\",T1.\"LicTradNum\",T0.\"U_CDC\",T0.\"DocNum\",T0.\"DocDate\",T0.\"DocTotal\",T0.\"U_ESTADO\",t0.\"U_MensajeError\",T1.\"E_Mail\",T1.\"Cellular\",'N' FROM OINV T0 " +
                                      "INNER JOIN OCRD T1 ON T0.\"CardCode\"=t1.\"CardCode\" " +
                                      "LEFT JOIN OADM T2 ON T2.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "WHERE T0.\"DocNum\"='" + oDatosDoc.Fields.Item(0).Value.ToString() + "' ";
                    pDatosDoc.DoQuery(queryDoc);
                    //DateTime fecha = DateTime.Parse(pDatosDoc.Fields.Item(7).Value.ToString());
                    //string v_fecha = fecha.ToString("yyyy-MM-dd");
                    //DateTime fecha_v = DateTime.Parse(v_fecha);
                    //realizamos un INSERT
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("INSERT INTO \"INF_HOLDING\".\"DOC_ELECTRONICO\" (\"RUC_EMISOR\",\"TIPO_DOCUMENTO\",\"ID_DOC\",\"CLIENTE_CODIGO\",\"RUC_CLIENTE\",\"CDC\",\"NRO_DOCUMENTO\",\"FECHA\",\"TOTAL_DOCUMENTO\",\"ESTADO\",\"MENSAJE_ERROR\",\"CORREO_CLIENTE\",\"CELULAR_CLIENTE\",\"ESTADO_ENVIO\")" +
                                          " VALUES ('" + pDatosDoc.Fields.Item(0).Value.ToString() + "','" + pDatosDoc.Fields.Item(1).Value.ToString() + "','" + pDatosDoc.Fields.Item(2).Value.ToString() + "','" + pDatosDoc.Fields.Item(3).Value.ToString() + "','" + pDatosDoc.Fields.Item(4).Value.ToString() + "','" + pDatosDoc.Fields.Item(5).Value.ToString() + "','" + pDatosDoc.Fields.Item(6).Value.ToString() + "','" + pDatosDoc.Fields.Item(7).Value.ToString() + "','" + pDatosDoc.Fields.Item(8).Value.ToString() + "','" + pDatosDoc.Fields.Item(9).Value.ToString() + "','" + pDatosDoc.Fields.Item(10).Value.ToString() + "','" + pDatosDoc.Fields.Item(11).Value.ToString() + "','" + pDatosDoc.Fields.Item(12).Value.ToString() + "','" + pDatosDoc.Fields.Item(13).Value.ToString() + "') ");
                }


                oDatosDoc.MoveNext();
            }

            //NOTA DE CREDITO
            string query2 = "SELECT T0.\"DocNum\",T0.\"U_CDC\" " +
                           "FROM ORIN T0 " +
                           "WHERE \"U_TIMB\"='" + tim + "' AND  ( \"U_ESTADO\"='RECHAZADO'  or \"U_ESTADO\"='PROCESADO' or \"U_ESTADO\"='PENDIENTE')  ORDER BY 1 ASC";
            SAPbobsCOM.Recordset oDatosDocNC;
            oDatosDocNC = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDocNC.DoQuery(query2);
            int cantdatosNC = oDatosDocNC.RecordCount;
            string v_est2 = null;
            while (!oDatosDocNC.EoF)
            {
                //consumimos el servicio para saber el estado del documento
                string msjError2 = null;
                v_cdc[0] = oDatosDocNC.Fields.Item(1).Value.ToString();//"01800032322017002000726312023011717496606328";
                consultaEstado.cdc = v_cdc;
                consultaEstado.ruc = 80003232;
                consultaEstado.dv = "2";
                consultaResp = cliente.consulta(consultaEstado);
                int canResu = int.Parse(consultaResp.cantidadResultados.ToString());
                if (canResu == 1)
                {
                    v_est2 = consultaResp.documento[0].estado;
                }
                else
                {
                    v_est2 = consultaResp.documento[canResu - 1].estado;
                }

                string estadoNC = null;
                if (v_est2.Equals("RECHAZADO") || v_est2.Equals("RECHAZADO_REINGRESADO") || v_est2.Equals("RECHAZADO_INUTILIZADO"))
                {
                    msjError2 = consultaResp.documento[canResu - 1].documentoError[0].mensaje.ToString();
                    estadoNC = "RECHAZADO";

                }
                else
                {
                    msjError2 = "";
                    estadoNC = v_est2;
                }
                //actualizamos el estado del documento
                SAPbobsCOM.Recordset oAct;
                oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAct.DoQuery("UPDATE ORIN SET \"U_ESTADO\"='" + estadoNC + "',\"U_MensajeError\"='" + msjError2 + "' WHERE \"DocNum\"='" + oDatosDocNC.Fields.Item(0).Value.ToString() + "' ");
                //buscamos si existe o no el documento en la tabla de auditoria
                SAPbobsCOM.Recordset oAuditoria;
                oAuditoria = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAuditoria.DoQuery("SELECT * FROM \"INF_HOLDING\".\"DOC_ELECTRONICO\" T0 INNER JOIN ORIN T1 ON T0.\"CDC\"=T1.\"U_CDC\" WHERE T1.\"DocNum\"='" + oDatosDocNC.Fields.Item(0).Value.ToString() + "' AND T0.\"TIPO_DOCUMENTO\"='5'  ");
                string pp = oDatosDocNC.Fields.Item(0).Value.ToString();
                int contDoc = oAuditoria.RecordCount;
                if (contDoc > 0)
                {
                    //realizamos un UPDATE
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET  \"ESTADO\"='" + estadoNC + "' WHERE \"NRO_DOCUMENTO\"='" + oDatosDocNC.Fields.Item(0).Value.ToString() + "' AND \"TIPO_DOCUMENTO\"='5' ");
                }
                else
                {
                    //buscamos los datos del documento
                    SAPbobsCOM.Recordset pDatosDoc;
                    pDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    string queryDoc = "SELECT T2.\"TaxIdNum\",'5',T0.\"U_ID\",T0.\"CardCode\",T1.\"LicTradNum\",T0.\"U_CDC\",T0.\"DocNum\",T0.\"DocDate\",T0.\"DocTotal\",T0.\"U_ESTADO\",t0.\"U_MensajeError\",T1.\"E_Mail\",T1.\"Cellular\",'N' FROM ORIN T0 " +
                                      "INNER JOIN OCRD T1 ON T0.\"CardCode\"=t1.\"CardCode\" " +
                                      "LEFT JOIN OADM T2 ON T2.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "WHERE T0.\"DocNum\"='" + oDatosDocNC.Fields.Item(0).Value.ToString() + "' ";
                    pDatosDoc.DoQuery(queryDoc);
                    string fecha = pDatosDoc.Fields.Item(7).Value.ToString();
                    string ll = pDatosDoc.Fields.Item(2).Value.ToString();
                    //realizamos un INSERT
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("INSERT INTO \"INF_HOLDING\".\"DOC_ELECTRONICO\" (\"RUC_EMISOR\",\"TIPO_DOCUMENTO\",\"ID_DOC\",\"CLIENTE_CODIGO\",\"RUC_CLIENTE\",\"CDC\",\"NRO_DOCUMENTO\",\"FECHA\",\"TOTAL_DOCUMENTO\",\"ESTADO\",\"MENSAJE_ERROR\",\"CORREO_CLIENTE\",\"CELULAR_CLIENTE\",\"ESTADO_ENVIO\")" +
                                          " VALUES ('" + pDatosDoc.Fields.Item(0).Value.ToString() + "','" + pDatosDoc.Fields.Item(1).Value.ToString() + "','" + pDatosDoc.Fields.Item(2).Value.ToString() + "','" + pDatosDoc.Fields.Item(3).Value.ToString() + "','" + pDatosDoc.Fields.Item(4).Value.ToString() + "','" + pDatosDoc.Fields.Item(5).Value.ToString() + "','" + pDatosDoc.Fields.Item(6).Value.ToString() + "','" + fecha + "','" + pDatosDoc.Fields.Item(8).Value.ToString() + "','" + pDatosDoc.Fields.Item(9).Value.ToString() + "','" + pDatosDoc.Fields.Item(10).Value.ToString() + "','" + pDatosDoc.Fields.Item(11).Value.ToString() + "','" + pDatosDoc.Fields.Item(12).Value.ToString() + "','" + pDatosDoc.Fields.Item(13).Value.ToString() + "') ");
                }

                oDatosDocNC.MoveNext();
            }

            //Traslado
            string query3 = "SELECT T0.\"DocNum\",T0.\"U_CDC\" " +
                           "FROM OWTR T0 " +
                           "WHERE  \"U_TIMB\"='" + tim + "'  AND  ( \"U_ESTADO\"='RECHAZADO'  or \"U_ESTADO\"='PROCESADO' or \"U_ESTADO\"='PENDIENTE')  ORDER BY 1 ASC";
            SAPbobsCOM.Recordset oDatosDocTras;
            oDatosDocTras = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDocTras.DoQuery(query3);
            int cantdatosT = oDatosDocTras.RecordCount;
            string v_est3 = null;
            while (!oDatosDocTras.EoF)
            {
                //consumimos el servicio para saber el estado del documento
                string msjError3 = null;
                v_cdc[0] = oDatosDocTras.Fields.Item(1).Value.ToString();//"01800032322017002000726312023011717496606328";
                consultaEstado.cdc = v_cdc;
                consultaEstado.ruc = 80003232;
                consultaEstado.dv = "2";
                consultaResp = cliente.consulta(consultaEstado);
                int canResu = int.Parse(consultaResp.cantidadResultados.ToString());
                if (canResu == 1)
                {
                    v_est3 = consultaResp.documento[0].estado;
                }
                else
                {
                    v_est3 = consultaResp.documento[canResu - 1].estado;
                }
                string estadoTras = null;
                if (v_est3.Equals("RECHAZADO") || v_est3.Equals("RECHAZADO_REINGRESADO") || v_est3.Equals("RECHAZADO_INUTILIZADO"))
                {
                    msjError3 = consultaResp.documento[canResu - 1].documentoError[0].mensaje.ToString();
                    estadoTras = "RECHAZADO";
                }
                else
                {
                    estadoTras = v_est3;
                    msjError3 = "";
                }

                SAPbobsCOM.Recordset oAct;
                oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAct.DoQuery("UPDATE OWTR SET \"U_ESTADO\"='" + estadoTras + "',\"U_MensajeError\"='" + msjError3 + "' WHERE \"DocNum\"='" + oDatosDocTras.Fields.Item(0).Value.ToString() + "' ");
                //buscamos si existe o no el documento en la tabla de auditoria
                SAPbobsCOM.Recordset oAuditoria;
                oAuditoria = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAuditoria.DoQuery("SELECT * FROM \"INF_HOLDING\".\"DOC_ELECTRONICO\" T0 INNER JOIN OWTR T1 ON T0.\"CDC\"=T1.\"U_CDC\" WHERE T1.\"DocNum\"='" + oDatosDocTras.Fields.Item(0).Value.ToString() + "' AND T0.\"TIPO_DOCUMENTO\"='7'  ");
                int contDoc = oAuditoria.RecordCount;
                if (contDoc > 0)
                {
                    //realizamos un UPDATE
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET  \"ESTADO\"='" + estadoTras + "' WHERE \"NRO_DOCUMENTO\"='" + oDatosDocTras.Fields.Item(0).Value.ToString() + "' AND \"TIPO_DOCUMENTO\"='7' ");
                }
                else
                {
                    //buscamos los datos del documento
                    SAPbobsCOM.Recordset pDatosDoc;
                    pDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    string queryDoc = "SELECT T2.\"TaxIdNum\",'7',T0.\"U_ID\",T0.\"CardCode\",T1.\"LicTradNum\",T0.\"U_CDC\",T0.\"DocNum\",T0.\"DocDate\",T0.\"DocTotal\",T0.\"U_ESTADO\",t0.\"U_MensajeError\",T1.\"E_Mail\",T1.\"Cellular\",'N' FROM OWTR T0 " +
                                      "INNER JOIN OCRD T1 ON T0.\"CardCode\"=t1.\"CardCode\" " +
                                      "LEFT JOIN OADM T2 ON T2.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "WHERE T0.\"DocNum\"='" + oDatosDocTras.Fields.Item(0).Value.ToString() + "' ";
                    pDatosDoc.DoQuery(queryDoc);
                    string fecha = pDatosDoc.Fields.Item(7).Value.ToString();
                    //realizamos un INSERT
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("INSERT INTO \"INF_HOLDING\".\"DOC_ELECTRONICO\" (\"RUC_EMISOR\",\"TIPO_DOCUMENTO\",\"ID_DOC\",\"CLIENTE_CODIGO\",\"RUC_CLIENTE\",\"CDC\",\"NRO_DOCUMENTO\",\"FECHA\",\"TOTAL_DOCUMENTO\",\"ESTADO\",\"MENSAJE_ERROR\",\"CORREO_CLIENTE\",\"CELULAR_CLIENTE\",\"ESTADO_ENVIO\")" +
                                          " VALUES ('" + pDatosDoc.Fields.Item(0).Value.ToString() + "','" + pDatosDoc.Fields.Item(1).Value.ToString() + "','" + pDatosDoc.Fields.Item(2).Value.ToString() + "','" + pDatosDoc.Fields.Item(3).Value.ToString() + "','" + pDatosDoc.Fields.Item(4).Value.ToString() + "','" + pDatosDoc.Fields.Item(5).Value.ToString() + "','" + pDatosDoc.Fields.Item(6).Value.ToString() + "','" + fecha + "','" + pDatosDoc.Fields.Item(8).Value.ToString() + "','" + pDatosDoc.Fields.Item(9).Value.ToString() + "','" + pDatosDoc.Fields.Item(10).Value.ToString() + "','" + pDatosDoc.Fields.Item(11).Value.ToString() + "','" + pDatosDoc.Fields.Item(12).Value.ToString() + "','" + pDatosDoc.Fields.Item(13).Value.ToString() + "') ");
                }

                oDatosDocTras.MoveNext();
            }

            //ENTREGA
            string query4 = "SELECT T0.\"DocNum\",T0.\"U_CDC\" " +
                           "FROM ODLN T0 " +
                           "WHERE  \"U_TIMB\"='" + tim + "'  AND  ( \"U_ESTADO\"='RECHAZADO'  or \"U_ESTADO\"='PROCESADO' or \"U_ESTADO\"='PENDIENTE')  ORDER BY 1 ASC";
            SAPbobsCOM.Recordset oDatosDocEnt;
            oDatosDocEnt = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDocEnt.DoQuery(query4);
            int cantdatosEnt = oDatosDocEnt.RecordCount;
            string v_est4 = null;
            while (!oDatosDocEnt.EoF)
            {
                //consumimos el servicio para saber el estado del documento
                string msjError4 = null;
                v_cdc[0] = oDatosDocEnt.Fields.Item(1).Value.ToString();//"01800032322017002000726312023011717496606328";
                consultaEstado.cdc = v_cdc;
                consultaEstado.ruc = 80003232;
                consultaEstado.dv = "2";
                consultaResp = cliente.consulta(consultaEstado);
                int canResu = int.Parse(consultaResp.cantidadResultados.ToString());
                if (canResu == 1)
                {
                    v_est4 = consultaResp.documento[0].estado;
                }
                else
                {
                    v_est4 = consultaResp.documento[canResu - 1].estado;
                }
                string estadoEnt = null;
                if (v_est4.Equals("RECHAZADO") || v_est4.Equals("RECHAZADO_REINGRESADO") || v_est4.Equals("RECHAZADO_INUTILIZADO"))
                {
                    msjError4 = consultaResp.documento[canResu - 1].documentoError[0].mensaje.ToString();
                    estadoEnt = "RECHAZADO";
                }
                else
                {
                    estadoEnt = v_est4;
                    msjError4 = "";
                }

                SAPbobsCOM.Recordset oAct;
                oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAct.DoQuery("UPDATE ODLN SET \"U_ESTADO\"='" + estadoEnt + "',\"U_MensajeError\"='" + msjError4 + "' WHERE \"DocNum\"='" + oDatosDocEnt.Fields.Item(0).Value.ToString() + "' ");
                //buscamos si existe o no el documento en la tabla de auditoria
                SAPbobsCOM.Recordset oAuditoria;
                oAuditoria = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAuditoria.DoQuery("SELECT * FROM \"INF_HOLDING\".\"DOC_ELECTRONICO\" T0 INNER JOIN ODLN T1 ON T0.\"CDC\"=T1.\"U_CDC\" WHERE T1.\"DocNum\"='" + oDatosDocEnt.Fields.Item(0).Value.ToString() + "'AND T0.\"TIPO_DOCUMENTO\"='7'  ");
                int contDoc = oAuditoria.RecordCount;
                if (contDoc > 0)
                {
                    //realizamos un UPDATE
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET  \"ESTADO\"='" + estadoEnt + "' WHERE \"NRO_DOCUMENTO\"='" + oDatosDocEnt.Fields.Item(0).Value.ToString() + "' AND \"TIPO_DOCUMENTO\"='7' ");
                }
                else
                {
                    //buscamos los datos del documento
                    SAPbobsCOM.Recordset pDatosDoc;
                    pDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    string queryDoc = "SELECT T2.\"TaxIdNum\",'7',T0.\"U_ID\",T0.\"CardCode\",T1.\"LicTradNum\",T0.\"U_CDC\",T0.\"DocNum\",T0.\"DocDate\",T0.\"DocTotal\",T0.\"U_ESTADO\",t0.\"U_MensajeError\",T1.\"E_Mail\",T1.\"Cellular\",'N' FROM ODLN T0 " +
                                      "INNER JOIN OCRD T1 ON T0.\"CardCode\"=t1.\"CardCode\" " +
                                      "LEFT JOIN OADM T2 ON T2.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "WHERE T0.\"DocNum\"='" + oDatosDocEnt.Fields.Item(0).Value.ToString() + "' ";
                    pDatosDoc.DoQuery(queryDoc);
                    string fecha = pDatosDoc.Fields.Item(7).Value.ToString();
                    //realizamos un INSERT
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("INSERT INTO \"INF_HOLDING\".\"DOC_ELECTRONICO\" (\"RUC_EMISOR\",\"TIPO_DOCUMENTO\",\"ID_DOC\",\"CLIENTE_CODIGO\",\"RUC_CLIENTE\",\"CDC\",\"NRO_DOCUMENTO\",\"FECHA\",\"TOTAL_DOCUMENTO\",\"ESTADO\",\"MENSAJE_ERROR\",\"CORREO_CLIENTE\",\"CELULAR_CLIENTE\",\"ESTADO_ENVIO\")" +
                                          " VALUES ('" + pDatosDoc.Fields.Item(0).Value.ToString() + "','" + pDatosDoc.Fields.Item(1).Value.ToString() + "','" + pDatosDoc.Fields.Item(2).Value.ToString() + "','" + pDatosDoc.Fields.Item(3).Value.ToString() + "','" + pDatosDoc.Fields.Item(4).Value.ToString() + "','" + pDatosDoc.Fields.Item(5).Value.ToString() + "','" + pDatosDoc.Fields.Item(6).Value.ToString() + "','" + fecha + "','" + pDatosDoc.Fields.Item(8).Value.ToString() + "','" + pDatosDoc.Fields.Item(9).Value.ToString() + "','" + pDatosDoc.Fields.Item(10).Value.ToString() + "','" + pDatosDoc.Fields.Item(11).Value.ToString() + "','" + pDatosDoc.Fields.Item(12).Value.ToString() + "','" + pDatosDoc.Fields.Item(13).Value.ToString() + "') ");
                }

                oDatosDocEnt.MoveNext();
            }

            Cursor.Current = Cursors.Default;
            SBO_Application.StatusBar.SetText("Documentos actualizados!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
        }

        //funcion para exportar a excel
        private static void ExportarExcel(SAPbouiCOM.Form oForm)
        {
            Microsoft.Office.Interop.Excel.Application aplicacion;
            Microsoft.Office.Interop.Excel.Workbook libro;
            Microsoft.Office.Interop.Excel.Worksheet hoja;
            Microsoft.Office.Interop.Excel.Worksheet hoja2;
            Microsoft.Office.Interop.Excel.Range rango;
            object misvalue = System.Reflection.Missing.Value;
            SAPbouiCOM.Grid grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;

            try
            {
                //configuramos los elementos para el excel
                aplicacion = new Microsoft.Office.Interop.Excel.Application();
                aplicacion.Visible = false;
                libro = (Microsoft.Office.Interop.Excel.Workbook)(aplicacion.Workbooks.Add(""));
                hoja = (Microsoft.Office.Interop.Excel.Worksheet)libro.ActiveSheet;
                //agregamos los titulos al excel
                hoja.Cells[1, 1] = "FECHA";
                hoja.Cells[1, 2] = "TIPO DOCUMENTO";
                hoja.Cells[1, 3] = "# INTERNO";
                hoja.Cells[1, 4] = "RUC";
                hoja.Cells[1, 5] = "RAZON SOCIAL";
                hoja.Cells[1, 6] = "# DOCUMENTO";
                hoja.Cells[1, 7] = "CDC";
                hoja.Cells[1, 8] = "CORREO ELECTRONICO";
                hoja.Cells[1, 9] = "COBRO";
                hoja.Cells[1, 10] = "ESTADO";
                hoja.Cells[1, 11] = "MENSJAE DE ERROR";
                hoja.Cells[1, 12] = "CORREO ENVIADO";
                hoja.Cells[1, 13] = "ESTADO ENVIO";
                //ponemos en negrita los titulos
                hoja.Range["A1", "I1"].Font.Bold = true;

                int fila = 1;
                int filacelda = 2;
                int filamatrix = 0;
                int countgrid = grilla.Rows.Count;
                //recorremos la grilla
                while (fila <= countgrid)
                {
                    hoja.Cells[filacelda, 1] = grilla.DataTable.GetValue(0, filamatrix);
                    hoja.Cells[filacelda, 2] = grilla.DataTable.GetValue(1, filamatrix);
                    hoja.Cells[filacelda, 3] = grilla.DataTable.GetValue(2, filamatrix);
                    hoja.Cells[filacelda, 4] = grilla.DataTable.GetValue(3, filamatrix);
                    hoja.Cells[filacelda, 5] = grilla.DataTable.GetValue(4, filamatrix);
                    hoja.Cells[filacelda, 6] = grilla.DataTable.GetValue(5, filamatrix);
                    hoja.Cells[filacelda, 7] = grilla.DataTable.GetValue(6, filamatrix);
                    hoja.Cells[filacelda, 8] = grilla.DataTable.GetValue(7, filamatrix);
                    hoja.Cells[filacelda, 9] = grilla.DataTable.GetValue(8, filamatrix);
                    hoja.Cells[filacelda, 10] = grilla.DataTable.GetValue(9, filamatrix);
                    hoja.Cells[filacelda, 11] = grilla.DataTable.GetValue(10, filamatrix);
                    hoja.Cells[filacelda, 12] = grilla.DataTable.GetValue(11, filamatrix);
                    hoja.Cells[filacelda, 13] = grilla.DataTable.GetValue(12, filamatrix);

                    filacelda = filacelda + 1;
                    filamatrix = filamatrix + 1;
                    fila = fila + 1;
                }
                //creamos una carpeta en el escritorio para guardar el excel
                string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                string CarpEscr = path + "\\DescargasExcel-FE";
                if (!Directory.Exists(CarpEscr))
                {
                    Directory.CreateDirectory(CarpEscr);
                }

                aplicacion.Visible = false;
                aplicacion.UserControl = false;
                string archivo = CarpEscr + "\\DocumentosFE_" + DateTime.Now.Hour.ToString("D2") + "" + DateTime.Now.Minute.ToString("D2") + "" + DateTime.Now.Second.ToString("D2") + ".xls";
                libro.SaveAs(archivo);
                libro.Close();
                aplicacion.Quit();
                SAPbouiCOM.Framework.Application.SBO_Application.StatusBar.SetText("Exportado con éxito", SAPbouiCOM.BoMessageTime.bmt_Short, SAPbouiCOM.BoStatusBarMessageType.smt_Success);

            }
            catch (Exception e)
            {

            }

        }

        //funcion para descargar PDF y XML
        private static void descargarPdfXml(SAPbouiCOM.Form oForm)
        {
            SAPbouiCOM.Grid oGrilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
            SAPbouiCOM.ComboBox oCombo = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_8").Specific;
            string v_selecCombo = oCombo.Selected.Value.ToString();
            int GrillaCount = oGrilla.DataTable.Rows.Count;
            string v_tipoDoc = null;
            string v_SubType = null;
            if (v_selecCombo.Equals("1")) { v_tipoDoc = "OINV"; }
            if (v_selecCombo.Equals("2")) { v_tipoDoc = "ORIN"; }
            if (v_selecCombo.Equals("3")) { v_tipoDoc = "ODLN"; }
            if (v_selecCombo.Equals("4")) { v_tipoDoc = "OWTR"; }
            if (v_selecCombo.Equals("5")) { v_tipoDoc = "OINV"; v_SubType = " AND \"DocSubType\"='DN' "; }
            if (v_selecCombo.Equals("6")) { v_tipoDoc = ""; }
            if (v_selecCombo.Equals("7")) { v_tipoDoc = "OINV"; v_SubType = " AND \"DocSubType\"='IX'"; }
            int contador = 0;
            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            string CarpEscr = path + "\\Documentos Electronicos";
            if (!Directory.Exists(CarpEscr))
            {
                Directory.CreateDirectory(CarpEscr);
            }

            while (GrillaCount > contador)
            {
                string valorchk = oGrilla.DataTable.GetValue(13, contador).ToString();
                if (valorchk.Equals("Y"))
                {
                    string v_numInterno = oGrilla.DataTable.GetValue(2, contador).ToString();
                    string v_docu = oGrilla.DataTable.GetValue(6, contador).ToString();
                    SAPbobsCOM.Recordset oDoc;
                    oDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oDoc.DoQuery("select \"U_KUDE\",\"U_XMLFIRMADO\" from " + v_tipoDoc + " where \"DocNum\"=" + v_numInterno + v_SubType);

                    string KUDE = oDoc.Fields.Item(0).Value.ToString();
                    byte[] bytes = Convert.FromBase64String(KUDE);
                    string XML = oDoc.Fields.Item(1).Value.ToString();
                    byte[] bytesxml = Convert.FromBase64String(XML);

                    string v_carpPdf = CarpEscr + "\\" + v_docu + ".pdf";
                    if (!File.Exists(CarpEscr + "\\" + v_docu + ".pdf"))
                    {
                        //guardar el PDF
                        File.Delete(Path.Combine(path + "\\Documentos Electronicos\\" + v_docu + ".pdf"));
                        FileStream obj = File.Create(path + "\\Documentos Electronicos\\" + v_docu + ".pdf");
                        obj.Write(bytes, 0, bytes.Length);
                        obj.Flush();
                        obj.Close();
                        //guardar el XML
                        File.Delete(Path.Combine(path + "\\Documentos Electronicos\\" + v_docu + ".xml"));
                        FileStream obj2 = File.Create(path + "\\Documentos Electronicos\\" + v_docu + ".xml");
                        obj2.Write(bytesxml, 0, bytesxml.Length);
                        obj2.Flush();
                        obj2.Close();
                    }
                    ////guardar el PDF
                    //File.Delete(Path.Combine(path + "\\Documentos Electronicos\\" + v_docu + ".pdf"));
                    //FileStream obj = File.Create(path + "\\Documentos Electronicos\\" + v_docu + ".pdf");
                    //obj.Write(bytes, 0, bytes.Length);
                    //obj.Flush();
                    //obj.Close();
                    ////guardar el XML
                    //File.Delete(Path.Combine(path + "\\Documentos Electronicos\\" + v_docu + ".xml"));
                    //FileStream obj2 = File.Create(path + "\\Documentos Electronicos\\" + v_docu + ".xml");
                    //obj2.Write(bytesxml, 0, bytesxml.Length);
                    //obj2.Flush();
                    //obj2.Close();

                }

                contador++;
            }
            SBO_Application.StatusBar.SetText("Documentos Descargados correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
        }

        //funcion para mandar correo
        private static void enviarcorreo(string mail, string cdc, string doc, string fecha, string moneda, string total, string tipoDoc)
        {
            //ruta de acceso a los documentos
            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            string CarpEscr = path + "\\Documentos Electronicos\\";

            //string correoOrigen = "kokechaparro1992@gmail.com";
            string correoOrigen = "contabilidad@fguarani.com.py";
            string correoDestino = mail; //"kokechaparro1992@gmail.com";
            //string correoDestino =  "payala@fguarani.com.py";
            //string pass = "lkioiccnnlskdorc";
            string pass = "wxvgyhbmlwjqtzkm";
            //string pass = "Guarani@321";
            string cuerpo = "Estimado cliente, \n\n" +
                            "En el presente correo se adjunta el siguiente documento: \n\n" +
                            "- " + tipoDoc + " \n" +
                            "- Número: " + doc + " \n" +
                            "- Fecha de emisión: " + fecha + " \n" +
                            "- Moneda: " + moneda + " \n" +
                            "- Monto: " + total + "\n\n" +
                            "Muchas gracias \n\n" +
                            "Este mensaje y sus anexos pertenecen al Frigorífico Guarani y son de carácter estrictamente confidencial. \n" +
                            "Si usted recibe esta información por error, por favor contacte inmediatamente con el remitente, respondiendo el correo y eliminándolo. No use la información, ni la copie, ni tome " +
                            "acciones basadas en ésta, ni divulgue su contenido a ninguna persona y/o sociedad. El incumplimiento podría constituir responsabilidades penales dispuestas por las Leyes.";

            string v_nombrecompa = "";
            if (oCompany.CompanyName.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                v_nombrecompa = "Frigorífico Guarani";
            }
            else
            {
                v_nombrecompa = "Granusa";
            }
            MailMessage correo = new MailMessage(correoOrigen, correoDestino, v_nombrecompa, "Envío de DE emitido por " + v_nombrecompa);
            System.Net.Mail.Attachment adjunto = new System.Net.Mail.Attachment(CarpEscr + cdc + ".pdf");
            correo.Attachments.Add(adjunto);
            System.Net.Mail.Attachment adjunto2 = new System.Net.Mail.Attachment(CarpEscr + cdc + ".xml");
            correo.Attachments.Add(adjunto2);
            correo.Body = cuerpo;

            //SmtpClient smtp = new SmtpClient("smtp.gmail.com");
            SmtpClient smtp = new SmtpClient("smtp.office365.com");
            smtp.EnableSsl = true;
            System.Net.ServicePointManager.SecurityProtocol |= SecurityProtocolType.Tls11 | SecurityProtocolType.Tls12;

            smtp.UseDefaultCredentials = false;
            smtp.Port = 587;
            smtp.Credentials = new System.Net.NetworkCredential(correoOrigen, pass);

            try
            {
                smtp.Send(correo);
                //actualizamos el estado de correo en hana
                SAPbobsCOM.Recordset oActEstado;
                oActEstado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActEstado.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET \"ESTADO_ENVIO\"='S',\"CORREO_CLIENTE\"='" + mail + "' WHERE \"CDC\"='" + cdc + "' ");

                SBO_Application.StatusBar.SetText("Correo enviado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

            }
            catch (Exception e)
            {

            }

        }

        //funcion para inutilizar documento
        private static void inutilizarDoc(string ruc, string timbrado, string esta, string pemi, string documento, string desde, string hasta, string motivo)
        {
            servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
            servicio.inutilizarNumeracionRequest inutilizar = new servicio.inutilizarNumeracionRequest();
            servicio.inutilizarNumeracionResponse inuresponse = new servicio.inutilizarNumeracionResponse();
            try
            {
                //mandamos los parametros al servicio
                inutilizar.ruc = ruc;
                inutilizar.timbrado = timbrado;
                inutilizar.establecimiento = esta;
                inutilizar.puntoExpedicion = pemi;
                if (documento.Equals("8"))
                {
                    inutilizar.tipoDocumento = "7";
                }
                if (documento.Equals("2"))
                {
                    inutilizar.tipoDocumento = "1";
                }
                else
                {
                    inutilizar.tipoDocumento = documento;
                }

                inutilizar.rangoDesde = desde;
                inutilizar.rangoHasta = hasta;
                inutilizar.motivo = motivo;
                //ejecutamos el servicio
                inuresponse = cliente.inutilizarNumeracion(inutilizar);
                bool resp = inuresponse.ok;
                //string erroresp = inuresponse.mensajeError.ToString();
                if (resp == true)
                {
                    //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                    //evento para cancelar el documento
                    string v_tabla = null;
                    if (documento.Equals("1")) { v_tabla = "OINV"; }
                    if (documento.Equals("2")) { v_tabla = "OINV"; }
                    if (documento.Equals("5")) { v_tabla = "ORIN"; }
                    if (documento.Equals("7")) { v_tabla = "ODLN"; }
                    if (documento.Equals("8")) { v_tabla = "OWTR"; }
                    //if (documento.Equals("7")) { v_tabla = "OWTR"; }
                    //realizamos el query para la busqueda
                    Recordset Doc;
                    Doc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    if (documento.Equals("2"))
                    {
                        Doc.DoQuery("SELECT \"DocEntry\",\"DocNum\",\"FolioNum\" FROM " + v_tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"FolioNum\"='" + desde + "' AND \"U_TIMB\"='" + timbrado + "' AND \"DocSubType\"='IX' ");
                    }
                    else
                    {
                        Doc.DoQuery("SELECT \"DocEntry\",\"DocNum\",\"FolioNum\" FROM " + v_tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"FolioNum\"='" + desde + "' AND \"U_TIMB\"='" + timbrado + "' ");
                    }

                    //comprobamos 
                    while (!Doc.EoF)
                    {
                        string v_folio = Doc.Fields.Item(2).Value.ToString();
                        string v_docentry = Doc.Fields.Item(0).Value.ToString();

                        try
                        {
                            //proceso para factura
                            #region OINV
                            //si es factura
                            if (v_tabla.Equals("OINV"))
                            {
                                //instanciamos el documento
                                SAPbobsCOM.Documents document;
                                SAPbobsCOM.Documents docCancel;
                                document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                                docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                                //validamos que el folio no este vacio
                                if (!string.IsNullOrEmpty(v_folio))
                                {
                                    if (document.GetByKey(int.Parse(v_docentry)))
                                    {
                                        //desfoliamos el documento
                                        string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                                        document.NumAtCard = folioAnu;
                                        document.FolioPrefixString = "";
                                        document.FolioNumber = 0;
                                        document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                                        int desfoliar = document.Update();
                                        string descerror = oCompany.GetLastErrorDescription().ToString();
                                        if (desfoliar != 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                            return;
                                        }
                                        docCancel = document.CreateCancellationDocument();
                                        int cancelado = docCancel.Add();
                                        if (cancelado == 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                        }
                                        else
                                        {
                                            SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                        }
                                    }
                                }
                                else
                                {
                                    docCancel = document.CreateCancellationDocument();
                                    int cancelado = docCancel.Add();
                                    if (cancelado == 0)
                                    {
                                        SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                    }
                                    else
                                    {
                                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    }
                                }
                            }
                            #endregion

                            //proceso para nota de credito
                            #region ORIN
                            //si es nota de credito
                            if (v_tabla.Equals("ORIN"))
                            {
                                //instanciamos el documento
                                SAPbobsCOM.Documents document;
                                SAPbobsCOM.Documents docCancel;
                                document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                                docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                                //validamos que el folio no este vacio
                                if (!string.IsNullOrEmpty(v_folio))
                                {
                                    if (document.GetByKey(int.Parse(v_docentry)))
                                    {
                                        //desfoliamos el documento
                                        string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                                        document.NumAtCard = folioAnu;
                                        document.FolioPrefixString = "";
                                        document.FolioNumber = 0;
                                        document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                                        int desfoliar = document.Update();
                                        string descerror = oCompany.GetLastErrorDescription().ToString();
                                        if (desfoliar != 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                            return;
                                        }
                                        docCancel = document.CreateCancellationDocument();
                                        int cancelado = docCancel.Add();
                                        if (cancelado == 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                        }
                                        else
                                        {
                                            SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                        }
                                    }
                                }
                                else
                                {
                                    docCancel = document.CreateCancellationDocument();
                                    int cancelado = docCancel.Add();
                                    if (cancelado == 0)
                                    {
                                        SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                    }
                                    else
                                    {
                                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    }
                                }
                            }
                            #endregion

                            //proceso para entrega
                            #region ODLN
                            //si es entrega
                            if (v_tabla.Equals("ODLN"))
                            {
                                //instanciamos el documento
                                SAPbobsCOM.Documents document;
                                SAPbobsCOM.Documents docCancel;
                                document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                                docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                                //validamos que el folio no este vacio
                                if (!string.IsNullOrEmpty(v_folio))
                                {
                                    if (document.GetByKey(int.Parse(v_docentry)))
                                    {
                                        //desfoliamos el documento
                                        string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                                        document.NumAtCard = folioAnu;
                                        document.FolioPrefixString = "";
                                        document.FolioNumber = 0;
                                        document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                                        int desfoliar = document.Update();
                                        string descerror = oCompany.GetLastErrorDescription().ToString();
                                        if (desfoliar != 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                            return;
                                        }
                                        docCancel = document.CreateCancellationDocument();
                                        int cancelado = docCancel.Add();
                                        if (cancelado == 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                        }
                                        else
                                        {
                                            SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                        }
                                    }
                                }
                                else
                                {
                                    docCancel = document.CreateCancellationDocument();
                                    int cancelado = docCancel.Add();
                                    if (cancelado == 0)
                                    {
                                        SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                    }
                                    else
                                    {
                                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    }
                                }
                            }
                            #endregion

                            //proceso para traslado
                            #region OWTR
                            //si es traslado
                            if (v_tabla.Equals("OWTR"))
                            {
                                //instanciamos el documento
                                SAPbobsCOM.Documents document;
                                SAPbobsCOM.Documents docCancel;
                                document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                                docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                                //validamos que el folio no este vacio
                                if (!string.IsNullOrEmpty(v_folio))
                                {
                                    if (document.GetByKey(int.Parse(v_docentry)))
                                    {
                                        //desfoliamos el documento
                                        string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                                        document.NumAtCard = folioAnu;
                                        document.FolioPrefixString = "";
                                        document.FolioNumber = 0;
                                        document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                                        int desfoliar = document.Update();
                                        string descerror = oCompany.GetLastErrorDescription().ToString();
                                        if (desfoliar != 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                            return;
                                        }
                                        docCancel = document.CreateCancellationDocument();
                                        int cancelado = docCancel.Add();
                                        if (cancelado == 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                        }
                                        else
                                        {
                                            SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                        }
                                    }
                                }
                                else
                                {
                                    docCancel = document.CreateCancellationDocument();
                                    int cancelado = docCancel.Add();
                                    if (cancelado == 0)
                                    {
                                        SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                    }
                                    else
                                    {
                                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    }
                                }
                            }
                            #endregion
                        }
                        catch (Exception e)
                        {

                        }

                        Doc.MoveNext();
                    }
                }
                else
                {
                    SBO_Application.StatusBar.SetText("Error al inutilizar numeración!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                }
            }
            catch (Exception e)
            {

            }

        }

        //funcion para cargar grilla de objetivos
        private static void cargarGrillaObj(string url, SAPbouiCOM.Form oForm)
        {
            //variables           
            string v_legajo = null, v_codcliente = null, v_metrica = null, v_UM = null, v_kilos = null, v_valor = null, v_periodo = null, v_feInicial = null, v_feFinal = null, v_terri = null, v_canal = null, v_subcanal = null, v_Estado = null, v_tipo = null;
            //instaciamos los servicios de excel
            Microsoft.Office.Interop.Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();
            Microsoft.Office.Interop.Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(url);
            Microsoft.Office.Interop.Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            Microsoft.Office.Interop.Excel.Range xlRange = xlWorksheet.UsedRange;
            xlWorkbook.Activate();
            SAPbouiCOM.Matrix oMatrix;
            oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("0_U_G").Specific;
            SAPbouiCOM.DBDataSource source = oForm.DataSources.DBDataSources.Item("@JOBJETIVOS");
            oMatrix.FlushToDataSource();
            source.Clear();
            SAPbouiCOM.EditText oPeriodo;
            oPeriodo = (SAPbouiCOM.EditText)oForm.Items.Item("20_U_E").Specific;

            int rowCount = xlRange.Rows.Count;
            int columnsCount = xlRange.Columns.Count;
            int colCount = xlRange.Columns.Count;
            int filagrid = 0;
            //validar cantidad de columnas y filas
            if (columnsCount != 14)
            {
                MessageBox.Show("Favor verificar cantidad de columnas!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }
            if (rowCount < 2)
            {
                MessageBox.Show("El excel no posee datos, favor verificar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }
            int cant = 1;


            //recorremos el excel
            for (int i = 2; i <= rowCount; i++)
            {
                try
                {
                    //cargamos las variables del excel
                    v_legajo = xlRange.Cells[i, 1].Value2.ToString();
                    //v_codcliente = xlRange.Cells[i, 2].Value2.ToString();
                    dynamic codCliente = xlRange.Cells[i, 2].Value2;
                    v_metrica = xlRange.Cells[i, 3].Value2.ToString();
                    v_UM = xlRange.Cells[i, 4].Value2.ToString();
                    v_kilos = xlRange.Cells[i, 5].Value2.ToString();
                    v_valor = xlRange.Cells[i, 6].Value2.ToString();
                    double valor_v = double.Parse(v_valor);
                    v_periodo = xlRange.Cells[i, 7].Value2.ToString();
                    v_feInicial = xlRange.Cells[i, 8].Value2.ToString();
                    v_feFinal = xlRange.Cells[i, 9].Value2.ToString();
                    v_terri = xlRange.Cells[i, 10].Value2.ToString();
                    v_canal = xlRange.Cells[i, 11].Value2.ToString();
                    v_subcanal = xlRange.Cells[i, 12].Value2.ToString();
                    v_Estado = xlRange.Cells[i, 13].Value2.ToString();
                    v_tipo = xlRange.Cells[i, 14].Value2.ToString();
                    //mandamos las variables en la grilla
                    source.InsertRecord(source.Size);
                    source.Offset = source.Size - 1;
                    source.SetValue(5, filagrid, v_legajo);
                    if (codCliente != null)
                    {
                        v_codcliente = xlRange.Cells[i, 2].Value2.ToString();
                        source.SetValue(6, filagrid, v_codcliente);
                    }
                    source.SetValue(7, filagrid, v_metrica);
                    source.SetValue(8, filagrid, v_UM);
                    source.SetValue(9, filagrid, v_valor);
                    source.SetValue(10, filagrid, v_periodo);
                    source.SetValue(11, filagrid, v_feInicial);
                    source.SetValue(12, filagrid, v_feFinal);
                    source.SetValue(13, filagrid, v_canal);
                    source.SetValue(14, filagrid, v_Estado);
                    source.SetValue(15, filagrid, v_tipo);
                    source.SetValue(16, filagrid, v_kilos);
                    source.SetValue(17, filagrid, v_subcanal);
                    source.SetValue(18, filagrid, v_terri);
                    oMatrix.LoadFromDataSource();
                    filagrid++;
                    //cant++;
                }
                catch (Exception e)
                {

                }


            }
            xlWorkbook.Close();
            oPeriodo.Value = v_periodo;
            MessageBox.Show("Importado con éxito!!", "Exito", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        //funcion par ainutilizar de forma masiva
        private static void inutilizarMasivo(string urlDirectorio)
        {
            //instaciamos los servicios de excel
            Microsoft.Office.Interop.Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();
            Microsoft.Office.Interop.Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(urlDirectorio);
            Microsoft.Office.Interop.Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            Microsoft.Office.Interop.Excel.Range xlRange = xlWorksheet.UsedRange;
            xlWorkbook.Activate();


            int rowCount = xlRange.Rows.Count;
            int colCount = xlRange.Columns.Count;
            //variables
            string ruc = null;
            string timbrado = null;
            string esta = null;
            string pemi = null;
            string documento = null;
            string desde = null;
            string hasta = null;
            string motivo = null;
            //instaciamos el servicio
            servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
            servicio.inutilizarNumeracionRequest inutilizar = new servicio.inutilizarNumeracionRequest();
            servicio.inutilizarNumeracionResponse inuresponse = new servicio.inutilizarNumeracionResponse();

            //SAPbobsCOM.Documents document;
            //document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
            string v_cardcode = null;
            string v_serie = null;
            string v_fecha = null;
            string v_esta = null;
            string v_pemi = null;
            //string v_folio = null;
            string v_timbrado = null;
            string v_cond = null;
            string v_arti = null;
            string v_cant = null;
            string v_iva = null;
            string v_total = null;
            string v_almacen = null;
            string v_vend = null;
            string v_numero = null;
            string v_aux = "1";
            int linea = 1;
            string v_cdc = null;
            string aux = "1";
            //recorremos el excel          
            for (int i = 1; i <= rowCount; i++)
            {
                try
                {
                     string v_id = xlRange.Cells[i, 1].Value2.ToString();
                    SAPbobsCOM.Recordset oDatosDocAct;
                    oDatosDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oDatosDocAct.DoQuery("SELECT \"FolioNum\" FROM OINV WHERE \"DocNum\"='" + v_id + "' ");
                    string v_fol = oDatosDocAct.Fields.Item(0).Value.ToString();
                    //ReenviarDocumento(v_id, "ORIN", "RIN1", "5", "FACTURA", "Nota de crédito electrónica", v_fol);
                     ReenviarDocumento(v_id, "OINV", "INV1", "1", "FACTURA", "Factura electrónica", v_fol);
                    //ReenviarDocumento(v_docu, "OINV", "INV1", "1", "FACTURA", "Factura electrónica", v_pref);
                    //string v_fol = xlRange.Cells[i, 3].Value2.ToString();
                    ////string v_tim = xlRange.Cells[i, 4].Value2.ToString();
                    //string v_CDC = xlRange.Cells[i, 4].Value2.ToString();
                    //SAPbobsCOM.Recordset oDatosDocAct;
                    //oDatosDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //oDatosDocAct.DoQuery("INSERT INTO \"@CHOF_RUTEO\" (\"Code\",\"Name\",\"DocEntry\",) ");

                    //v_cardcode = xlRange.Cells[i, 2].Value2.ToString();
                    //v_serie = xlRange.Cells[i, 3].Value2.ToString();
                    //v_fecha = xlRange.Cells[i, 4].Value2.ToString() + "-01-" + "2023";
                    //v_esta = xlRange.Cells[i, 5].Value2.ToString();
                    //DateTime fecha_v = Convert.ToDateTime(v_fecha);
                    //string v_FECHA = fecha_v.ToString("dd-MM-yyyy");
                    //v_pemi = xlRange.Cells[i, 6].Value2.ToString();
                    //string v_FFolio = xlRange.Cells[i, 7].Value2.ToString();
                    //v_numero = xlRange.Cells[i, 1].Value2.ToString();
                    //v_cdc = xlRange.Cells[i, 5].Value2.ToString();
                    //v_timbrado = xlRange.Cells[i, 8].Value2.ToString();
                    //v_cond = xlRange.Cells[i, 10].Value2.ToString();
                    //v_arti = xlRange.Cells[i, 11].Value2.ToString();
                    //v_cant = xlRange.Cells[i, 12].Value2.ToString();
                    //v_iva = xlRange.Cells[i, 13].Value2.ToString();
                    //v_total = xlRange.Cells[i, 14].Value2.ToString();
                    //v_almacen = xlRange.Cells[i, 15].Value2.ToString();
                    //v_vend = xlRange.Cells[i, 16].Value2.ToString();


                    //string c = oDatosDoc.Fields.Item(0).Value.ToString();
                    //if (c.Equals("O"))
                    //{
                    //    SAPbobsCOM.Recordset oDatosDocAct;
                    //    oDatosDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //    oDatosDocAct.DoQuery("update OINV set \"FolioPref\"='" + v_esta + "',\"FolioNum\"='" + v_folio + "' where \"DocNum\"='" + v_numero + "'");
                    //}

                    //document.CardCode = v_cardcode;
                    //document.Series = int.Parse(v_serie);
                    //document.DocDate = fecha_v;// DateTime.Parse(v_FECHA);
                    //document.UserFields.Fields.Item("U_ESTA").Value = v_esta;
                    //document.UserFields.Fields.Item("U_PEMI").Value = v_pemi;
                    //document.FolioPrefixString = v_esta;
                    //document.FolioNumber = int.Parse(v_folio);
                    //document.UserFields.Fields.Item("U_TIMB").Value = v_timbrado;
                    //document.PaymentGroupCode = int.Parse(v_cond);
                    //document.SalesPersonCode = int.Parse(v_vend);
                    //document.DocCurrency = "GS";
                    //document.DocType = BoDocumentTypes.dDocument_Items;
                    ////agregamos el detalle
                    //for (int f = 2; f <= rowCount; f++)
                    //{
                    //    //v_arti = xlRange.Cells[f, 11].Value2.ToString();
                    //    //v_cant = xlRange.Cells[f, 12].Value2.ToString();
                    //    //v_iva = xlRange.Cells[f, 13].Value2.ToString();
                    //    //v_total = xlRange.Cells[f, 14].Value2.ToString();
                    //    //v_almacen = xlRange.Cells[f, 15].Value2.ToString();
                    //    //string v_umdetalle = xlRange.Cells[f, 1].Value2.ToString();


                    //    //if (v_numero == v_umdetalle)
                    //    //{
                    //    //    document.Lines.ItemCode = v_arti;
                    //    //    document.Lines.WarehouseCode = v_almacen;
                    //    //    document.Lines.TaxCode = v_iva;
                    //    //    document.Lines.Quantity = int.Parse(v_cant);
                    //    //    document.Lines.Price = double.Parse(v_total) / double.Parse(v_cant);
                    //    //    document.Lines.LineTotal = double.Parse(v_total);
                    //    //    document.Lines.Add();
                    //    //}
                    //    //SAPbobsCOM.Recordset oDatosDoc;
                    //    //oDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //    //oDatosDoc.DoQuery("UPDATE OJDT SET \"RefDate\"='20230928',\"DueDate\"='20230928',\"TaxDate\"='20230928'  where \"TransId\"='"+ v_id + "'");
                    //    //SAPbobsCOM.Recordset oDatosDoc1;
                    //    //oDatosDoc1 = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //    //oDatosDoc1.DoQuery("UPDATE JDT1 SET \"RefDate\"='20230928',\"DueDate\"='20230928',\"TaxDate\"='20230928'  where \"TransId\"='"+ v_id + "'");
                    //}

                    //int error = document.Add();
                    //string oo = oCompany.GetLastErrorDescription().ToString();
                    //if (error != 0)
                    //{
                    //    MessageBox.Show("error :" + v_esta + "-" + v_pemi + "-" + v_folio);
                    //}


                }
                catch (Exception e)
                {

                }

                //try
                //{
                //    //extraemos los valores 
                //    ruc = xlRange.Cells[i, 1].Value2.ToString();
                //    timbrado = xlRange.Cells[i, 2].Value2.ToString();
                //    esta = xlRange.Cells[i, 3].Value2.ToString();
                //    pemi = xlRange.Cells[i, 4].Value2.ToString();
                //    documento = xlRange.Cells[i, 5].Value2.ToString();
                //    desde = xlRange.Cells[i, 6].Value2.ToString();
                //    hasta = xlRange.Cells[i, 7].Value2.ToString();
                //    motivo = xlRange.Cells[i, 8].Value2.ToString();
                //    //mandamos los parametros al servicio
                //    inutilizar.ruc = ruc;
                //    inutilizar.timbrado = timbrado;
                //    inutilizar.establecimiento = esta;
                //    inutilizar.puntoExpedicion = pemi;
                //    if (documento.Equals("8"))
                //    {
                //        inutilizar.tipoDocumento = "7";
                //    }
                //    else
                //    {
                //        inutilizar.tipoDocumento = documento;
                //    }
                //    inutilizar.rangoDesde = desde;
                //    inutilizar.rangoHasta = hasta;
                //    inutilizar.motivo = motivo;
                //    //ejecutamos el servicio
                //    inuresponse = cliente.inutilizarNumeracion(inutilizar);
                //    bool resp = inuresponse.ok;
                //    if (resp == true)
                //    {
                //        //evento para cancelar el documento
                //        string v_tabla = null;
                //        if (documento.Equals("1")) { v_tabla = "OINV"; }
                //        if (documento.Equals("5")) { v_tabla = "ORIN"; }
                //        if (documento.Equals("7")) { v_tabla = "ODLN"; }
                //        if (documento.Equals("8")) { v_tabla = "OWTR"; }
                //        //realizamos el query para la busqueda
                //        Recordset Doc;
                //        Doc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //        Doc.DoQuery("SELECT \"DocEntry\",\"DocNum\",\"FolioNum\" FROM " + v_tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"FolioNum\"='" + desde + "' AND \"U_TIMB\"='" + timbrado + "' ");
                //        //comprobamos 
                //        while (!Doc.EoF)
                //        {
                //            string v_folio = Doc.Fields.Item(2).Value.ToString();
                //            string v_docentry = Doc.Fields.Item(0).Value.ToString();

                //            try
                //            {
                //                //proceso para factura
                //                #region OINV
                //                //si es factura
                //                if (v_tabla.Equals("OINV"))
                //                {
                //                    //instanciamos el documento
                //                    SAPbobsCOM.Documents document;
                //                    SAPbobsCOM.Documents docCancel;
                //                    document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                //                    docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                //                    //validamos que el folio no este vacio
                //                    if (!string.IsNullOrEmpty(v_folio))
                //                    {
                //                        if (document.GetByKey(int.Parse(v_docentry)))
                //                        {
                //                            //desfoliamos el documento
                //                            string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                //                            document.NumAtCard = folioAnu;
                //                            document.FolioPrefixString = "";
                //                            document.FolioNumber = 0;
                //                            document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                //                            int desfoliar = document.Update();
                //                            string descerror = oCompany.GetLastErrorDescription().ToString();
                //                            if (desfoliar != 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                                //return;
                //                            }
                //                            docCancel = document.CreateCancellationDocument();
                //                            int cancelado = docCancel.Add();
                //                            if (cancelado == 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                            }
                //                            else
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                            }
                //                        }
                //                    }
                //                    else
                //                    {
                //                        docCancel = document.CreateCancellationDocument();
                //                        int cancelado = docCancel.Add();
                //                        if (cancelado == 0)
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                        }
                //                        else
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                        }
                //                    }
                //                }
                //                #endregion

                //                //proceso para nota de credito
                //                #region ORIN
                //                //si es nota de credito
                //                if (v_tabla.Equals("ORIN"))
                //                {
                //                    //instanciamos el documento
                //                    SAPbobsCOM.Documents document;
                //                    SAPbobsCOM.Documents docCancel;
                //                    document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                //                    docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                //                    //validamos que el folio no este vacio
                //                    if (!string.IsNullOrEmpty(v_folio))
                //                    {
                //                        if (document.GetByKey(int.Parse(v_docentry)))
                //                        {
                //                            //desfoliamos el documento
                //                            string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                //                            document.NumAtCard = folioAnu;
                //                            document.FolioPrefixString = "";
                //                            document.FolioNumber = 0;
                //                            document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                //                            int desfoliar = document.Update();
                //                            string descerror = oCompany.GetLastErrorDescription().ToString();
                //                            if (desfoliar != 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                                //return;
                //                            }
                //                            docCancel = document.CreateCancellationDocument();
                //                            int cancelado = docCancel.Add();
                //                            if (cancelado == 0)
                //                            {
                //                                // SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                            }
                //                            else
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                            }
                //                        }
                //                    }
                //                    else
                //                    {
                //                        docCancel = document.CreateCancellationDocument();
                //                        int cancelado = docCancel.Add();
                //                        if (cancelado == 0)
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                        }
                //                        else
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                        }
                //                    }
                //                }
                //                #endregion

                //                //proceso para entrega
                //                #region ODLN
                //                //si es entrega
                //                if (v_tabla.Equals("ODLN"))
                //                {
                //                    //instanciamos el documento
                //                    SAPbobsCOM.Documents document;
                //                    SAPbobsCOM.Documents docCancel;
                //                    document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                //                    docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                //                    //validamos que el folio no este vacio
                //                    if (!string.IsNullOrEmpty(v_folio))
                //                    {
                //                        if (document.GetByKey(int.Parse(v_docentry)))
                //                        {
                //                            //desfoliamos el documento
                //                            string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                //                            document.NumAtCard = folioAnu;
                //                            document.FolioPrefixString = "";
                //                            document.FolioNumber = 0;
                //                            document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                //                            int desfoliar = document.Update();
                //                            string descerror = oCompany.GetLastErrorDescription().ToString();
                //                            if (desfoliar != 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                                //return;
                //                            }
                //                            docCancel = document.CreateCancellationDocument();
                //                            int cancelado = docCancel.Add();
                //                            if (cancelado == 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                            }
                //                            else
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                            }
                //                        }
                //                    }
                //                    else
                //                    {
                //                        docCancel = document.CreateCancellationDocument();
                //                        int cancelado = docCancel.Add();
                //                        if (cancelado == 0)
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                        }
                //                        else
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                        }
                //                    }
                //                }
                //                #endregion

                //                //proceso para traslado
                //                #region OWTR
                //                //si es traslado
                //                if (v_tabla.Equals("OWTR"))
                //                {
                //                    //instanciamos el documento
                //                    SAPbobsCOM.Documents document;
                //                    SAPbobsCOM.Documents docCancel;
                //                    document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                //                    docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                //                    //validamos que el folio no este vacio
                //                    if (!string.IsNullOrEmpty(v_folio))
                //                    {
                //                        if (document.GetByKey(int.Parse(v_docentry)))
                //                        {
                //                            //desfoliamos el documento
                //                            string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                //                            document.NumAtCard = folioAnu;
                //                            document.FolioPrefixString = "";
                //                            document.FolioNumber = 0;
                //                            document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                //                            int desfoliar = document.Update();
                //                            string descerror = oCompany.GetLastErrorDescription().ToString();
                //                            if (desfoliar != 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                                // return;
                //                            }
                //                            docCancel = document.CreateCancellationDocument();
                //                            int cancelado = docCancel.Add();
                //                            if (cancelado == 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                            }
                //                            else
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                            }
                //                        }
                //                    }
                //                    else
                //                    {
                //                        docCancel = document.CreateCancellationDocument();
                //                        int cancelado = docCancel.Add();
                //                        if (cancelado == 0)
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                        }
                //                        else
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                        }
                //                    }
                //                }
                //                #endregion
                //            }
                //            catch (Exception e)
                //            {

                //            }

                //            Doc.MoveNext();
                //        }


                //        xlRange.Cells[i, 9].Value2 = "Inutilizado";
                //        xlRange = xlWorksheet.get_Range("I9", "I9");
                //        xlRange = xlWorksheet.Range["I9:I9"];
                //        xlRange.Value = "Inutilizado";
                //        xlWorkbook.SaveAs(urlDirectorio);
                //        xlWorkbook.Close();

                //    }
                //    else
                //    {
                //        MessageBox.Show(esta + "-" + pemi + "-" + desde);

                //        xlRange.Cells[i, 9].Value2 = "Error";
                //    }
                //}
                //catch (Exception e)
                //{

                //}

            }

            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

        }

        //funcion para descargar plantilla excel para inutilizacion
        private static void descargarPlantilla()
        {
            Microsoft.Office.Interop.Excel.Application aplicacion;
            Microsoft.Office.Interop.Excel.Workbook libro;
            Microsoft.Office.Interop.Excel.Worksheet hoja;
            Microsoft.Office.Interop.Excel.Range rango;
            object misvalue = System.Reflection.Missing.Value;
            //configuramos los elementos para el excel
            aplicacion = new Microsoft.Office.Interop.Excel.Application();
            aplicacion.Visible = true;
            libro = (Microsoft.Office.Interop.Excel.Workbook)(aplicacion.Workbooks.Add(""));
            hoja = (Microsoft.Office.Interop.Excel.Worksheet)libro.ActiveSheet;
            //agregar los títulos al excel
            hoja.Cells[1, 1] = "RUC";
            hoja.Cells[1, 2] = "TIMBRADO";
            hoja.Cells[1, 3] = "ESTABLECIMIENTO";
            hoja.Cells[1, 4] = "PUNTO DE EXPEDICION";
            hoja.Cells[1, 5] = "DOCUMENTO";
            hoja.Cells[1, 6] = "DESDE";
            hoja.Cells[1, 7] = "HASTA";
            hoja.Cells[1, 8] = "MOTIVO";
            hoja.Cells[1, 9] = "ESTADO";
            hoja.Range["A1", "I1"].Font.Bold = true;
            hoja.Range["A1", "H1"].Interior.Color = Color.YellowGreen;
            hoja.Range["I1", "I1"].Interior.Color = Color.LightGray;
            aplicacion.Visible = false;
            aplicacion.UserControl = false;
            //creamos una carpeta en el escritorio
            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            string CarpEscr = path + "\\InutilizacionPlantilla";
            if (!Directory.Exists(CarpEscr))
            {
                Directory.CreateDirectory(CarpEscr);
            }
            //guardamos el archivo
            //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            string fecha = DateTime.Now.Hour.ToString("D2") + "" + DateTime.Now.Minute.ToString("D2") + "" + DateTime.Now.Second.ToString("D2");
            string archivo = "\\inutilizacion_" + fecha + ".xls";
            libro.SaveAs(CarpEscr + archivo);
            libro.Close();
            aplicacion.Quit();
            SBO_Application.StatusBar.SetText("Plantilla descargada con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
        }

        //reenviar documento
        private static void ReenviarDocumento(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc, string v_folio)
        {
            try
            {
                BasicHttpBinding httpBinding = new BasicHttpBinding();
                httpBinding.MaxReceivedMessageSize = Int32.MaxValue;
                httpBinding.MaxBufferSize = Int32.MaxValue;

                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                //SAPbobsCOM.Recordset oDocAct;
                //oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              

                #region QUERY DOCUMENTO
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\" " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }
                    else
                    {
                        //GRANUSA
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)   " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T12.\"U_Nombre\"||','||T12.\"U_Apellido\",CASE WHEN T11.\"U_CHAPA_CARRE\" IS NULL THEN  T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END ,T11.\"U_MARCA\",T12.\"U_Documento\",T12.\"U_Direccion\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\" " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN \"@CHOFERES\" T12 ON T12.\"Code\"=T0.\"U_CHOFERES\" " +
                                       //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\" " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }
                    else
                    {
                        //GRANUSA
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T12.\"U_Nombre\"||','||T12.\"U_Apellido\",CASE WHEN T11.\"U_CHAPA_CARRE\" IS NULL THEN  T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T12.\"U_Documento\",T12.\"U_Direccion\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\" " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN \"@CHOFERES\" T12 ON T12.\"Code\"=T0.\"U_CHOFERES\" " +
                                       //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }
                }
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string CodLicitacion = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string infoadicional = oDatos.Fields.Item(53).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                ////actualizamos el folio de la factura
                // Recordset oActFolio;
                // oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActFolio.DoQuery("UPDATE "+ tablacab + " SET \"U_ESTA\"='"+esta+"',\"U_PEMI\"='"+pun+"',\"FolioNum\"='"+folio.ToString()+"',\"U_TIMB\"='"+ timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                string oper = oDatos.Fields.Item(25).Value.ToString();
                if (!string.IsNullOrEmpty(infoadicional))
                {
                    gOpeDE.dInfoEmi = infoadicional;
                }
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                if (v_folio.Equals("") || v_folio.Equals("0"))
                {
                    gTimb.dNumDoc = folio.ToString("D7");
                }
                else
                {
                    gTimb.dNumDoc = v_folio;
                }

                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                if (tablacab.Equals("OINV"))
                {
                    gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                    gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                }                  
                
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                if (oDatos.Fields.Item(26).Value.ToString() == "2")
                {
                    gDatRec.iTiOpe = "2";
                    //gDatRec.iTiContRec = "1";
                }
                else
                {
                    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //validad si el pais esta vacio, enviar PRY por defecto
                string pais = oDatos.Fields.Item(16).Value.ToString();
                if (string.IsNullOrEmpty(pais))
                {
                    gDatRec.cPaisRec = "PRY";
                }
                else
                {
                    gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                }

                //gDatRec.dDesPaisRe = "Paraguay";

                if (tablacab.Equals("ORIN"))
                {
                    gCamNCDE.iMotEmi = "1";//hay que modificar
                }
                //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1" || oDatos.Fields.Item(26).Value.ToString() == "3")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }

                if (tablacab.Equals("OINV"))
                {
                    //REMITO
                    #region REMITO
                    if (!string.IsNullOrEmpty(trans))
                    {
                        string chof = oDatos.Fields.Item(32).Value.ToString();
                        if (!chof.Equals("PERSONAL"))
                        {
                            string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                            if (!string.IsNullOrEmpty(CedChofer))
                            {
                                string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                                string NewDirRec = null;
                                if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    NewDirRec = dirReceptor;

                                }
                                string salDire = oDatos.Fields.Item(37).Value.ToString();
                                string newsalDire = null;
                                if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newsalDire = salDire;

                                }
                                string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                                string newDomFiscal = null;
                                if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDomFiscal = DomFiscal;

                                }
                                string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                                string newDireChofer = null;
                                if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDireChofer = DireChofer;

                                }
                                string codTransp = null;
                                string descTrans = null;
                                if (oDatos.Fields.Item(38).Value.ToString() == varE)
                                {
                                    codTransp = "1";
                                    descTrans = "Propio";
                                }
                                else
                                {
                                    codTransp = "2";
                                    descTrans = "Tercero";
                                }
                                gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gDatRec.dNumCasRec = "0";
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                                //gCamSal               
                                gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                                gCamSal.dNumCasSal = "0";
                                //gCamSal.dComp1Sal =  "aviadores del chaco";
                                gCamSal.cDepSal = sal_dep;
                                gCamSal.cCiuSal = sal_loc;
                                gCamSal.cDisSal = sal_dist;
                                //gCamEnt
                                gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gCamEnt.dNumCasEnt = "0";
                                gCamEnt.cDepEnt = rec_dep;
                                gCamEnt.cCiuEnt = rec_loc;
                                gCamEnt.cDisEnt = rec_dist;
                                gCamEnt1[0] = gCamEnt;
                                gTransp.iTipTrans = codTransp;// "2";
                                gTransp.dDesTipTrans = descTrans;// "Tercero";
                                gTransp.iModTrans = "1";
                                gTransp.iRespFlete = RespFlete;
                                gTransp.dIniTras = fe;
                                gTransp.dIniTrasSpecified = true;
                                gTransp.dFinTras = fe;
                                gTransp.dFinTrasSpecified = true;
                                //gVehTras
                                //gTransp.gVehTras = gVehTras1;
                                gVehTras1[0] = gVehTras;
                                gVehTras.dTiVehTras = "Terrestre";
                                gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                                gVehTras.dTipIdenVeh = "2";
                                gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                                //gCamTrans
                                gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                                gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                                //deconstruimos el RUC del transportista
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                string rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                string dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                                gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                                gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                                gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                                gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                                gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                                gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                                   //gCamNRE
                                                                   //gCamNRE.iMotEmiNR = "1";
                                                                   //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                                   //gCamNRE.iRespEmiNR = "1";
                                                                   //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                                gCamNRE.dKmR = "3";
                                //gDtipDE.gCamNRE = gCamNRE;
                                gTransp.gCamTrans = gCamTrans;
                                gTransp.gCamSal = gCamSal;
                                gTransp.gCamEnt = gCamEnt1;
                                gTransp.gVehTras = gVehTras1;
                                gDtipDE.gTransp = gTransp;
                            }

                        }


                    }
                    #endregion
                }

                //LICITACION
                #region LICITACION
                if (oDatos.Fields.Item(25).Value.ToString() == "3")
                {
                    Recordset oLicitacion;
                    oLicitacion = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oLicitacion.DoQuery("SELECT \"U_dModCont\",\"U_dEntCont\",\"U_dAnoCont\",\"U_dSecCont\",\"U_dFeCodCont\" FROM \"@LICITACION\" WHERE \"U_LICI\"='" + CodLicitacion + "'");

                    gCompPub.dModCont = oLicitacion.Fields.Item(0).Value.ToString();//"LP";
                    gCompPub.dEntCont = oLicitacion.Fields.Item(1).Value.ToString(); //"12009";
                    gCompPub.dAnoCont = oLicitacion.Fields.Item(2).Value.ToString(); //"22";
                    int sec = int.Parse(oLicitacion.Fields.Item(3).Value.ToString());
                    gCompPub.dSecCont = sec.ToString("D7");// oLicitacion.Fields.Item(3).Value.ToString(); //"218529";
                    DateTime v_fechaLic = DateTime.Parse(oLicitacion.Fields.Item(4).Value.ToString());
                    string fechalic_v = v_fechaLic.ToString("yyyy-MM-dd");
                    gCompPub.dFeCodCont = DateTime.Parse(fechalic_v);//DateTime.Parse("2022-08-31");
                    gCompPub.dFeCodContSpecified = true;
                    gCamFE.gCompPub = gCompPub;
                    //gDtipDE.gCamFE = gCamFE;
                }
                #endregion



                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //convertimos a INT la cantidad de decimales
                int v_CanDecimal = int.Parse(v_DecimalFG);
                while (!oDatos.EoF)
                {
                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        string pp = oDatos.Fields.Item(14).Value.ToString();
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem.dDescItem = 0;
                        //gValorRestaItem.dDescItemSpecified = true;
                        //string deci = "1,2";
                        //gValorRestaItem.dPorcDesIt = decimal.Parse(deci);
                        //gValorRestaItem.dPorcDesItSpecified = true;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                    //gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    //gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem2.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem2.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem2.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                    //gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    //gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem3.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem3.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem3.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem4.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem4.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem4.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem5.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem5.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem5.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA5.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA5.iAfecIVA = "3";
                            gCamIVA5.dBasGravIVA = 0;
                            gCamIVA5.dLiqIVAItem = 0;
                        }
                        gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem5.gValorRestaItem = gValorRestaItem5;
                        gCamItem5.gValorItem = gValorItem5;
                        gCamItem5.gCamIVA = gCamIVA5;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem6.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem6.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem6.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA6.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA6.iAfecIVA = "3";
                            gCamIVA6.dBasGravIVA = 0;
                            gCamIVA6.dLiqIVAItem = 0;
                        }
                        gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem6.gValorRestaItem = gValorRestaItem6;
                        gCamItem6.gValorItem = gValorItem6;
                        gCamItem6.gCamIVA = gCamIVA6;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem7.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem7.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem7.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA7.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA7.iAfecIVA = "3";
                            gCamIVA7.dBasGravIVA = 0;
                            gCamIVA7.dLiqIVAItem = 0;
                        }
                        gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem7.gValorRestaItem = gValorRestaItem7;
                        gCamItem7.gValorItem = gValorItem7;
                        gCamItem7.gCamIVA = gCamIVA7;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem8.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem8.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem8.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA8.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA8.iAfecIVA = "3";
                            gCamIVA8.dBasGravIVA = 0;
                            gCamIVA8.dLiqIVAItem = 0;
                        }
                        gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem8.gValorRestaItem = gValorRestaItem8;
                        gCamItem8.gValorItem = gValorItem8;
                        gCamItem8.gCamIVA = gCamIVA8;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem9.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem9.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem9.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA9.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA9.iAfecIVA = "3";
                            gCamIVA9.dBasGravIVA = 0;
                            gCamIVA9.dLiqIVAItem = 0;
                        }
                        gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem9.gValorRestaItem = gValorRestaItem9;
                        gCamItem9.gValorItem = gValorItem9;
                        gCamItem9.gCamIVA = gCamIVA9;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem10.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem10.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem10.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA10.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA10.iAfecIVA = "3";
                            gCamIVA10.dBasGravIVA = 0;
                            gCamIVA10.dLiqIVAItem = 0;
                        }
                        gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem10.gValorRestaItem = gValorRestaItem10;
                        gCamItem10.gValorItem = gValorItem10;
                        gCamItem10.gCamIVA = gCamIVA10;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem11.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem11.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem11.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA11.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA11.iAfecIVA = "3";
                            gCamIVA11.dBasGravIVA = 0;
                            gCamIVA11.dLiqIVAItem = 0;
                        }
                        gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem11.gValorRestaItem = gValorRestaItem11;
                        gCamItem11.gValorItem = gValorItem11;
                        gCamItem11.gCamIVA = gCamIVA11;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem12.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem12.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem12.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA12.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA12.iAfecIVA = "3";
                            gCamIVA12.dBasGravIVA = 0;
                            gCamIVA12.dLiqIVAItem = 0;
                        }
                        gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem12.gValorRestaItem = gValorRestaItem12;
                        gCamItem12.gValorItem = gValorItem12;
                        gCamItem12.gCamIVA = gCamIVA12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem13.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem13.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem13.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA13.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA13.iAfecIVA = "3";
                            gCamIVA13.dBasGravIVA = 0;
                            gCamIVA13.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem13.gValorRestaItem = gValorRestaItem13;
                        gCamItem13.gValorItem = gValorItem13;
                        gCamItem13.gCamIVA = gCamIVA13;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem14.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem14.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem14.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA14.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA14.iAfecIVA = "3";
                            gCamIVA14.dBasGravIVA = 0;
                            gCamIVA14.dLiqIVAItem = 0;
                        }
                        gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem14.gValorRestaItem = gValorRestaItem14;
                        gCamItem14.gValorItem = gValorItem14;
                        gCamItem14.gCamIVA = gCamIVA14;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem15.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem15.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem15.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA15.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA15.iAfecIVA = "3";
                            gCamIVA15.dBasGravIVA = 0;
                            gCamIVA15.dLiqIVAItem = 0;
                        }
                        gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem15.gValorRestaItem = gValorRestaItem15;
                        gCamItem15.gValorItem = gValorItem15;
                        gCamItem15.gCamIVA = gCamIVA15;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem16.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem16.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem16.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA16.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA16.iAfecIVA = "3";
                            gCamIVA16.dBasGravIVA = 0;
                            gCamIVA16.dLiqIVAItem = 0;

                        }
                        gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem16.gValorRestaItem = gValorRestaItem16;
                        gCamItem16.gValorItem = gValorItem16;
                        gCamItem16.gCamIVA = gCamIVA16;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem17.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem17.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem17.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA17.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA17.iAfecIVA = "3";
                            gCamIVA17.dBasGravIVA = 0;
                            gCamIVA17.dLiqIVAItem = 0;
                        }
                        gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem17.gValorRestaItem = gValorRestaItem17;
                        gCamItem17.gValorItem = gValorItem17;
                        gCamItem17.gCamIVA = gCamIVA17;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem18.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem18.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem18.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA18.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA18.iAfecIVA = "3";
                            gCamIVA18.dBasGravIVA = 0;
                            gCamIVA18.dLiqIVAItem = 0;
                        }
                        gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem18.gValorRestaItem = gValorRestaItem18;
                        gCamItem18.gValorItem = gValorItem18;
                        gCamItem18.gCamIVA = gCamIVA18;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem19.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem19.dDncpG = dncpNum.ToString("D8");
                        }
                        //gValorItem
                        gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem19.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA19.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA19.iAfecIVA = "3";
                            gCamIVA19.dBasGravIVA = 0;
                            gCamIVA19.dLiqIVAItem = 0;
                        }
                        gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem19.gValorRestaItem = gValorRestaItem19;
                        gCamItem19.gValorItem = gValorItem19;
                        gCamItem19.gCamIVA = gCamIVA19;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem20.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem20.dDncpG = dncpNum.ToString("D8");
                        }

                        //gValorItem
                        gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem20.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA20.iAfecIVA = "3";
                            gCamIVA20.dBasGravIVA = 0;
                            gCamIVA20.dLiqIVAItem = 0;
                        }
                        gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem20.gValorRestaItem = gValorRestaItem20;
                        gCamItem20.gValorItem = gValorItem20;
                        gCamItem20.gCamIVA = gCamIVA20;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem21.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA21.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA21.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA21.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA21.iAfecIVA = "3";
                            gCamIVA21.dBasGravIVA = 0;
                            gCamIVA21.dLiqIVAItem = 0;
                        }
                        gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem21.gValorRestaItem = gValorRestaItem21;
                        gCamItem21.gValorItem = gValorItem21;
                        gCamItem21.gCamIVA = gCamIVA21;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem22.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA22.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA22.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA22.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA22.iAfecIVA = "3";
                            gCamIVA22.dBasGravIVA = 0;
                            gCamIVA22.dLiqIVAItem = 0;
                        }
                        gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem22.gValorRestaItem = gValorRestaItem22;
                        gCamItem22.gValorItem = gValorItem22;
                        gCamItem22.gCamIVA = gCamIVA22;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem23.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA23.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA23.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA23.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA23.iAfecIVA = "3";
                            gCamIVA23.dBasGravIVA = 0;
                            gCamIVA23.dLiqIVAItem = 0;
                        }
                        gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem23.gValorRestaItem = gValorRestaItem23;
                        gCamItem23.gValorItem = gValorItem23;
                        gCamItem23.gCamIVA = gCamIVA23;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem24.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA24.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA24.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA24.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA24.iAfecIVA = "3";
                            gCamIVA24.dBasGravIVA = 0;
                            gCamIVA24.dLiqIVAItem = 0;
                        }
                        gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem24.gValorRestaItem = gValorRestaItem24;
                        gCamItem24.gValorItem = gValorItem24;
                        gCamItem24.gCamIVA = gCamIVA24;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem25.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA25.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA25.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA25.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA25.iAfecIVA = "3";
                            gCamIVA25.dBasGravIVA = 0;
                            gCamIVA25.dLiqIVAItem = 0;
                        }
                        gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem25.gValorRestaItem = gValorRestaItem25;
                        gCamItem25.gValorItem = gValorItem25;
                        gCamItem25.gCamIVA = gCamIVA25;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem26.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA26.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA26.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA26.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA26.iAfecIVA = "3";
                            gCamIVA26.dBasGravIVA = 0;
                            gCamIVA26.dLiqIVAItem = 0;
                        }
                        gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem26.gValorRestaItem = gValorRestaItem26;
                        gCamItem26.gValorItem = gValorItem26;
                        gCamItem26.gCamIVA = gCamIVA26;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem27.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA27.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA27.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA27.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA27.iAfecIVA = "3";
                            gCamIVA27.dBasGravIVA = 0;
                            gCamIVA27.dLiqIVAItem = 0;
                        }
                        gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem27.gValorRestaItem = gValorRestaItem27;
                        gCamItem27.gValorItem = gValorItem27;
                        gCamItem27.gCamIVA = gCamIVA27;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem28.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA28.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA28.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA28.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA28.iAfecIVA = "3";
                            gCamIVA28.dBasGravIVA = 0;
                            gCamIVA28.dLiqIVAItem = 0;
                        }
                        gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem28.gValorRestaItem = gValorRestaItem28;
                        gCamItem28.gValorItem = gValorItem28;
                        gCamItem28.gCamIVA = gCamIVA28;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem29.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA29.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA29.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA29.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA29.iAfecIVA = "3";
                            gCamIVA29.dBasGravIVA = 0;
                            gCamIVA29.dLiqIVAItem = 0;
                        }
                        gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem29.gValorRestaItem = gValorRestaItem29;
                        gCamItem29.gValorItem = gValorItem29;
                        gCamItem29.gCamIVA = gCamIVA29;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem30.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA30.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA30.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA30.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA30.iAfecIVA = "3";
                            gCamIVA30.dBasGravIVA = 0;
                            gCamIVA30.dLiqIVAItem = 0;
                        }
                        gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem30.gValorRestaItem = gValorRestaItem30;
                        gCamItem30.gValorItem = gValorItem30;
                        gCamItem30.gCamIVA = gCamIVA30;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem31.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA31.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA31.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA31.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA31.iAfecIVA = "3";
                            gCamIVA31.dBasGravIVA = 0;
                            gCamIVA31.dLiqIVAItem = 0;
                        }
                        gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem31.gValorRestaItem = gValorRestaItem31;
                        gCamItem31.gValorItem = gValorItem31;
                        gCamItem31.gCamIVA = gCamIVA31;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem32.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA32.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA32.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA32.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA32.iAfecIVA = "3";
                            gCamIVA32.dBasGravIVA = 0;
                            gCamIVA32.dLiqIVAItem = 0;
                        }
                        gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem32.gValorRestaItem = gValorRestaItem32;
                        gCamItem32.gValorItem = gValorItem32;
                        gCamItem32.gCamIVA = gCamIVA32;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem33.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA33.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA33.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA33.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA33.iAfecIVA = "3";
                            gCamIVA33.dBasGravIVA = 0;
                            gCamIVA33.dLiqIVAItem = 0;
                        }
                        gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem33.gValorRestaItem = gValorRestaItem33;
                        gCamItem33.gValorItem = gValorItem33;
                        gCamItem33.gCamIVA = gCamIVA33;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem34.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA34.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA34.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA34.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA34.iAfecIVA = "3";
                            gCamIVA34.dBasGravIVA = 0;
                            gCamIVA34.dLiqIVAItem = 0;
                        }
                        gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem34.gValorRestaItem = gValorRestaItem34;
                        gCamItem34.gValorItem = gValorItem34;
                        gCamItem34.gCamIVA = gCamIVA34;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem35.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA35.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA35.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA35.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA35.iAfecIVA = "3";
                            gCamIVA35.dBasGravIVA = 0;
                            gCamIVA35.dLiqIVAItem = 0;
                        }
                        gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem35.gValorRestaItem = gValorRestaItem35;
                        gCamItem35.gValorItem = gValorItem35;
                        gCamItem35.gCamIVA = gCamIVA35;
                        gCamItem1[f] = gCamItem35;
                    }
                    if (f == 35)
                    {
                        gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem36.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA36.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA36.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA36.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA36.iAfecIVA = "3";
                            gCamIVA36.dBasGravIVA = 0;
                            gCamIVA36.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem36.gValorRestaItem = gValorRestaItem36;
                        gCamItem36.gValorItem = gValorItem36;
                        gCamItem36.gCamIVA = gCamIVA36;
                        gCamItem1[f] = gCamItem36;
                    }
                    if (f == 36)
                    {
                        gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem37.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA37.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA37.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA37.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA37.iAfecIVA = "3";
                            gCamIVA37.dBasGravIVA = 0;
                            gCamIVA37.dLiqIVAItem = 0;
                        }
                        gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem37.gValorRestaItem = gValorRestaItem37;
                        gCamItem37.gValorItem = gValorItem37;
                        gCamItem37.gCamIVA = gCamIVA37;
                        gCamItem1[f] = gCamItem37;
                    }
                    if (f == 37)
                    {
                        gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem38.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA38.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA38.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA38.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA38.iAfecIVA = "3";
                            gCamIVA38.dBasGravIVA = 0;
                            gCamIVA38.dLiqIVAItem = 0;
                        }
                        gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem38.gValorRestaItem = gValorRestaItem38;
                        gCamItem38.gValorItem = gValorItem38;
                        gCamItem38.gCamIVA = gCamIVA38;
                        gCamItem1[f] = gCamItem38;
                    }
                    if (f == 38)
                    {
                        gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem39.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA39.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA39.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA39.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA39.iAfecIVA = "3";
                            gCamIVA39.dBasGravIVA = 0;
                            gCamIVA39.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem39.gValorRestaItem = gValorRestaItem39;
                        gCamItem39.gValorItem = gValorItem39;
                        gCamItem39.gCamIVA = gCamIVA39;
                        gCamItem1[f] = gCamItem39;
                    }
                    if (f == 39)
                    {
                        gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem40.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA40.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA40.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA40.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA40.iAfecIVA = "3";
                            gCamIVA40.dBasGravIVA = 0;
                            gCamIVA40.dLiqIVAItem = 0;
                        }
                        gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem40.gValorRestaItem = gValorRestaItem40;
                        gCamItem40.gValorItem = gValorItem40;
                        gCamItem40.gCamIVA = gCamIVA40;
                        gCamItem1[f] = gCamItem40;
                    }
                    if (f == 40)
                    {
                        gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem41.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA41.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA41.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA41.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA41.iAfecIVA = "3";
                            gCamIVA41.dBasGravIVA = 0;
                            gCamIVA41.dLiqIVAItem = 0;
                        }
                        gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem41.gValorRestaItem = gValorRestaItem41;
                        gCamItem41.gValorItem = gValorItem41;
                        gCamItem41.gCamIVA = gCamIVA41;
                        gCamItem1[f] = gCamItem41;
                    }
                    if (f == 41)
                    {
                        gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem42.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA42.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA42.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA42.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA42.iAfecIVA = "3";
                            gCamIVA42.dBasGravIVA = 0;
                            gCamIVA42.dLiqIVAItem = 0;
                        }
                        gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem42.gValorRestaItem = gValorRestaItem42;
                        gCamItem42.gValorItem = gValorItem42;
                        gCamItem42.gCamIVA = gCamIVA42;
                        gCamItem1[f] = gCamItem42;
                    }
                    if (f == 42)
                    {
                        gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem43.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA43.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA43.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA43.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA43.iAfecIVA = "3";
                            gCamIVA43.dBasGravIVA = 0;
                            gCamIVA43.dLiqIVAItem = 0;
                        }
                        gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem43.gValorRestaItem = gValorRestaItem43;
                        gCamItem43.gValorItem = gValorItem43;
                        gCamItem43.gCamIVA = gCamIVA43;
                        gCamItem1[f] = gCamItem43;
                    }
                    if (f == 43)
                    {
                        gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem44.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA44.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA44.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA44.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA44.iAfecIVA = "3";
                            gCamIVA44.dBasGravIVA = 0;
                            gCamIVA44.dLiqIVAItem = 0;
                        }
                        gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem44.gValorRestaItem = gValorRestaItem44;
                        gCamItem44.gValorItem = gValorItem44;
                        gCamItem44.gCamIVA = gCamIVA44;
                        gCamItem1[f] = gCamItem44;
                    }
                    if (f == 44)
                    {
                        gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem45.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA45.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA45.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA45.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA45.iAfecIVA = "3";
                            gCamIVA45.dBasGravIVA = 0;
                            gCamIVA45.dLiqIVAItem = 0;
                        }
                        gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem45.gValorRestaItem = gValorRestaItem45;
                        gCamItem45.gValorItem = gValorItem45;
                        gCamItem45.gCamIVA = gCamIVA45;
                        gCamItem1[f] = gCamItem45;
                    }
                    #endregion


                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = template;
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }

                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }
                if (tablacab.Equals("ORIN") && electronico.Equals("Si"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T2.\"U_CDC\" FROM ORIN T0 INNER JOIN RIN1 T1 ON T0.\"DocEntry\"=t1.\"DocEntry\" INNER JOIN OINV T2 ON T1.\"BaseEntry\"=t2.\"DocEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (tablacab.Equals("ORIN") && electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    // DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }



                gCamCond.gPaConEIni = gPaConEIni1;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                //gValorItem.gValorRestaItem = gValorRestaItem;
                //gCamItem.gValorItem = gValorItem;
                //gCamItem.gCamIVA = gCamIVA;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    if (v_folio.Equals("") || v_folio.Equals("0"))
                    {
                        //actualizamos el folio de la factura
                        Recordset oActFolio;
                        oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                        //actualizamos el folio del asiento
                        Recordset oActAsiento;
                        oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");

                        //actualizamos la numeracion de la serie           
                        Recordset oActSerie;
                        oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");
                    }

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                if (e.ToString().Contains("System.ServiceModel.EndpointNotFoundException"))
                {
                    MessageBox.Show("Problema de conexión, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("System.indexOutOfRangeException"))
                {
                    MessageBox.Show("Dirección duplicada o ruc inválido, favor revisar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("java.lang.NumberFormatException"))
                {
                    MessageBox.Show("Verificar campos obligatorios, formato incorrecto o vacío!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("org.hibernate.engine.jdbc"))
                {
                    MessageBox.Show("Error en la base de datos, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                else
                {
                    MessageBox.Show(e.ToString());
                }
            }

        }

        //load form numeración
        private static void loadNumeracion(SAPbouiCOM.Form form)
        {
            //cargar columnas en la grilla
            SAPbouiCOM.Grid grilla;
            SAPbouiCOM.Columns columns;
            SAPbouiCOM.ComboBoxColumn col;

            //datos extras export
            SAPbouiCOM.ComboBox oCombo;
            oCombo = (SAPbouiCOM.ComboBox)form.Items.Item("Item_5").Specific;
            oCombo.ValidValues.Add("FT", "Factura");
            oCombo.ValidValues.Add("NC", "Nota de crédito");
            oCombo.ValidValues.Add("RE", "Remision Entrega");
            oCombo.ValidValues.Add("RT", "Remisión Traslado");
            oCombo.ValidValues.Add("EX", "Factura export");
            oCombo.Item.DisplayDesc = true;

        }

        //funcion para actualizar la serie
        private static void actualizarSerie(string v_serie, string v_folio)
        {
            try
            {
                SAPbobsCOM.Recordset oQuery;
                oQuery = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oQuery.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + v_folio + "' WHERE \"SeriesName\"='" + v_serie + "' ");
                SBO_Application.StatusBar.SetText("Documento actualizado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
            }

        }

        //funcion para foliar o desfoliar
        private static void foliarDesfoliar(string v_pref, string v_folio, string v_cdc, string v_docu, string v_interno)
        {
            try
            {
                string v_tabla = null;
                string v_type = null;
                if (v_docu.Equals("FT")) { v_tabla = "OINV"; }
                if (v_docu.Equals("NC")) { v_tabla = "ORIN"; }
                if (v_docu.Equals("RE")) { v_tabla = "ODLN"; }
                if (v_docu.Equals("RT")) { v_tabla = "OWTR"; }
                if (v_docu.Equals("EX")) { v_tabla = "OINV"; v_type = " AND \"DocSubType\"='IX' "; }
                //armamos el query
                string v_consulta = "UPDATE " + v_tabla + " SET \"FolioPref\"='" + v_pref + "', \"FolioNum\"='" + v_folio + "'  ";
                if (!string.IsNullOrEmpty(v_cdc))
                {
                    v_consulta = v_consulta + " ,\"U_CDC\"='" + v_cdc + "' ";
                }
                v_consulta = v_consulta + " WHERE \"DocNum\"='" + v_interno + "' ";
                if (!string.IsNullOrEmpty(v_type))
                {
                    v_consulta = v_consulta + v_type;
                }


                SAPbobsCOM.Recordset oQuery;
                oQuery = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oQuery.DoQuery(v_consulta);
                SBO_Application.StatusBar.SetText("Documento actualizado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
            }

        }

        //reenviar documento export
        private static void reenviarDocumentoExport(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc, string infoExp, string folioReenvio, int cantidadGrilla)
        {
            try
            {
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'  AND T0.\"DocSubType\"='IX' ");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "'  AND \"DocSubType\"='IX' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'  AND \"DocSubType\"='IX' ");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              

                #region QUERY DOCUMENTO
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                }
                //DETALLE
                SAPbobsCOM.Recordset oDetalleExp;
                oDetalleExp = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDetalleExp.DoQuery("SELECT \"U_U_ItemCode\",\"U_U_Dscription\",\"U_U_cantidad\",\"U_U_TotalLine\" FROM \"@EXPORT\" WHERE \"U_U_DocEntry\"='" + codigo + "'");
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string InfoAdicional = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string InfoExport = oDatos.Fields.Item(53).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //actualizamos el folio de la factura
                //Recordset oActFolio;
                //oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion
                //string lplp = "Intermediary (56 A) PNBPUS3NNYC Wells Fargo Bank NA New York, USA ABA 026005092 Account with Inst. (57 A) UBBRPYPX Banco Itaú Paraguay S.A. Asunción, Paraguay (59) Beneficiary account Nr. 0.5.001281/7 - CAJAS: 1.428 - PESO NETO: 24.619,00 – PESO BRUTO: 25.361,00 - CPT: 118.417,39 - FLETE: 5.300,00 - FCA: 113.117,39 - PLACAS: BNC469 / AAJZ 945 - PRECINTOS: SENACSA 722594 - SENACSA 722595 - PALLETS: 28";
                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                gOpeDE.dInfoFisc = infoExp;
                gOpeDE.dInfoEmi = infoExp;
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                if (string.IsNullOrEmpty(folioReenvio))
                {
                    gTimb.dNumDoc = folio.ToString("D7");
                }
                else
                {
                    gTimb.dNumDoc = folioReenvio;
                }

                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";

                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                //if (oDatos.Fields.Item(26).Value.ToString() == "2")
                //{
                //    gDatRec.iTiOpe = "4";
                //    //gDatRec.iTiContRec = "1";
                //}
                //else
                //{
                //    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                //    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //}
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();
                gDatRec.dNumCasRec = "0";
                //gDatRec.dDesPaisRe = "Paraguay";
                if (oDatos.Fields.Item(16).Value.ToString() == "PRY")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }


                //}


                //REMITO
                #region REMITO
                if (!string.IsNullOrEmpty(trans))
                {
                    string chof = oDatos.Fields.Item(32).Value.ToString();
                    if (!chof.Equals("PERSONAL"))
                    {
                        string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                        if (!string.IsNullOrEmpty(CedChofer))
                        {
                            string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                            string NewDirRec = null;
                            if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                NewDirRec = dirReceptor;

                            }
                            string salDire = oDatos.Fields.Item(37).Value.ToString();
                            string newsalDire = null;
                            if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newsalDire = salDire;

                            }
                            string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                            string newDomFiscal = null;
                            if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newDomFiscal = DomFiscal;

                            }
                            string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                            string newDireChofer = null;
                            if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newDireChofer = DireChofer;

                            }
                            string codTransp = null;
                            string descTrans = null;
                            if (oDatos.Fields.Item(38).Value.ToString() == varE)
                            {
                                codTransp = "1";
                                descTrans = "Propio";
                            }
                            else
                            {
                                codTransp = "2";
                                descTrans = "Tercero";
                            }
                            gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                            gDatRec.dNumCasRec = "0";
                            if (oDatos.Fields.Item(25).Value.ToString() != "4")
                            {
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                            }
                            //gCamSal               
                            gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                            gCamSal.dNumCasSal = "0";
                            //gCamSal.dComp1Sal =  "aviadores del chaco";
                            gCamSal.cDepSal = sal_dep;
                            gCamSal.cCiuSal = sal_loc;
                            gCamSal.cDisSal = sal_dist;
                            //gCamEnt
                            gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                            gCamEnt.dNumCasEnt = "0";
                            gCamEnt.cDepEnt = rec_dep;
                            gCamEnt.cCiuEnt = rec_loc;
                            gCamEnt.cDisEnt = rec_dist;
                            gCamEnt1[0] = gCamEnt;
                            gTransp.iTipTrans = codTransp;// "2";
                            gTransp.dDesTipTrans = descTrans;// "Tercero";
                            gTransp.iModTrans = "1";
                            gTransp.iRespFlete = RespFlete;
                            gTransp.dIniTras = fe;
                            gTransp.dIniTrasSpecified = true;
                            gTransp.dFinTras = fe;
                            gTransp.dFinTrasSpecified = true;
                            //gVehTras
                            //gTransp.gVehTras = gVehTras1;
                            gVehTras1[0] = gVehTras;
                            gVehTras.dTiVehTras = "Terrestre";
                            gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                            gVehTras.dTipIdenVeh = "2";
                            gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                            //gCamTrans
                            gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                            gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                            //deconstruimos el RUC del transportista
                            string rucCam = null;
                            string dvCam = null;
                            if (oDatos.Fields.Item(40).Value.ToString() == "1")
                            {
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                            }

                            string paisTrans = oDatos.Fields.Item(43).Value.ToString();
                            if (paisTrans.Equals("PRY"))
                            {
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                            }
                            else
                            {
                                gCamTrans.dNumIDTrans = oDatos.Fields.Item(38).Value.ToString();
                                gCamTrans.iTipIDTrans = "3";
                                gCamTrans.dDTipIDTrans = "Cédula extranjera";
                            }
                            gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                            gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                            gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                            gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                            gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                            gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                               //gCamNRE
                                                               //gCamNRE.iMotEmiNR = "1";
                                                               //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                               //gCamNRE.iRespEmiNR = "1";
                                                               //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                            gCamNRE.dKmR = "3";
                            //gDtipDE.gCamNRE = gCamNRE;
                            gTransp.gCamTrans = gCamTrans;
                            gTransp.gCamSal = gCamSal;
                            gTransp.gCamEnt = gCamEnt1;
                            gTransp.gVehTras = gVehTras1;
                            gDtipDE.gTransp = gTransp;
                        }

                    }


                }
                #endregion

                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //detalle export
                string codItem = null;
                string descr = null;
                string cant = null;
                string totallinea = null;
                //validad cual detalle mandar
                int v_canDecimal = int.Parse(v_DecimalFG);
                if (cantidadGrilla > 0)
                {
                    while (!oDetalleExp.EoF)
                    {
                        codItem = oDetalleExp.Fields.Item(0).Value.ToString();
                        descr = oDetalleExp.Fields.Item(1).Value.ToString();
                        cant = oDetalleExp.Fields.Item(2).Value.ToString().Replace(".", ",");
                        totallinea = oDetalleExp.Fields.Item(3).Value.ToString().Replace(".", ",");

                        #region DETALLE EXPORT

                        if (f == 0)
                        {
                            gCamItem.dCodInt = codItem;
                            gCamItem.dDesProSer = descr;
                            gCamItem.dCantProSer = decimal.Parse(cant);
                            gValorItem.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA.iAfecIVA = "1";
                                gCamIVA.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA.iAfecIVA = "3";
                                gCamIVA.dBasGravIVA = 0;
                                gCamIVA.dLiqIVAItem = 0;
                            }
                            gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem.gValorRestaItem = gValorRestaItem;
                            gCamItem.gValorItem = gValorItem;
                            gCamItem.gCamIVA = gCamIVA;
                            gCamItem1[f] = gCamItem;
                        }
                        if (f == 1)
                        {
                            gCamItem2.dCodInt = codItem;
                            gCamItem2.dDesProSer = descr;
                            gCamItem2.dCantProSer = decimal.Parse(cant);
                            gValorItem2.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem2.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem2.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem2.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA2.iAfecIVA = "1";
                                gCamIVA2.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA2.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA2.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA2.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA2.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA2.iAfecIVA = "3";
                                gCamIVA2.dBasGravIVA = 0;
                                gCamIVA2.dLiqIVAItem = 0;
                            }
                            gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem2.gValorRestaItem = gValorRestaItem2;
                            gCamItem2.gValorItem = gValorItem2;
                            gCamItem2.gCamIVA = gCamIVA2;
                            gCamItem1[f] = gCamItem2;
                        }
                        if (f == 2)
                        {
                            gCamItem3.dCodInt = codItem;
                            gCamItem3.dDesProSer = descr;
                            gCamItem3.dCantProSer = decimal.Parse(cant);
                            gValorItem3.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem3.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem3.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem3.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA3.iAfecIVA = "1";
                                gCamIVA3.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA3.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA3.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA3.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA3.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA3.iAfecIVA = "3";
                                gCamIVA3.dBasGravIVA = 0;
                                gCamIVA3.dLiqIVAItem = 0;
                            }
                            gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem3.gValorRestaItem = gValorRestaItem3;
                            gCamItem3.gValorItem = gValorItem3;
                            gCamItem3.gCamIVA = gCamIVA3;
                            gCamItem1[f] = gCamItem3;
                        }
                        if (f == 3)
                        {
                            gCamItem4.dCodInt = codItem;
                            gCamItem4.dDesProSer = descr;
                            gCamItem4.dCantProSer = decimal.Parse(cant);
                            gValorItem4.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem4.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem4.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem4.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA4.iAfecIVA = "1";
                                gCamIVA4.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA4.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA4.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA4.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA4.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA4.iAfecIVA = "3";
                                gCamIVA4.dBasGravIVA = 0;
                                gCamIVA4.dLiqIVAItem = 0;
                            }
                            gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem4.gValorRestaItem = gValorRestaItem4;
                            gCamItem4.gValorItem = gValorItem4;
                            gCamItem4.gCamIVA = gCamIVA4;
                            gCamItem1[f] = gCamItem4;
                        }
                        if (f == 4)
                        {
                            gCamItem5.dCodInt = codItem;
                            gCamItem5.dDesProSer = descr;
                            gCamItem5.dCantProSer = decimal.Parse(cant);
                            gValorItem5.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), v_canDecimal);
                            gValorItem5.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem5.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem5.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA5.iAfecIVA = "1";
                                gCamIVA5.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA5.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA5.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA5.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA5.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA5.iAfecIVA = "3";
                                gCamIVA5.dBasGravIVA = 0;
                                gCamIVA5.dLiqIVAItem = 0;
                            }
                            gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem5.gValorRestaItem = gValorRestaItem5;
                            gCamItem5.gValorItem = gValorItem5;
                            gCamItem5.gCamIVA = gCamIVA5;
                            gCamItem1[f] = gCamItem5;
                        }
                        if (f == 5)
                        {
                            gCamItem6.dCodInt = codItem;
                            gCamItem6.dDesProSer = descr;
                            gCamItem6.dCantProSer = decimal.Parse(cant);
                            gValorItem6.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                            gValorItem6.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem6.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem6.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA6.iAfecIVA = "1";
                                gCamIVA6.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA6.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), v_canDecimal);
                                        gCamIVA6.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), v_canDecimal);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA6.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), v_canDecimal);
                                        gCamIVA6.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), v_canDecimal);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA6.iAfecIVA = "3";
                                gCamIVA6.dBasGravIVA = 0;
                                gCamIVA6.dLiqIVAItem = 0;
                            }
                            gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem6.gValorRestaItem = gValorRestaItem6;
                            gCamItem6.gValorItem = gValorItem6;
                            gCamItem6.gCamIVA = gCamIVA6;
                            gCamItem1[f] = gCamItem6;
                        }

                        #endregion
                        f++;
                        oDetalleExp.MoveNext();
                        if (false == oCompany.InTransaction)
                        {
                            oCompany.StartTransaction();
                        }
                    }
                }
                else
                {
                    while (!oDatos.EoF)
                    {
                        if (!oDatos.Fields.Item(11).Value.ToString().Equals("I0000059") && !oDatos.Fields.Item(11).Value.ToString().Equals("I0000060") && !oDatos.Fields.Item(11).Value.ToString().Equals("I0000061"))
                        {
                            #region DETALLE DOCUMENTO
                            if (f == 0)
                            {
                                gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;                       

                                //gValorItem
                                string pp = oDatos.Fields.Item(14).Value.ToString();
                                gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA.iAfecIVA = "1";
                                    gCamIVA.dPropIVA = 100;
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA.iAfecIVA = "3";
                                    gCamIVA.dBasGravIVA = 0;
                                    gCamIVA.dLiqIVAItem = 0;
                                }
                                gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem.gValorRestaItem = gValorRestaItem;
                                gCamItem.gValorItem = gValorItem;
                                gCamItem.gCamIVA = gCamIVA;
                                gCamItem1[f] = gCamItem;
                            }
                            if (f == 1)
                            {
                                gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem2.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA2.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA2.iAfecIVA = "3";
                                    gCamIVA2.dBasGravIVA = 0;
                                    gCamIVA2.dLiqIVAItem = 0;
                                }
                                gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem2.gValorRestaItem = gValorRestaItem2;
                                gCamItem2.gValorItem = gValorItem2;
                                gCamItem2.gCamIVA = gCamIVA2;
                                gCamItem1[f] = gCamItem2;
                            }
                            if (f == 2)
                            {
                                gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem3.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA3.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA3.iAfecIVA = "3";
                                    gCamIVA3.dBasGravIVA = 0;
                                    gCamIVA3.dLiqIVAItem = 0;
                                }
                                gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem3.gValorRestaItem = gValorRestaItem3;
                                gCamItem3.gValorItem = gValorItem3;
                                gCamItem3.gCamIVA = gCamIVA3;
                                gCamItem1[f] = gCamItem3;
                            }
                            if (f == 3)
                            {
                                gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem4.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA4.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA4.iAfecIVA = "3";
                                    gCamIVA4.dBasGravIVA = 0;
                                    gCamIVA4.dLiqIVAItem = 0;
                                }
                                gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem4.gValorRestaItem = gValorRestaItem4;
                                gCamItem4.gValorItem = gValorItem4;
                                gCamItem4.gCamIVA = gCamIVA4;
                                gCamItem1[f] = gCamItem4;
                            }
                            if (f == 4)
                            {
                                gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem5.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA5.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA5.iAfecIVA = "3";
                                    gCamIVA5.dBasGravIVA = 0;
                                    gCamIVA5.dLiqIVAItem = 0;
                                }
                                gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem5.gValorRestaItem = gValorRestaItem5;
                                gCamItem5.gValorItem = gValorItem5;
                                gCamItem5.gCamIVA = gCamIVA5;
                                gCamItem1[f] = gCamItem5;
                            }
                            if (f == 5)
                            {
                                gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem6.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA6.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA6.iAfecIVA = "3";
                                    gCamIVA6.dBasGravIVA = 0;
                                    gCamIVA6.dLiqIVAItem = 0;
                                }
                                gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem6.gValorRestaItem = gValorRestaItem6;
                                gCamItem6.gValorItem = gValorItem6;
                                gCamItem6.gCamIVA = gCamIVA6;
                                gCamItem1[f] = gCamItem6;
                            }
                            if (f == 6)
                            {
                                gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem7.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA7.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA7.iAfecIVA = "3";
                                    gCamIVA7.dBasGravIVA = 0;
                                    gCamIVA7.dLiqIVAItem = 0;
                                }
                                gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem7.gValorRestaItem = gValorRestaItem7;
                                gCamItem7.gValorItem = gValorItem7;
                                gCamItem7.gCamIVA = gCamIVA7;
                                gCamItem1[f] = gCamItem7;
                            }
                            if (f == 7)
                            {
                                gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem8.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA8.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA8.iAfecIVA = "3";
                                    gCamIVA8.dBasGravIVA = 0;
                                    gCamIVA8.dLiqIVAItem = 0;
                                }
                                gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem8.gValorRestaItem = gValorRestaItem8;
                                gCamItem8.gValorItem = gValorItem8;
                                gCamItem8.gCamIVA = gCamIVA8;
                                gCamItem1[f] = gCamItem8;
                            }
                            if (f == 8)
                            {
                                gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem9.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA9.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA9.iAfecIVA = "3";
                                    gCamIVA9.dBasGravIVA = 0;
                                    gCamIVA9.dLiqIVAItem = 0;
                                }
                                gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem9.gValorRestaItem = gValorRestaItem9;
                                gCamItem9.gValorItem = gValorItem9;
                                gCamItem9.gCamIVA = gCamIVA9;
                                gCamItem1[f] = gCamItem9;
                            }
                            if (f == 9)
                            {
                                gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem10.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA10.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA10.iAfecIVA = "3";
                                    gCamIVA10.dBasGravIVA = 0;
                                    gCamIVA10.dLiqIVAItem = 0;
                                }
                                gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem10.gValorRestaItem = gValorRestaItem10;
                                gCamItem10.gValorItem = gValorItem10;
                                gCamItem10.gCamIVA = gCamIVA10;
                                gCamItem1[f] = gCamItem10;
                            }
                            if (f == 10)
                            {
                                gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem11.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA11.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA11.iAfecIVA = "3";
                                    gCamIVA11.dBasGravIVA = 0;
                                    gCamIVA11.dLiqIVAItem = 0;
                                }
                                gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem11.gValorRestaItem = gValorRestaItem11;
                                gCamItem11.gValorItem = gValorItem11;
                                gCamItem11.gCamIVA = gCamIVA11;
                                gCamItem1[f] = gCamItem11;
                            }
                            if (f == 11)
                            {
                                gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem12.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA12.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA12.iAfecIVA = "3";
                                    gCamIVA12.dBasGravIVA = 0;
                                    gCamIVA12.dLiqIVAItem = 0;
                                }
                                gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem12.gValorRestaItem = gValorRestaItem12;
                                gCamItem12.gValorItem = gValorItem12;
                                gCamItem12.gCamIVA = gCamIVA12;
                                gCamItem1[f] = gCamItem12;
                            }
                            if (f == 12)
                            {
                                gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem13.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA13.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA13.iAfecIVA = "3";
                                    gCamIVA13.dBasGravIVA = 0;
                                    gCamIVA13.dLiqIVAItem = 0;
                                }
                                gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem13.gValorRestaItem = gValorRestaItem13;
                                gCamItem13.gValorItem = gValorItem13;
                                gCamItem13.gCamIVA = gCamIVA13;
                                gCamItem1[f] = gCamItem13;
                            }
                            if (f == 13)
                            {
                                gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem14.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA14.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA14.iAfecIVA = "3";
                                    gCamIVA14.dBasGravIVA = 0;
                                    gCamIVA14.dLiqIVAItem = 0;
                                }
                                gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem14.gValorRestaItem = gValorRestaItem14;
                                gCamItem14.gValorItem = gValorItem14;
                                gCamItem14.gCamIVA = gCamIVA14;
                                gCamItem1[f] = gCamItem14;
                            }
                            if (f == 14)
                            {
                                gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem15.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA15.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA15.iAfecIVA = "3";
                                    gCamIVA15.dBasGravIVA = 0;
                                    gCamIVA15.dLiqIVAItem = 0;
                                }
                                gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem15.gValorRestaItem = gValorRestaItem15;
                                gCamItem15.gValorItem = gValorItem15;
                                gCamItem15.gCamIVA = gCamIVA15;
                                gCamItem1[f] = gCamItem15;
                            }
                            if (f == 15)
                            {
                                gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem16.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA16.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA16.iAfecIVA = "3";
                                    gCamIVA16.dBasGravIVA = 0;
                                    gCamIVA16.dLiqIVAItem = 0;
                                }
                                gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem16.gValorRestaItem = gValorRestaItem16;
                                gCamItem16.gValorItem = gValorItem16;
                                gCamItem16.gCamIVA = gCamIVA16;
                                gCamItem1[f] = gCamItem16;
                            }
                            if (f == 16)
                            {
                                gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem17.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA17.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA17.iAfecIVA = "3";
                                    gCamIVA17.dBasGravIVA = 0;
                                    gCamIVA17.dLiqIVAItem = 0;
                                }
                                gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem17.gValorRestaItem = gValorRestaItem17;
                                gCamItem17.gValorItem = gValorItem17;
                                gCamItem17.gCamIVA = gCamIVA17;
                                gCamItem1[f] = gCamItem17;
                            }
                            if (f == 17)
                            {
                                gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem18.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA18.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA18.iAfecIVA = "3";
                                    gCamIVA18.dBasGravIVA = 0;
                                    gCamIVA18.dLiqIVAItem = 0;
                                }
                                gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem18.gValorRestaItem = gValorRestaItem18;
                                gCamItem18.gValorItem = gValorItem18;
                                gCamItem18.gCamIVA = gCamIVA18;
                                gCamItem1[f] = gCamItem18;
                            }
                            if (f == 18)
                            {
                                gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem19.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA19.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA19.iAfecIVA = "3";
                                    gCamIVA19.dBasGravIVA = 0;
                                    gCamIVA19.dLiqIVAItem = 0;
                                }
                                gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem19.gValorRestaItem = gValorRestaItem19;
                                gCamItem19.gValorItem = gValorItem19;
                                gCamItem19.gCamIVA = gCamIVA19;
                                gCamItem1[f] = gCamItem19;
                            }
                            if (f == 19)
                            {
                                gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem20.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA20.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA20.iAfecIVA = "3";
                                    gCamIVA20.dBasGravIVA = 0;
                                    gCamIVA20.dLiqIVAItem = 0;
                                }
                                gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem20.gValorRestaItem = gValorRestaItem20;
                                gCamItem20.gValorItem = gValorItem20;
                                gCamItem20.gCamIVA = gCamIVA20;
                                gCamItem1[f] = gCamItem20;
                            }
                            if (f == 20)
                            {
                                gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem21.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA21.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA21.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA21.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA21.iAfecIVA = "3";
                                    gCamIVA21.dBasGravIVA = 0;
                                    gCamIVA21.dLiqIVAItem = 0;
                                }
                                gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem21.gValorRestaItem = gValorRestaItem21;
                                gCamItem21.gValorItem = gValorItem21;
                                gCamItem21.gCamIVA = gCamIVA21;
                                gCamItem1[f] = gCamItem21;
                            }
                            if (f == 21)
                            {
                                gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem22.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA22.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA22.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA22.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA22.iAfecIVA = "3";
                                    gCamIVA22.dBasGravIVA = 0;
                                    gCamIVA22.dLiqIVAItem = 0;
                                }
                                gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem22.gValorRestaItem = gValorRestaItem22;
                                gCamItem22.gValorItem = gValorItem22;
                                gCamItem22.gCamIVA = gCamIVA22;
                                gCamItem1[f] = gCamItem22;
                            }
                            if (f == 22)
                            {
                                gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem23.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA23.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA23.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA23.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA23.iAfecIVA = "3";
                                    gCamIVA23.dBasGravIVA = 0;
                                    gCamIVA23.dLiqIVAItem = 0;
                                }
                                gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem23.gValorRestaItem = gValorRestaItem23;
                                gCamItem23.gValorItem = gValorItem23;
                                gCamItem23.gCamIVA = gCamIVA23;
                                gCamItem1[f] = gCamItem23;
                            }
                            if (f == 23)
                            {
                                gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem24.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA24.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA24.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA24.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA24.iAfecIVA = "3";
                                    gCamIVA24.dBasGravIVA = 0;
                                    gCamIVA24.dLiqIVAItem = 0;
                                }
                                gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem24.gValorRestaItem = gValorRestaItem24;
                                gCamItem24.gValorItem = gValorItem24;
                                gCamItem24.gCamIVA = gCamIVA24;
                                gCamItem1[f] = gCamItem24;
                            }
                            if (f == 24)
                            {
                                gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem25.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA25.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA25.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA25.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA25.iAfecIVA = "3";
                                    gCamIVA25.dBasGravIVA = 0;
                                    gCamIVA25.dLiqIVAItem = 0;
                                }
                                gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem25.gValorRestaItem = gValorRestaItem25;
                                gCamItem25.gValorItem = gValorItem25;
                                gCamItem25.gCamIVA = gCamIVA25;
                                gCamItem1[f] = gCamItem25;
                            }
                            if (f == 25)
                            {
                                gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem26.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA26.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA26.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA26.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA26.iAfecIVA = "3";
                                    gCamIVA26.dBasGravIVA = 0;
                                    gCamIVA26.dLiqIVAItem = 0;
                                }
                                gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem26.gValorRestaItem = gValorRestaItem26;
                                gCamItem26.gValorItem = gValorItem26;
                                gCamItem26.gCamIVA = gCamIVA26;
                                gCamItem1[f] = gCamItem26;
                            }
                            if (f == 26)
                            {
                                gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem27.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA27.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA27.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA27.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA27.iAfecIVA = "3";
                                    gCamIVA27.dBasGravIVA = 0;
                                    gCamIVA27.dLiqIVAItem = 0;
                                }
                                gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem27.gValorRestaItem = gValorRestaItem27;
                                gCamItem27.gValorItem = gValorItem27;
                                gCamItem27.gCamIVA = gCamIVA27;
                                gCamItem1[f] = gCamItem27;
                            }
                            if (f == 27)
                            {
                                gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem28.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA28.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA28.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA28.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA28.iAfecIVA = "3";
                                    gCamIVA28.dBasGravIVA = 0;
                                    gCamIVA28.dLiqIVAItem = 0;
                                }
                                gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem28.gValorRestaItem = gValorRestaItem28;
                                gCamItem28.gValorItem = gValorItem28;
                                gCamItem28.gCamIVA = gCamIVA28;
                                gCamItem1[f] = gCamItem28;
                            }
                            if (f == 28)
                            {
                                gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem29.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA29.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA29.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA29.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA29.iAfecIVA = "3";
                                    gCamIVA29.dBasGravIVA = 0;
                                    gCamIVA29.dLiqIVAItem = 0;
                                }
                                gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem29.gValorRestaItem = gValorRestaItem29;
                                gCamItem29.gValorItem = gValorItem29;
                                gCamItem29.gCamIVA = gCamIVA29;
                                gCamItem1[f] = gCamItem29;
                            }
                            if (f == 29)
                            {
                                gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem30.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA30.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA30.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA30.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA30.iAfecIVA = "3";
                                    gCamIVA30.dBasGravIVA = 0;
                                    gCamIVA30.dLiqIVAItem = 0;
                                }
                                gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem30.gValorRestaItem = gValorRestaItem30;
                                gCamItem30.gValorItem = gValorItem30;
                                gCamItem30.gCamIVA = gCamIVA30;
                                gCamItem1[f] = gCamItem30;
                            }
                            if (f == 30)
                            {
                                gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem31.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA31.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA31.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA31.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA31.iAfecIVA = "3";
                                    gCamIVA31.dBasGravIVA = 0;
                                    gCamIVA31.dLiqIVAItem = 0;
                                }
                                gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem31.gValorRestaItem = gValorRestaItem31;
                                gCamItem31.gValorItem = gValorItem31;
                                gCamItem31.gCamIVA = gCamIVA31;
                                gCamItem1[f] = gCamItem31;
                            }
                            if (f == 31)
                            {
                                gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem32.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA32.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA32.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA32.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA32.iAfecIVA = "3";
                                    gCamIVA32.dBasGravIVA = 0;
                                    gCamIVA32.dLiqIVAItem = 0;
                                }
                                gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem32.gValorRestaItem = gValorRestaItem32;
                                gCamItem32.gValorItem = gValorItem32;
                                gCamItem32.gCamIVA = gCamIVA32;
                                gCamItem1[f] = gCamItem32;
                            }
                            if (f == 32)
                            {
                                gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem33.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA33.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA33.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA33.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA33.iAfecIVA = "3";
                                    gCamIVA33.dBasGravIVA = 0;
                                    gCamIVA33.dLiqIVAItem = 0;
                                }
                                gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem33.gValorRestaItem = gValorRestaItem33;
                                gCamItem33.gValorItem = gValorItem33;
                                gCamItem33.gCamIVA = gCamIVA33;
                                gCamItem1[f] = gCamItem33;
                            }
                            if (f == 33)
                            {
                                gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem34.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA34.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA34.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA34.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA34.iAfecIVA = "3";
                                    gCamIVA34.dBasGravIVA = 0;
                                    gCamIVA34.dLiqIVAItem = 0;
                                }
                                gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem34.gValorRestaItem = gValorRestaItem34;
                                gCamItem34.gValorItem = gValorItem34;
                                gCamItem34.gCamIVA = gCamIVA34;
                                gCamItem1[f] = gCamItem34;
                            }
                            if (f == 34)
                            {
                                gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem35.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA35.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA35.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA35.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA35.iAfecIVA = "3";
                                    gCamIVA35.dBasGravIVA = 0;
                                    gCamIVA35.dLiqIVAItem = 0;
                                }
                                gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem35.gValorRestaItem = gValorRestaItem35;
                                gCamItem35.gValorItem = gValorItem35;
                                gCamItem35.gCamIVA = gCamIVA35;
                                gCamItem1[f] = gCamItem35;
                            }
                            if (f == 35)
                            {
                                gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem36.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA36.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA36.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA36.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA36.iAfecIVA = "3";
                                    gCamIVA36.dBasGravIVA = 0;
                                    gCamIVA36.dLiqIVAItem = 0;
                                }
                                gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem36.gValorRestaItem = gValorRestaItem36;
                                gCamItem36.gValorItem = gValorItem36;
                                gCamItem36.gCamIVA = gCamIVA36;
                                gCamItem1[f] = gCamItem36;
                            }
                            if (f == 36)
                            {
                                gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem37.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA37.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA37.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA37.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA37.iAfecIVA = "3";
                                    gCamIVA37.dBasGravIVA = 0;
                                    gCamIVA37.dLiqIVAItem = 0;
                                }
                                gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem37.gValorRestaItem = gValorRestaItem37;
                                gCamItem37.gValorItem = gValorItem37;
                                gCamItem37.gCamIVA = gCamIVA37;
                                gCamItem1[f] = gCamItem37;
                            }
                            if (f == 37)
                            {
                                gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem38.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA38.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA38.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA38.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA38.iAfecIVA = "3";
                                    gCamIVA38.dBasGravIVA = 0;
                                    gCamIVA38.dLiqIVAItem = 0;
                                }
                                gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem38.gValorRestaItem = gValorRestaItem38;
                                gCamItem38.gValorItem = gValorItem38;
                                gCamItem38.gCamIVA = gCamIVA38;
                                gCamItem1[f] = gCamItem38;
                            }
                            if (f == 38)
                            {
                                gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem39.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA39.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA39.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA39.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA39.iAfecIVA = "3";
                                    gCamIVA39.dBasGravIVA = 0;
                                    gCamIVA39.dLiqIVAItem = 0;
                                }
                                gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem39.gValorRestaItem = gValorRestaItem39;
                                gCamItem39.gValorItem = gValorItem39;
                                gCamItem39.gCamIVA = gCamIVA39;
                                gCamItem1[f] = gCamItem39;
                            }
                            if (f == 39)
                            {
                                gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem40.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA40.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA40.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA40.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA40.iAfecIVA = "3";
                                    gCamIVA40.dBasGravIVA = 0;
                                    gCamIVA40.dLiqIVAItem = 0;
                                }
                                gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem40.gValorRestaItem = gValorRestaItem40;
                                gCamItem40.gValorItem = gValorItem40;
                                gCamItem40.gCamIVA = gCamIVA40;
                                gCamItem1[f] = gCamItem40;
                            }
                            if (f == 40)
                            {
                                gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem41.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA41.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA41.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA41.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA41.iAfecIVA = "3";
                                    gCamIVA41.dBasGravIVA = 0;
                                    gCamIVA41.dLiqIVAItem = 0;
                                }
                                gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem41.gValorRestaItem = gValorRestaItem41;
                                gCamItem41.gValorItem = gValorItem41;
                                gCamItem41.gCamIVA = gCamIVA41;
                                gCamItem1[f] = gCamItem41;
                            }
                            if (f == 41)
                            {
                                gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem42.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA42.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA42.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA42.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA42.iAfecIVA = "3";
                                    gCamIVA42.dBasGravIVA = 0;
                                    gCamIVA42.dLiqIVAItem = 0;
                                }
                                gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem42.gValorRestaItem = gValorRestaItem42;
                                gCamItem42.gValorItem = gValorItem42;
                                gCamItem42.gCamIVA = gCamIVA42;
                                gCamItem1[f] = gCamItem42;
                            }
                            if (f == 42)
                            {
                                gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem43.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA43.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA43.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA43.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA43.iAfecIVA = "3";
                                    gCamIVA43.dBasGravIVA = 0;
                                    gCamIVA43.dLiqIVAItem = 0;
                                }
                                gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem43.gValorRestaItem = gValorRestaItem43;
                                gCamItem43.gValorItem = gValorItem43;
                                gCamItem43.gCamIVA = gCamIVA43;
                                gCamItem1[f] = gCamItem43;
                            }
                            if (f == 43)
                            {
                                gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem44.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA44.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA44.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA44.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA44.iAfecIVA = "3";
                                    gCamIVA44.dBasGravIVA = 0;
                                    gCamIVA44.dLiqIVAItem = 0;
                                }
                                gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem44.gValorRestaItem = gValorRestaItem44;
                                gCamItem44.gValorItem = gValorItem44;
                                gCamItem44.gCamIVA = gCamIVA44;
                                gCamItem1[f] = gCamItem44;
                            }
                            if (f == 44)
                            {
                                gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem45.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA45.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_canDecimal);
                                            gCamIVA45.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_canDecimal);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_canDecimal);
                                            gCamIVA45.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_canDecimal);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA45.iAfecIVA = "3";
                                    gCamIVA45.dBasGravIVA = 0;
                                    gCamIVA45.dLiqIVAItem = 0;
                                }
                                gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem45.gValorRestaItem = gValorRestaItem45;
                                gCamItem45.gValorItem = gValorItem45;
                                gCamItem45.gCamIVA = gCamIVA45;
                                gCamItem1[f] = gCamItem45;
                            }
                            #endregion
                        }

                        f++;
                        oDatos.MoveNext();
                        if (false == oCompany.InTransaction)
                        {
                            oCompany.StartTransaction();
                        }
                    }
                }


                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = template;
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }

                gCamCond.gPaConEIni = gPaConEIni1;
                gDtipDE.gCamItem = gCamItem1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "' AND \"DocSubType\"='IX' ");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura si es que esta vacío
                    if (string.IsNullOrEmpty(folioReenvio))
                    {
                        Recordset oActFolio;
                        oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "',\"Printed\"='Y',\"U_Info_Export\"='" + infoExp + "' where \"DocNum\"='" + codigo + "' AND \"DocSubType\"='IX'");
                        //actualizamos el folio del asiento
                        Recordset oActAsiento;
                        oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");
                        //actualizamos la numeracion de la serie           
                        Recordset oActSerie;
                        oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");
                    }



                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                if (e.ToString().Contains("System.ServiceModel.EndpointNotFoundException"))
                {
                    MessageBox.Show("Problema de conexión, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("System.indexOutOfRangeException"))
                {
                    MessageBox.Show("Dirección duplicada o ruc inválido, favor revisar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("java.lang.NumberFormatException"))
                {
                    MessageBox.Show("Verificar campos obligatorios, formato incorrecto o vacío!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("org.hibernate.engine.jdbc"))
                {
                    MessageBox.Show("Error en la base de datos, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                else
                {
                    MessageBox.Show(e.ToString());
                }
            }
        }

        //validaciones para export
        private static void validacionExport(SAPbouiCOM.Form oForm)
        {
            //validaciones de campos para export
            SAPbouiCOM.ComboBox oDirePay = (SAPbouiCOM.ComboBox)oForm.Items.Item("226").Specific;//direccion paycode
            //SAPbouiCOM.ComboBox oDireShip = (SAPbouiCOM.ComboBox)oForm.Items.Item("40").Specific;//direccion shipcode
            SAPbouiCOM.ComboBox oDireShip = (SAPbouiCOM.ComboBox)oForm.Items.Item("40").Specific;//direccion shipcode
            SAPbouiCOM.EditText oCardCode = (SAPbouiCOM.EditText)oForm.Items.Item("4").Specific;//codigo del SN
            SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;//DocNum
            SAPbouiCOM.Button oBtn = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
            string v_direPay = oDirePay.Selected.Value.ToString();
            string v_direShip = oDireShip.Value.ToString();
            string v_cardcode = oCardCode.Value.ToString();
            string v_DocNum = oDocNum.Value.ToString();
            //si las direcciones estan vacías
            if (string.IsNullOrEmpty(v_direPay) && string.IsNullOrEmpty(v_direShip))
            {
                MessageBox.Show("La dirección en la factura no puede quedar vacío!!");
                oBtn.Caption = "Re-enviar";
                return;
            }
            //si hay datos vacíos del SN
            SAPbobsCOM.Recordset querySN;
            querySN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            querySN.DoQuery("SELECT \"IndustryC\",\"U_iNatRec\",\"U_iTipCont\" FROM OCRD WHERE \"CardCode\"='" + v_cardcode + "' ");
            string v_industry = querySN.Fields.Item(0).Value.ToString();
            string v_nat = querySN.Fields.Item(1).Value.ToString();
            string v_cont = querySN.Fields.Item(2).Value.ToString();
            //consulta apara el pais
            if (!string.IsNullOrEmpty(v_direShip))
            {
                SAPbobsCOM.Recordset paisSN;
                paisSN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                paisSN.DoQuery("SELECT \"Country\" FROM CRD1 WHERE \"CardCode\"='" + v_cardcode + "' ");
                string v_pais = paisSN.Fields.Item(0).Value.ToString();
                if (string.IsNullOrEmpty(v_pais))
                {
                    MessageBox.Show("Se debe cargar el país del receptor!!");
                    oBtn.Caption = "Re-enviar";
                    return;
                }
            }
            if (!string.IsNullOrEmpty(v_direPay))
            {
                SAPbobsCOM.Recordset paisSN;
                paisSN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                paisSN.DoQuery("SELECT \"Country\" FROM CRD1 WHERE \"CardCode\"='" + v_cardcode + "' ");
                string v_pais = paisSN.Fields.Item(0).Value.ToString();
                if (string.IsNullOrEmpty(v_pais))
                {
                    MessageBox.Show("Se debe cargar el país del receptor!!");
                    oBtn.Caption = "Re-enviar";
                    return;
                }
            }


            if (string.IsNullOrEmpty(v_industry))
            {
                MessageBox.Show("El tipo de operación del Socio de negocio no puede quedar vacío!!");
                oBtn.Caption = "Re-enviar";
                return;
            }
            else if (string.IsNullOrEmpty(v_nat))
            {
                MessageBox.Show("La naturaleza del receptor no puede quedar vacío!!");
                oBtn.Caption = "Re-enviar";
                return;
            }
            else if (string.IsNullOrEmpty(v_cont))
            {
                MessageBox.Show("El tipo de contribuyente del receptor no puede quedar vacío");
                oBtn.Caption = "Re-enviar";
                return;
            }
            else
            {
                SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "EXPORT", "");
                SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
            }
        }

        //funcion para crear documento SALONES
        private static void CrearDocumentoSalones(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc)
        {
            try
            {
                BasicHttpBinding httpBinding = new BasicHttpBinding();
                httpBinding.MaxReceivedMessageSize = Int32.MaxValue;
                httpBinding.MaxBufferSize = Int32.MaxValue;

                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              
                oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",'sin direccion',CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                      "CASE WHEN T0.\"GroupNum\" IN (18,-1,55,19,10) THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",'Paraguay',T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                      "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",'vacio','vacio','vacio',T13.\"U_SET_FE\", " +
                                      "'vacio','vacio','vacio','vacio','vacio','vacio','vacio',T0.\"NumAtCard\", " +
                                      "'vacio','vacio','vacio' ," +
                                      "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"TransId\" " +
                                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" " +
                                      //"LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='B'" +
                                      //"LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                      //"LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                      //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                      "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                      //"LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                      //"LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                      //"LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                      "WHERE T0.\"DocNum\"='" + codigo + "'");

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string transId = oDatos.Fields.Item(51).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                ////actualizamos el folio de la factura
                // Recordset oActFolio;
                // oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActFolio.DoQuery("UPDATE "+ tablacab + " SET \"U_ESTA\"='"+esta+"',\"U_PEMI\"='"+pun+"',\"FolioNum\"='"+folio.ToString()+"',\"U_TIMB\"='"+ timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                if (oDatos.Fields.Item(26).Value.ToString() == "2")
                {
                    gDatRec.iTiOpe = "2";
                    //gDatRec.iTiContRec = "1";
                }
                else
                {
                    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                gDatRec.cPaisRec = "PRY";// oDatos.Fields.Item(16).Value.ToString();
                //gDatRec.dDesPaisRe = "Paraguay";

                if (tablacab.Equals("ORIN"))
                {
                    gCamNCDE.iMotEmi = "1";//hay que modificar
                }
                //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }



                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                while (!oDatos.EoF)
                {
                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                       //gValorItem
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem2.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA2.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA2.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem3.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA3.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA3.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem4.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA4.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA4.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem5.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA5.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA5.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA5.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA5.iAfecIVA = "3";
                            gCamIVA5.dBasGravIVA = 0;
                            gCamIVA5.dLiqIVAItem = 0;
                        }
                        gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem5.gValorRestaItem = gValorRestaItem5;
                        gCamItem5.gValorItem = gValorItem5;
                        gCamItem5.gCamIVA = gCamIVA5;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem6.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA6.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA6.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA6.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA6.iAfecIVA = "3";
                            gCamIVA6.dBasGravIVA = 0;
                            gCamIVA6.dLiqIVAItem = 0;
                        }
                        gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem6.gValorRestaItem = gValorRestaItem6;
                        gCamItem6.gValorItem = gValorItem6;
                        gCamItem6.gCamIVA = gCamIVA6;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem7.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA7.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA7.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA7.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA7.iAfecIVA = "3";
                            gCamIVA7.dBasGravIVA = 0;
                            gCamIVA7.dLiqIVAItem = 0;
                        }
                        gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem7.gValorRestaItem = gValorRestaItem7;
                        gCamItem7.gValorItem = gValorItem7;
                        gCamItem7.gCamIVA = gCamIVA7;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem8.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA8.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA8.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA8.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA8.iAfecIVA = "3";
                            gCamIVA8.dBasGravIVA = 0;
                            gCamIVA8.dLiqIVAItem = 0;
                        }
                        gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem8.gValorRestaItem = gValorRestaItem8;
                        gCamItem8.gValorItem = gValorItem8;
                        gCamItem8.gCamIVA = gCamIVA8;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem9.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA9.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA9.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA9.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA9.iAfecIVA = "3";
                            gCamIVA9.dBasGravIVA = 0;
                            gCamIVA9.dLiqIVAItem = 0;
                        }
                        gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem9.gValorRestaItem = gValorRestaItem9;
                        gCamItem9.gValorItem = gValorItem9;
                        gCamItem9.gCamIVA = gCamIVA9;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem10.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA10.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA10.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA10.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA10.iAfecIVA = "3";
                            gCamIVA10.dBasGravIVA = 0;
                            gCamIVA10.dLiqIVAItem = 0;
                        }
                        gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem10.gValorRestaItem = gValorRestaItem10;
                        gCamItem10.gValorItem = gValorItem10;
                        gCamItem10.gCamIVA = gCamIVA10;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem11.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA11.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA11.iAfecIVA = "3";
                            gCamIVA11.dBasGravIVA = 0;
                            gCamIVA11.dLiqIVAItem = 0;
                        }
                        gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem11.gValorRestaItem = gValorRestaItem11;
                        gCamItem11.gValorItem = gValorItem11;
                        gCamItem11.gCamIVA = gCamIVA11;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem12.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA12.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA12.iAfecIVA = "3";
                            gCamIVA12.dBasGravIVA = 0;
                            gCamIVA12.dLiqIVAItem = 0;
                        }
                        gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem12.gValorRestaItem = gValorRestaItem12;
                        gCamItem12.gValorItem = gValorItem12;
                        gCamItem12.gCamIVA = gCamIVA12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem13.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA13.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA13.iAfecIVA = "3";
                            gCamIVA13.dBasGravIVA = 0;
                            gCamIVA13.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem13.gValorRestaItem = gValorRestaItem13;
                        gCamItem13.gValorItem = gValorItem13;
                        gCamItem13.gCamIVA = gCamIVA13;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem14.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA14.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA14.iAfecIVA = "3";
                            gCamIVA14.dBasGravIVA = 0;
                            gCamIVA14.dLiqIVAItem = 0;
                        }
                        gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem14.gValorRestaItem = gValorRestaItem14;
                        gCamItem14.gValorItem = gValorItem14;
                        gCamItem14.gCamIVA = gCamIVA14;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem15.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA15.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA15.iAfecIVA = "3";
                            gCamIVA15.dBasGravIVA = 0;
                            gCamIVA15.dLiqIVAItem = 0;
                        }
                        gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem15.gValorRestaItem = gValorRestaItem15;
                        gCamItem15.gValorItem = gValorItem15;
                        gCamItem15.gCamIVA = gCamIVA15;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem16.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA16.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA16.iAfecIVA = "3";
                            gCamIVA16.dBasGravIVA = 0;
                            gCamIVA16.dLiqIVAItem = 0;
                        }
                        gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem16.gValorRestaItem = gValorRestaItem16;
                        gCamItem16.gValorItem = gValorItem16;
                        gCamItem16.gCamIVA = gCamIVA16;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem17.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA17.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA17.iAfecIVA = "3";
                            gCamIVA17.dBasGravIVA = 0;
                            gCamIVA17.dLiqIVAItem = 0;
                        }
                        gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem17.gValorRestaItem = gValorRestaItem17;
                        gCamItem17.gValorItem = gValorItem17;
                        gCamItem17.gCamIVA = gCamIVA17;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem18.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA18.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA18.iAfecIVA = "3";
                            gCamIVA18.dBasGravIVA = 0;
                            gCamIVA18.dLiqIVAItem = 0;
                        }
                        gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem18.gValorRestaItem = gValorRestaItem18;
                        gCamItem18.gValorItem = gValorItem18;
                        gCamItem18.gCamIVA = gCamIVA18;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem19.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA19.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA19.iAfecIVA = "3";
                            gCamIVA19.dBasGravIVA = 0;
                            gCamIVA19.dLiqIVAItem = 0;
                        }
                        gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem19.gValorRestaItem = gValorRestaItem19;
                        gCamItem19.gValorItem = gValorItem19;
                        gCamItem19.gCamIVA = gCamIVA19;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem20.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA20.iAfecIVA = "3";
                            gCamIVA20.dBasGravIVA = 0;
                            gCamIVA20.dLiqIVAItem = 0;
                        }
                        gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem20.gValorRestaItem = gValorRestaItem20;
                        gCamItem20.gValorItem = gValorItem20;
                        gCamItem20.gCamIVA = gCamIVA20;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem21.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA21.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA21.iAfecIVA = "3";
                            gCamIVA21.dBasGravIVA = 0;
                            gCamIVA21.dLiqIVAItem = 0;
                        }
                        gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem21.gValorRestaItem = gValorRestaItem21;
                        gCamItem21.gValorItem = gValorItem21;
                        gCamItem21.gCamIVA = gCamIVA21;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem22.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA22.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA22.iAfecIVA = "3";
                            gCamIVA22.dBasGravIVA = 0;
                            gCamIVA22.dLiqIVAItem = 0;
                        }
                        gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem22.gValorRestaItem = gValorRestaItem22;
                        gCamItem22.gValorItem = gValorItem22;
                        gCamItem22.gCamIVA = gCamIVA22;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem23.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA23.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA23.iAfecIVA = "3";
                            gCamIVA23.dBasGravIVA = 0;
                            gCamIVA23.dLiqIVAItem = 0;
                        }
                        gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem23.gValorRestaItem = gValorRestaItem23;
                        gCamItem23.gValorItem = gValorItem23;
                        gCamItem23.gCamIVA = gCamIVA23;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem24.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA24.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA24.iAfecIVA = "3";
                            gCamIVA24.dBasGravIVA = 0;
                            gCamIVA24.dLiqIVAItem = 0;
                        }
                        gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem24.gValorRestaItem = gValorRestaItem24;
                        gCamItem24.gValorItem = gValorItem24;
                        gCamItem24.gCamIVA = gCamIVA24;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem25.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA25.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA25.iAfecIVA = "3";
                            gCamIVA25.dBasGravIVA = 0;
                            gCamIVA25.dLiqIVAItem = 0;
                        }
                        gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem25.gValorRestaItem = gValorRestaItem25;
                        gCamItem25.gValorItem = gValorItem25;
                        gCamItem25.gCamIVA = gCamIVA25;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem26.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA26.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA26.iAfecIVA = "3";
                            gCamIVA26.dBasGravIVA = 0;
                            gCamIVA26.dLiqIVAItem = 0;
                        }
                        gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem26.gValorRestaItem = gValorRestaItem26;
                        gCamItem26.gValorItem = gValorItem26;
                        gCamItem26.gCamIVA = gCamIVA26;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem27.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA27.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA27.iAfecIVA = "3";
                            gCamIVA27.dBasGravIVA = 0;
                            gCamIVA27.dLiqIVAItem = 0;
                        }
                        gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem27.gValorRestaItem = gValorRestaItem27;
                        gCamItem27.gValorItem = gValorItem27;
                        gCamItem27.gCamIVA = gCamIVA27;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem28.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA28.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA28.iAfecIVA = "3";
                            gCamIVA28.dBasGravIVA = 0;
                            gCamIVA28.dLiqIVAItem = 0;
                        }
                        gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem28.gValorRestaItem = gValorRestaItem28;
                        gCamItem28.gValorItem = gValorItem28;
                        gCamItem28.gCamIVA = gCamIVA28;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem29.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA29.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA29.iAfecIVA = "3";
                            gCamIVA29.dBasGravIVA = 0;
                            gCamIVA29.dLiqIVAItem = 0;
                        }
                        gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem29.gValorRestaItem = gValorRestaItem29;
                        gCamItem29.gValorItem = gValorItem29;
                        gCamItem29.gCamIVA = gCamIVA29;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem30.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA30.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA30.iAfecIVA = "3";
                            gCamIVA30.dBasGravIVA = 0;
                            gCamIVA30.dLiqIVAItem = 0;
                        }
                        gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem30.gValorRestaItem = gValorRestaItem30;
                        gCamItem30.gValorItem = gValorItem30;
                        gCamItem30.gCamIVA = gCamIVA30;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem31.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA31.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA31.iAfecIVA = "3";
                            gCamIVA31.dBasGravIVA = 0;
                            gCamIVA31.dLiqIVAItem = 0;
                        }
                        gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem31.gValorRestaItem = gValorRestaItem31;
                        gCamItem31.gValorItem = gValorItem31;
                        gCamItem31.gCamIVA = gCamIVA31;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem32.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA32.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA32.iAfecIVA = "3";
                            gCamIVA32.dBasGravIVA = 0;
                            gCamIVA32.dLiqIVAItem = 0;
                        }
                        gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem32.gValorRestaItem = gValorRestaItem32;
                        gCamItem32.gValorItem = gValorItem32;
                        gCamItem32.gCamIVA = gCamIVA32;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem33.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA33.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA33.iAfecIVA = "3";
                            gCamIVA33.dBasGravIVA = 0;
                            gCamIVA33.dLiqIVAItem = 0;
                        }
                        gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem33.gValorRestaItem = gValorRestaItem33;
                        gCamItem33.gValorItem = gValorItem33;
                        gCamItem33.gCamIVA = gCamIVA33;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem34.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA34.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA34.iAfecIVA = "3";
                            gCamIVA34.dBasGravIVA = 0;
                            gCamIVA34.dLiqIVAItem = 0;
                        }
                        gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem34.gValorRestaItem = gValorRestaItem34;
                        gCamItem34.gValorItem = gValorItem34;
                        gCamItem34.gCamIVA = gCamIVA34;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem35.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA35.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA35.iAfecIVA = "3";
                            gCamIVA35.dBasGravIVA = 0;
                            gCamIVA35.dLiqIVAItem = 0;
                        }
                        gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem35.gValorRestaItem = gValorRestaItem35;
                        gCamItem35.gValorItem = gValorItem35;
                        gCamItem35.gCamIVA = gCamIVA35;
                        gCamItem1[f] = gCamItem35;
                    }
                    if (f == 35)
                    {
                        gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem36.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA36.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA36.iAfecIVA = "3";
                            gCamIVA36.dBasGravIVA = 0;
                            gCamIVA36.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem36.gValorRestaItem = gValorRestaItem36;
                        gCamItem36.gValorItem = gValorItem36;
                        gCamItem36.gCamIVA = gCamIVA36;
                        gCamItem1[f] = gCamItem36;
                    }
                    if (f == 36)
                    {
                        gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem37.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA37.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA37.iAfecIVA = "3";
                            gCamIVA37.dBasGravIVA = 0;
                            gCamIVA37.dLiqIVAItem = 0;
                        }
                        gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem37.gValorRestaItem = gValorRestaItem37;
                        gCamItem37.gValorItem = gValorItem37;
                        gCamItem37.gCamIVA = gCamIVA37;
                        gCamItem1[f] = gCamItem37;
                    }
                    if (f == 37)
                    {
                        gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem38.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA38.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA38.iAfecIVA = "3";
                            gCamIVA38.dBasGravIVA = 0;
                            gCamIVA38.dLiqIVAItem = 0;
                        }
                        gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem38.gValorRestaItem = gValorRestaItem38;
                        gCamItem38.gValorItem = gValorItem38;
                        gCamItem38.gCamIVA = gCamIVA38;
                        gCamItem1[f] = gCamItem38;
                    }
                    if (f == 38)
                    {
                        gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem39.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA39.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA39.iAfecIVA = "3";
                            gCamIVA39.dBasGravIVA = 0;
                            gCamIVA39.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem39.gValorRestaItem = gValorRestaItem39;
                        gCamItem39.gValorItem = gValorItem39;
                        gCamItem39.gCamIVA = gCamIVA39;
                        gCamItem1[f] = gCamItem39;
                    }
                    if (f == 39)
                    {
                        gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem40.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA40.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA40.iAfecIVA = "3";
                            gCamIVA40.dBasGravIVA = 0;
                            gCamIVA40.dLiqIVAItem = 0;
                        }
                        gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem40.gValorRestaItem = gValorRestaItem40;
                        gCamItem40.gValorItem = gValorItem40;
                        gCamItem40.gCamIVA = gCamIVA40;
                        gCamItem1[f] = gCamItem40;
                    }
                    if (f == 40)
                    {
                        gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem41.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA41.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA41.iAfecIVA = "3";
                            gCamIVA41.dBasGravIVA = 0;
                            gCamIVA41.dLiqIVAItem = 0;
                        }
                        gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem41.gValorRestaItem = gValorRestaItem41;
                        gCamItem41.gValorItem = gValorItem41;
                        gCamItem41.gCamIVA = gCamIVA41;
                        gCamItem1[f] = gCamItem41;
                    }
                    if (f == 41)
                    {
                        gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem42.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA42.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA42.iAfecIVA = "3";
                            gCamIVA42.dBasGravIVA = 0;
                            gCamIVA42.dLiqIVAItem = 0;
                        }
                        gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem42.gValorRestaItem = gValorRestaItem42;
                        gCamItem42.gValorItem = gValorItem42;
                        gCamItem42.gCamIVA = gCamIVA42;
                        gCamItem1[f] = gCamItem42;
                    }
                    if (f == 42)
                    {
                        gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem43.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA43.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA43.iAfecIVA = "3";
                            gCamIVA43.dBasGravIVA = 0;
                            gCamIVA43.dLiqIVAItem = 0;
                        }
                        gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem43.gValorRestaItem = gValorRestaItem43;
                        gCamItem43.gValorItem = gValorItem43;
                        gCamItem43.gCamIVA = gCamIVA43;
                        gCamItem1[f] = gCamItem43;
                    }
                    if (f == 43)
                    {
                        gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem44.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA44.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA44.iAfecIVA = "3";
                            gCamIVA44.dBasGravIVA = 0;
                            gCamIVA44.dLiqIVAItem = 0;
                        }
                        gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem44.gValorRestaItem = gValorRestaItem44;
                        gCamItem44.gValorItem = gValorItem44;
                        gCamItem44.gCamIVA = gCamIVA44;
                        gCamItem1[f] = gCamItem44;
                    }
                    if (f == 44)
                    {
                        gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem45.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA45.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA45.iAfecIVA = "3";
                            gCamIVA45.dBasGravIVA = 0;
                            gCamIVA45.dLiqIVAItem = 0;
                        }
                        gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem45.gValorRestaItem = gValorRestaItem45;
                        gCamItem45.gValorItem = gValorItem45;
                        gCamItem45.gCamIVA = gCamIVA45;
                        gCamItem1[f] = gCamItem45;
                    }
                    #endregion


                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = template;
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }
                if (tablacab.Equals("ORIN") && electronico.Equals("Si"))
                {

                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T2.\"U_CDC\" FROM ORIN T0 INNER JOIN RIN1 T1 ON T0.\"DocEntry\"=t1.\"DocEntry\" INNER JOIN OINV T2 ON T1.\"BaseEntry\"=t2.\"DocEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (tablacab.Equals("ORIN") && electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    // DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }



                gCamCond.gPaConEIni = gPaConEIni1;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                //gValorItem.gValorRestaItem = gValorRestaItem;
                //gCamItem.gValorItem = gValorItem;
                //gCamItem.gCamIVA = gCamIVA;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                if (e.ToString().Contains("System.ServiceModel.EndpointNotFoundException"))
                {
                    MessageBox.Show("Problema de conexión, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("System.indexOutOfRangeException"))
                {
                    MessageBox.Show("Dirección duplicada o ruc inválido, favor revisar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("java.lang.NumberFormatException"))
                {
                    MessageBox.Show("Verificar campos obligatorios, formato incorrecto o vacío!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("org.hibernate.engine.jdbc"))
                {
                    MessageBox.Show("Error en la base de datos, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                else
                {
                    MessageBox.Show(e.ToString());
                }
            }

        }

        //funcion para descargar Comisiones a Excel
        private static void ExportarExcelComisiones(SAPbouiCOM.Form oForm)
        {
            Microsoft.Office.Interop.Excel.Application aplicacion;
            Microsoft.Office.Interop.Excel.Workbook libro;
            Microsoft.Office.Interop.Excel.Worksheet hoja;
            Microsoft.Office.Interop.Excel.Worksheet hoja2;
            Microsoft.Office.Interop.Excel.Range rango;
            object misvalue = System.Reflection.Missing.Value;
            SAPbouiCOM.Matrix grilla = (SAPbouiCOM.Matrix)oForm.Items.Item("0_U_G").Specific;

            try
            {
                //configuramos los elementos para el excel
                aplicacion = new Microsoft.Office.Interop.Excel.Application();
                aplicacion.Visible = false;
                libro = (Microsoft.Office.Interop.Excel.Workbook)(aplicacion.Workbooks.Add(""));
                hoja = (Microsoft.Office.Interop.Excel.Worksheet)libro.ActiveSheet;
                //agregamos los titulos al excel
                hoja.Cells[1, 1] = "COD EMPLEADO";
                hoja.Cells[1, 2] = "EMPLEADO";
                hoja.Cells[1, 3] = "ID CATEGORIA";
                hoja.Cells[1, 4] = "CATEGORIA";
                hoja.Cells[1, 5] = "METRICA";
                hoja.Cells[1, 6] = "METRICA R3";
                hoja.Cells[1, 7] = "VALOR OBJETIVO";
                hoja.Cells[1, 8] = "VALOR RENTA";
                hoja.Cells[1, 9] = "CUMPLIMIENTO";
                hoja.Cells[1, 10] = "EQUIVALENCIA";
                hoja.Cells[1, 11] = "FECHA INICIO";
                hoja.Cells[1, 12] = "FECHA FIN";
                hoja.Cells[1, 13] = "ID CANAL";
                hoja.Cells[1, 14] = "CANAL";
                hoja.Cells[1, 15] = "PERIODO";
                //ponemos en negrita los titulos
                hoja.Range["A1", "O1"].Font.Bold = true;

                int fila = 1;
                int filacelda = 2;
                int filamatrix = 1;
                int countgrid = grilla.RowCount;
                //recorremos la grilla
                while (fila <= countgrid)
                {
                    SAPbouiCOM.EditText oItem1 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_1").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem2 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_2").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem3 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_3").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem4 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_4").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem5 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_5").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem6 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_6").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem7 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_7").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem8 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_8").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem9 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_9").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem10 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_10").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem11 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_11").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem12 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_12").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem13 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_13").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem14 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_14").Cells.Item(filamatrix).Specific;
                    SAPbouiCOM.EditText oItem15 = (SAPbouiCOM.EditText)grilla.Columns.Item("C_0_15").Cells.Item(filamatrix).Specific;

                    string v_item1 = oItem1.Value;
                    string v_item2 = oItem2.Value;
                    string v_item3 = oItem3.Value;
                    string v_item4 = oItem4.Value;
                    string v_item5 = oItem5.Value;
                    string v_item6 = oItem6.Value;
                    string v_item7 = oItem7.Value;
                    string v_item8 = oItem8.Value;
                    string v_item9 = oItem9.Value;
                    string v_item10 = oItem10.Value;
                    string v_item11 = oItem11.Value;
                    string v_item12 = oItem12.Value;
                    string v_item13 = oItem13.Value;
                    string v_item14 = oItem14.Value;
                    string v_item15 = oItem15.Value;

                    hoja.Cells[filacelda, 1] = v_item1;// grilla.DataTable.GetValue(0, filamatrix);
                    hoja.Cells[filacelda, 2] = v_item2;// grilla.DataTable.GetValue(1, filamatrix);
                    hoja.Cells[filacelda, 3] = v_item3;// grilla.DataTable.GetValue(2, filamatrix);
                    hoja.Cells[filacelda, 4] = v_item4;// grilla.DataTable.GetValue(3, filamatrix);
                    hoja.Cells[filacelda, 5] = v_item5;// grilla.DataTable.GetValue(4, filamatrix);
                    hoja.Cells[filacelda, 6] = v_item6;// grilla.DataTable.GetValue(5, filamatrix);
                    hoja.Cells[filacelda, 7] = v_item7;// grilla.DataTable.GetValue(6, filamatrix);
                    hoja.Cells[filacelda, 8] = v_item8;// grilla.DataTable.GetValue(7, filamatrix);
                    hoja.Cells[filacelda, 9] = v_item9;// grilla.DataTable.GetValue(8, filamatrix);
                    hoja.Cells[filacelda, 10] = v_item10;// grilla.DataTable.GetValue(9, filamatrix);
                    hoja.Cells[filacelda, 11] = v_item11;// grilla.DataTable.GetValue(10, filamatrix);
                    hoja.Cells[filacelda, 12] = v_item12;// grilla.DataTable.GetValue(11, filamatrix);
                    hoja.Cells[filacelda, 13] = v_item13;// grilla.DataTable.GetValue(12, filamatrix);
                    hoja.Cells[filacelda, 14] = v_item14;// grilla.DataTable.GetValue(13, filamatrix);
                    hoja.Cells[filacelda, 15] = v_item15;// grilla.DataTable.GetValue(14, filamatrix);

                    filacelda = filacelda + 1;
                    filamatrix = filamatrix + 1;
                    fila = fila + 1;
                }
                //creamos una carpeta en el escritorio para guardar el excel
                string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                string CarpEscr = path + "\\COMISIONES";
                if (!Directory.Exists(CarpEscr))
                {
                    Directory.CreateDirectory(CarpEscr);
                }

                aplicacion.Visible = false;
                aplicacion.UserControl = false;
                string archivo = CarpEscr + "\\Comision_" + DateTime.Now.Hour.ToString("D2") + "" + DateTime.Now.Minute.ToString("D2") + "" + DateTime.Now.Second.ToString("D2") + ".xls";
                libro.SaveAs(archivo);
                libro.Close();
                aplicacion.Quit();
                MessageBox.Show("Exportado con éxito!", "Exito", MessageBoxButtons.OK, MessageBoxIcon.Information);

            }
            catch (Exception e)
            {

            }

        }

        //funcion para descargar las comisiones
        private static void DescargarExcelComision(string v_periodo)
        {
            Microsoft.Office.Interop.Excel.Application aplicacion;
            Microsoft.Office.Interop.Excel.Workbook libro;
            Microsoft.Office.Interop.Excel.Worksheet hoja;
            Microsoft.Office.Interop.Excel.Worksheet hoja2;
            Microsoft.Office.Interop.Excel.Range rango;
            object misvalue = System.Reflection.Missing.Value;


            try
            {
                //configuramos los elementos para el excel
                aplicacion = new Microsoft.Office.Interop.Excel.Application();
                aplicacion.Visible = false;
                libro = (Microsoft.Office.Interop.Excel.Workbook)(aplicacion.Workbooks.Add(""));
                hoja = (Microsoft.Office.Interop.Excel.Worksheet)libro.ActiveSheet;
                //agregamos los titulos al excel
                hoja.Cells[1, 1] = "COD EMPLEADO";
                hoja.Cells[1, 2] = "EMPLEADO";
                hoja.Cells[1, 3] = "ID CATEGORIA";
                hoja.Cells[1, 4] = "CATEGORIA";
                hoja.Cells[1, 5] = "CATEGORIA PADRE";
                hoja.Cells[1, 6] = "CODE";
                hoja.Cells[1, 7] = "METRICA";
                hoja.Cells[1, 8] = "RELACION R3";
                hoja.Cells[1, 9] = "VALOR OBJETIVO";
                hoja.Cells[1, 10] = "VALOR VENTA";
                hoja.Cells[1, 11] = "CUMPLIMIENTO";
                hoja.Cells[1, 12] = "EQUIVALENCIA";
                hoja.Cells[1, 13] = "ESCALA";
                hoja.Cells[1, 14] = "MONTO A PAGAR";
                hoja.Cells[1, 15] = "ID CANAL";
                hoja.Cells[1, 16] = "CANAL";
                hoja.Cells[1, 17] = "PERIODO";
                //ponemos en negrita los titulos
                hoja.Range["A1", "Q1"].Font.Bold = true;
                int filacelda = 2;
                //consultamos los datos necesarios para el excel
                SAPbobsCOM.Recordset oConsulta;
                oConsulta = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oConsulta.DoQuery("SELECT * FROM H_OBJETIVOS WHERE \"PERIODO\"='" + v_periodo + "' ");
                Cursor.Current = Cursors.WaitCursor;
                while (!oConsulta.EoF)
                {
                    //consultamos los datos para el calculo
                    string v_idcategoria = oConsulta.Fields.Item(2).Value.ToString();
                    string v_metrica = oConsulta.Fields.Item(7).Value.ToString();
                    string v_equiv = oConsulta.Fields.Item(11).Value.ToString();

                    SAPbobsCOM.Recordset oDatos;
                    oDatos = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oDatos.DoQuery("SELECT T0.\"U_VALOR\" FROM \"@JESCALAS\" T0 " +
                                   "INNER JOIN \"@JMETRICA\" T1 ON T0.\"U_METRICA\"=t1.\"U_METRICA\" " +
                                   "WHERE T1.\"U_jRELACION_R3\"='" + v_metrica + "' AND T0.\"U_COD_CATEGORIA\"='" + v_idcategoria + "' limit 10");
                    string v_monto = oDatos.Fields.Item(0).Value.ToString();
                    int v_valorA = (int.Parse(v_monto) * int.Parse(v_equiv)) / 100;

                    hoja.Cells[filacelda, 1] = oConsulta.Fields.Item(0).Value.ToString();
                    hoja.Cells[filacelda, 2] = oConsulta.Fields.Item(1).Value.ToString();
                    hoja.Cells[filacelda, 3] = oConsulta.Fields.Item(2).Value.ToString();
                    hoja.Cells[filacelda, 4] = oConsulta.Fields.Item(3).Value.ToString();
                    hoja.Cells[filacelda, 5] = oConsulta.Fields.Item(4).Value.ToString();
                    hoja.Cells[filacelda, 6] = oConsulta.Fields.Item(5).Value.ToString();
                    hoja.Cells[filacelda, 7] = oConsulta.Fields.Item(6).Value.ToString();
                    hoja.Cells[filacelda, 8] = oConsulta.Fields.Item(7).Value.ToString();
                    hoja.Cells[filacelda, 9] = oConsulta.Fields.Item(8).Value.ToString();
                    hoja.Cells[filacelda, 10] = oConsulta.Fields.Item(9).Value.ToString();
                    hoja.Cells[filacelda, 11] = oConsulta.Fields.Item(10).Value.ToString();
                    hoja.Cells[filacelda, 12] = oConsulta.Fields.Item(11).Value.ToString();
                    hoja.Cells[filacelda, 13] = v_monto;
                    hoja.Cells[filacelda, 14] = v_valorA.ToString();
                    hoja.Cells[filacelda, 15] = oConsulta.Fields.Item(12).Value.ToString();
                    hoja.Cells[filacelda, 16] = oConsulta.Fields.Item(13).Value.ToString();
                    hoja.Cells[filacelda, 17] = oConsulta.Fields.Item(14).Value.ToString();

                    oConsulta.MoveNext();
                    filacelda++;
                }
                //cargamos la hoja 2
                hoja2 = libro.Worksheets.Add();
                int filacelda2 = 2;
                //agregamos los titulos al excel
                hoja2.Cells[1, 1] = "COD EMPLEADO";
                hoja2.Cells[1, 2] = "EMPLEADO";
                hoja2.Cells[1, 3] = "CATEGORIA";
                hoja2.Cells[1, 4] = "VALOR OBJETIVO";
                hoja2.Cells[1, 5] = "VALOR VENTA";
                hoja2.Cells[1, 6] = "MONTO A PAGAR";
                hoja2.Range["A1", "F1"].Font.Bold = true;
                //consultamos los datos
                SAPbobsCOM.Recordset oConsulta2;
                oConsulta2 = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oConsulta2.DoQuery("SELECT X.\"COD_EMPLEADO\",X.\"EMPLEADO\",X.\"CATEGORIA\",SUM(X.\"VALOR_OBJETIVO\"),SUM(X.\"VALOR_VENTA\"),SUM(MONTO) FROM " +
                                   "(SELECT T0.\"COD_EMPLEADO\",T0.\"EMPLEADO\",T0.\"CATEGORIA\",T0.VALOR_OBJETIVO,T0.VALOR_VENTA,T0.EQUIVALENCIA,T2.\"U_VALOR\",(T0.EQUIVALENCIA * T2.\"U_VALOR\")/100 AS \"MONTO\" " +
                                   "FROM H_OBJETIVOS T0 " +
                                   "INNER JOIN \"@JMETRICA\" T1 ON T1.\"U_jRELACION_R3\"=T0.\"RELACION_R3\" " +
                                   "LEFT JOIN \"@JESCALAS\" T2 ON T1.\"U_METRICA\"=T2.\"U_METRICA\" AND T2.\"U_COD_CATEGORIA\"=T0.ID_CATEGORIA " +
                                   "WHERE \"PERIODO\"='" + v_periodo + "') AS X " +
                                   "GROUP BY X.\"COD_EMPLEADO\",X.\"EMPLEADO\",X.\"CATEGORIA\" ");
                while (!oConsulta2.EoF)
                {
                    hoja2.Cells[filacelda2, 1] = oConsulta2.Fields.Item(0).Value.ToString();
                    hoja2.Cells[filacelda2, 2] = oConsulta2.Fields.Item(1).Value.ToString();
                    hoja2.Cells[filacelda2, 3] = oConsulta2.Fields.Item(2).Value.ToString();
                    hoja2.Cells[filacelda2, 4] = oConsulta2.Fields.Item(3).Value.ToString();
                    hoja2.Cells[filacelda2, 5] = oConsulta2.Fields.Item(4).Value.ToString();
                    hoja2.Cells[filacelda2, 6] = oConsulta2.Fields.Item(5).Value.ToString();

                    oConsulta2.MoveNext();
                    filacelda2++;
                }
                Cursor.Current = Cursors.Default;
                //creamos una carpeta en el escritorio para guardar el excel
                string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                string CarpEscr = path + "\\COMISIONES";
                if (!Directory.Exists(CarpEscr))
                {
                    Directory.CreateDirectory(CarpEscr);
                }

                aplicacion.Visible = false;
                aplicacion.UserControl = false;
                string archivo = CarpEscr + "\\Comision_" + DateTime.Now.Hour.ToString("D2") + "" + DateTime.Now.Minute.ToString("D2") + "" + DateTime.Now.Second.ToString("D2") + ".xls";
                libro.SaveAs(archivo);
                libro.Close();
                aplicacion.Quit();
                MessageBox.Show("Exportado con éxito!", "Exito", MessageBoxButtons.OK, MessageBoxIcon.Information);

            }
            catch (Exception e)
            {

            }
        }

        //iniciar el form de comisiones
        private static void inicioComision(SAPbouiCOM.Form oForm)
        {
            EditText oPeriodo = (EditText)oForm.Items.Item("Item_4").Specific;
            oPeriodo.Item.Enabled = true;
            oPeriodo.Value = "01/23";
            oPeriodo.Item.ForeColor = System.Drawing.Color.DimGray.ToArgb();
            SAPbouiCOM.Button oBoton = (SAPbouiCOM.Button)oForm.Items.Item("Item_0").Specific;
            oBoton.Caption = "Subir excel";
        }

        //cargar grilla de comisiones
        private static void cargarGrillaComision(string url, SAPbouiCOM.Form oForm)
        {
            string v_codEmple = null, v_empleado = null, v_idCateg = null, v_categ = null, v_metrica = null, v_r3 = null, v_valorObj = null, v_valorVenta = null, v_cump = null, v_equiv = null, v_fecIni = null, v_fecFin = null, v_idCanal = null, v_canal = null, v_peri = null;
            //instaciamos los servicios de excel
            Microsoft.Office.Interop.Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();
            Microsoft.Office.Interop.Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(url);
            Microsoft.Office.Interop.Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            Microsoft.Office.Interop.Excel.Range xlRange = xlWorksheet.UsedRange;
            xlWorkbook.Activate();
            SAPbouiCOM.Matrix oMatrix;
            oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("0_U_G").Specific;
            SAPbouiCOM.DBDataSource source = oForm.DataSources.DBDataSources.Item("@JLIQUIDACIONES");
            oMatrix.FlushToDataSource();
            source.Clear();
            SAPbouiCOM.EditText oPeriodo;
            oPeriodo = (SAPbouiCOM.EditText)oForm.Items.Item("20_U_E").Specific;

            int rowCount = xlRange.Rows.Count;
            int columnsCount = xlRange.Columns.Count;
            int colCount = xlRange.Columns.Count;
            int filagrid = 0;
            //validar cantidad de columnas y filas
            if (columnsCount != 17)
            {
                MessageBox.Show("Favor verificar cantidad de columnas!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }
            if (rowCount < 2)
            {
                MessageBox.Show("El excel no posee datos, favor verificar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }
            int cant = 1;


            //recorremos el excel
            string v_fecha = "01/" + xlRange.Cells[2, 17].Value2.ToString();
            DateTime fecha = Convert.ToDateTime(v_fecha);
            DateTime oPrimerDiaDelMes = new DateTime(fecha.Year, fecha.Month, 1);
            DateTime oUltimoDiaDelMes = oPrimerDiaDelMes.AddMonths(1).AddDays(-1);
            string v_primero = oPrimerDiaDelMes.ToString("yyyyMMdd");
            string v_ultimo = oUltimoDiaDelMes.ToString("yyyyMMdd");


            for (int i = 2; i <= rowCount; i++)
            {
                try
                {
                    //cargamos las variables del excel
                    v_codEmple = xlRange.Cells[i, 1].Value2.ToString();
                    v_empleado = xlRange.Cells[i, 2].Value2.ToString();
                    v_idCateg = xlRange.Cells[i, 3].Value2.ToString();
                    v_categ = xlRange.Cells[i, 4].Value2.ToString();
                    v_metrica = xlRange.Cells[i, 7].Value2.ToString();
                    v_r3 = xlRange.Cells[i, 8].Value2.ToString();
                    v_valorObj = xlRange.Cells[i, 9].Value2.ToString();
                    v_valorVenta = xlRange.Cells[i, 10].Value2.ToString();
                    v_cump = xlRange.Cells[i, 11].Value2.ToString();
                    v_equiv = xlRange.Cells[i, 12].Value2.ToString();
                    //v_fecIni = xlRange.Cells[i, 11].Value2.ToString();
                    //v_fecFin = xlRange.Cells[i, 12].Value2.ToString();
                    v_idCanal = xlRange.Cells[i, 15].Value2.ToString();
                    v_canal = xlRange.Cells[i, 16].Value2.ToString();
                    v_peri = xlRange.Cells[i, 17].Value2.ToString();
                    //mandamos las variables en la grilla
                    source.InsertRecord(source.Size);
                    source.Offset = source.Size - 1;
                    source.SetValue(5, filagrid, v_codEmple);
                    source.SetValue(6, filagrid, v_empleado);
                    source.SetValue(7, filagrid, v_idCateg);
                    source.SetValue(8, filagrid, v_categ);
                    source.SetValue(9, filagrid, v_metrica);
                    source.SetValue(10, filagrid, v_r3);
                    source.SetValue(11, filagrid, v_valorObj);
                    source.SetValue(12, filagrid, v_valorVenta);
                    source.SetValue(13, filagrid, v_cump);
                    source.SetValue(14, filagrid, v_equiv);
                    source.SetValue(15, filagrid, v_primero);
                    source.SetValue(16, filagrid, v_ultimo);
                    source.SetValue(17, filagrid, v_idCanal);
                    source.SetValue(18, filagrid, v_canal);
                    source.SetValue(19, filagrid, v_peri);
                    oMatrix.LoadFromDataSource();
                    filagrid++;
                    //cant++;
                }
                catch (Exception e)
                {

                }


            }
            xlWorkbook.Close();
            oPeriodo.Value = v_peri;
            MessageBox.Show("Importado con éxito!!", "Exito", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        //creación de facturas
        private static void crearFacturas(string urlDirectorio)
        {
            //instaciamos los servicios de excel
            Microsoft.Office.Interop.Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();
            Microsoft.Office.Interop.Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(urlDirectorio);
            Microsoft.Office.Interop.Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            Microsoft.Office.Interop.Excel.Range xlRange = xlWorksheet.UsedRange;
            xlWorkbook.Activate();
            //cantidad de fila y columna
            int rowCount = xlRange.Rows.Count;
            int colCount = xlRange.Columns.Count;
            //campos para la factura
            string v_cardcode = null;
            string v_serie = null;
            string v_fecha = null;
            string v_esta = null;
            string v_pemi = null;
            string v_folio = null;
            string v_timbrado = null;
            string v_cond = null;
            string v_arti = null;
            string v_cant = null;
            string v_iva = null;
            string v_precio = null;
            string v_almacen = null;
            string v_vend = null;
            string v_numero = null;
            string v_moneda = null;
            string v_aux = "1";
            int linea = 1;
            string v_cdc = null;
            string aux = "1";
            //instanciamos el documento
            SAPbobsCOM.Documents document;
            document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
            //recorremos el excel
            for (int i = 3; i <= rowCount; i++)
            {
                try
                {
                    //cargamos las variables
                    v_numero = xlRange.Cells[i, 1].Value2.ToString();
                    v_cardcode = xlRange.Cells[i, 2].Value2.ToString();
                    v_serie = xlRange.Cells[i, 4].Value2.ToString();
                    v_fecha = xlRange.Cells[i, 5].Value2.ToString();
                    DateTime fecha_v = Convert.ToDateTime(v_fecha);
                    v_esta = xlRange.Cells[i, 6].Value2.ToString();
                    v_pemi = xlRange.Cells[i, 7].Value2.ToString();
                    v_folio = xlRange.Cells[i, 8].Value2.ToString();
                    v_timbrado = xlRange.Cells[i, 9].Value2.ToString();
                    v_cond = xlRange.Cells[i, 10].Value2.ToString();
                    v_vend = xlRange.Cells[i, 11].Value2.ToString();
                    v_cdc = xlRange.Cells[i, 12].Value2.ToString();
                    v_arti = xlRange.Cells[i, 13].Value2.ToString();
                    v_cant = xlRange.Cells[i, 15].Value2.ToString();
                    v_precio = xlRange.Cells[i, 16].Value2.ToString();
                    v_iva = xlRange.Cells[i, 17].Value2.ToString();
                    v_almacen = xlRange.Cells[i, 18].Value2.ToString();
                    v_moneda = xlRange.Cells[i, 19].Value2.ToString();
                    //pasamos las variables al documento a crear
                    document.CardCode = v_cardcode;
                    document.Series = int.Parse(v_serie);
                    document.DocDate = fecha_v;
                    document.UserFields.Fields.Item("U_ESTA").Value = v_esta;
                    document.UserFields.Fields.Item("U_PEMI").Value = v_pemi;
                    document.FolioPrefixString = v_esta;
                    document.FolioNumber = int.Parse(v_folio);
                    document.UserFields.Fields.Item("U_TIMB").Value = v_timbrado;
                    document.PaymentGroupCode = int.Parse(v_cond);
                    document.SalesPersonCode = int.Parse(v_vend);
                    document.UserFields.Fields.Item("U_CDC").Value = v_cdc;
                    document.DocCurrency = v_moneda;
                    document.DocType = BoDocumentTypes.dDocument_Items;
                    //agregamos el detalle al documento
                    for (int f = 3; f <= rowCount; f++)
                    {
                        v_arti = xlRange.Cells[f, 13].Value2.ToString();
                        v_cant = xlRange.Cells[f, 15].Value2.ToString();
                        v_precio = xlRange.Cells[f, 16].Value2.ToString();
                        v_iva = xlRange.Cells[f, 17].Value2.ToString();
                        v_almacen = xlRange.Cells[f, 18].Value2.ToString();
                        string v_umdetalle = xlRange.Cells[f, 1].Value2.ToString();
                        if (v_numero == v_umdetalle)
                        {
                            document.Lines.ItemCode = v_arti;
                            document.Lines.WarehouseCode = v_almacen;
                            document.Lines.TaxCode = v_iva;
                            document.Lines.Quantity = int.Parse(v_cant);
                            document.Lines.Price = double.Parse(v_precio);
                            document.Lines.LineTotal = double.Parse(v_precio) * double.Parse(v_cant);
                            document.Lines.Add();
                        }
                    }
                    int error = document.Add();
                    string errorDescrip = oCompany.GetLastErrorDescription().ToString();
                    if (error != 0)
                    {
                        MessageBox.Show("Documento :" + v_esta + "-" + v_pemi + "-" + v_folio + ", Error:" + errorDescrip);
                    }
                }
                catch(Exception ex)
                {

                }               
            }
            xlWorkbook.Close();
        }

        //crear factura especial
        private static void CrearDocumentoEspecial(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc)
        {
            try
            {
                //BasicHttpBinding httpBinding = new BasicHttpBinding();
                //httpBinding.MaxReceivedMessageSize = Int32.MaxValue;
                //httpBinding.MaxBufferSize = Int32.MaxValue;

                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              

                #region QUERY DOCUMENTO
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }                   
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                    }                    
                }
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string CodLicitacion = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string infoadicional = oDatos.Fields.Item(53).Value.ToString();
                string porcentaje = oDatos.Fields.Item(54).Value.ToString();
                string descuento = oDatos.Fields.Item(57).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //actualizamos el folio de la factura
                Recordset oActUDF;
                oActUDF = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActUDF.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                string oper = oDatos.Fields.Item(25).Value.ToString();
                if (!string.IsNullOrEmpty(infoadicional))
                {
                    gOpeDE.dInfoEmi = infoadicional;
                }
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                if (oDatos.Fields.Item(26).Value.ToString() == "2")
                {
                    gDatRec.iTiOpe = "2";
                    //gDatRec.iTiContRec = "1";
                }
                else
                {
                    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //validad si el pais esta vacio, enviar PRY por defecto
                string pais = oDatos.Fields.Item(16).Value.ToString();
                if (string.IsNullOrEmpty(pais))
                {
                    gDatRec.cPaisRec = "PRY";
                }
                else
                {
                    gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                }

                //gDatRec.dDesPaisRe = "Paraguay";

                if (tablacab.Equals("ORIN"))
                {
                    gCamNCDE.iMotEmi = "1";//hay que modificar
                }
                //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1" || oDatos.Fields.Item(26).Value.ToString() == "3")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }

                if (tablacab.Equals("OINV"))
                {
                    //REMITO
                    #region REMITO
                    if (!string.IsNullOrEmpty(trans))
                    {
                        string chof = oDatos.Fields.Item(32).Value.ToString();
                        if (!chof.Equals("PERSONAL"))
                        {
                            string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                            if (!string.IsNullOrEmpty(CedChofer))
                            {
                                string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                                string NewDirRec = null;
                                if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    NewDirRec = dirReceptor;

                                }
                                string salDire = oDatos.Fields.Item(37).Value.ToString();
                                string newsalDire = null;
                                if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newsalDire = salDire;

                                }
                                string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                                string newDomFiscal = null;
                                if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDomFiscal = DomFiscal;

                                }
                                string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                                string newDireChofer = null;
                                if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDireChofer = DireChofer;

                                }
                                string codTransp = null;
                                string descTrans = null;
                                if (oDatos.Fields.Item(38).Value.ToString() == varE)
                                {
                                    codTransp = "1";
                                    descTrans = "Propio";
                                }
                                else
                                {
                                    codTransp = "2";
                                    descTrans = "Tercero";
                                }
                                gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gDatRec.dNumCasRec = "0";
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                                //gCamSal               
                                gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                                gCamSal.dNumCasSal = "0";
                                //gCamSal.dComp1Sal =  "aviadores del chaco";
                                gCamSal.cDepSal = sal_dep;
                                gCamSal.cCiuSal = sal_loc;
                                gCamSal.cDisSal = sal_dist;
                                //gCamEnt
                                gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gCamEnt.dNumCasEnt = "0";
                                gCamEnt.cDepEnt = rec_dep;
                                gCamEnt.cCiuEnt = rec_loc;
                                gCamEnt.cDisEnt = rec_dist;
                                gCamEnt1[0] = gCamEnt;
                                gTransp.iTipTrans = codTransp;// "2";
                                gTransp.dDesTipTrans = descTrans;// "Tercero";
                                gTransp.iModTrans = "1";
                                gTransp.iRespFlete = RespFlete;
                                gTransp.dIniTras = fe;
                                gTransp.dIniTrasSpecified = true;
                                gTransp.dFinTras = fe;
                                gTransp.dFinTrasSpecified = true;
                                //gVehTras
                                //gTransp.gVehTras = gVehTras1;
                                gVehTras1[0] = gVehTras;
                                gVehTras.dTiVehTras = "Terrestre";
                                gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                                gVehTras.dTipIdenVeh = "2";
                                gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                                //gCamTrans
                                gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                                gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                                //deconstruimos el RUC del transportista
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                string rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                string dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                                gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                                gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                                gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                                gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                                gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                                gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                                   //gCamNRE
                                                                   //gCamNRE.iMotEmiNR = "1";
                                                                   //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                                   //gCamNRE.iRespEmiNR = "1";
                                                                   //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                                gCamNRE.dKmR = "3";
                                //gDtipDE.gCamNRE = gCamNRE;
                                gTransp.gCamTrans = gCamTrans;
                                gTransp.gCamSal = gCamSal;
                                gTransp.gCamEnt = gCamEnt1;
                                gTransp.gVehTras = gVehTras1;
                                gDtipDE.gTransp = gTransp;
                            }

                        }


                    }
                    #endregion
                }



                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //convertimos a INT la cantidad de decimales
                int v_CanDecimal = int.Parse(v_DecimalFG);
                while (!oDatos.EoF)
                {
                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem
                        string pp = oDatos.Fields.Item(14).Value.ToString();
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) + decimal.Parse(descuento); //11364;
                        gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) + decimal.Parse(descuento); //* decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem.dDescItem = decimal.Parse(descuento); ;
                        gValorRestaItem.dDescItemSpecified = true;
                        //string deci = "1,2";
                        gValorRestaItem.dPorcDesIt = decimal.Parse(porcentaje);
                        gValorRestaItem.dPorcDesItSpecified = true;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_CanDecimal);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_CanDecimal);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_CanDecimal);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_CanDecimal);                                 
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }                    
                    #endregion


                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                if (string.IsNullOrEmpty(trans))
                {
                    parametros.templateKuDE = "FACTURA_SIMPLE";
                }
                else
                {
                    parametros.templateKuDE = template;
                }
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }

                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }
                if (tablacab.Equals("ORIN") && electronico.Equals("Si"))
                {

                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T2.\"U_CDC\" FROM ORIN T0 INNER JOIN RIN1 T1 ON T0.\"DocEntry\"=t1.\"DocEntry\" INNER JOIN OINV T2 ON T1.\"BaseEntry\"=t2.\"DocEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (tablacab.Equals("ORIN") && electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    // DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }



                gCamCond.gPaConEIni = gPaConEIni1;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                //gValorItem.gValorRestaItem = gValorRestaItem;
                //gCamItem.gValorItem = gValorItem;
                //gCamItem.gCamIVA = gCamIVA;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");

                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
            }
            catch (Exception e)
            {
                if (e.ToString().Contains("System.ServiceModel.EndpointNotFoundException"))
                {
                    MessageBox.Show("Problema de conexión, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("System.indexOutOfRangeException"))
                {
                    MessageBox.Show("Dirección duplicada o ruc inválido, favor revisar!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("java.lang.NumberFormatException"))
                {
                    MessageBox.Show("Verificar campos obligatorios, formato incorrecto o vacío!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                if (e.ToString().Contains("org.hibernate.engine.jdbc"))
                {
                    MessageBox.Show("Error en la base de datos, favor consultar con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
                else
                {
                    MessageBox.Show(e.ToString());
                }
            }

        }
        #endregion
    }
}
